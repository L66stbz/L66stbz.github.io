<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jenkins_CI_CD应用 | L66</title><meta name="description" content="什么是CI&#x2F;CD：持续集成&#x2F;持续发布—开发(git) –&gt;git主库–&gt;jenkins(git+jdk+tomcat+maven打包+测试）–&gt;发布到tomcat服务器。 Jenkins是一个功能强大的应用程序，允许持续集成和持续交付项目，无论用的是什么平台。这是一个免费的源代码，可以处理任何类型的构建或持续集成。集成Jenkins可以用于一些测试和部署技术。 为什么要 CI &#x2F;"><meta name="keywords" content="Linux,Ansible,Jenkins"><meta name="author" content="L66"><meta name="copyright" content="L66"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/3.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Jenkins_CI_CD应用"><meta name="twitter:description" content="什么是CI&#x2F;CD：持续集成&#x2F;持续发布—开发(git) –&gt;git主库–&gt;jenkins(git+jdk+tomcat+maven打包+测试）–&gt;发布到tomcat服务器。 Jenkins是一个功能强大的应用程序，允许持续集成和持续交付项目，无论用的是什么平台。这是一个免费的源代码，可以处理任何类型的构建或持续集成。集成Jenkins可以用于一些测试和部署技术。 为什么要 CI &#x2F;"><meta name="twitter:image" content="https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD应用/Jenkins_CI_CD应用/1.png"><meta property="og:type" content="article"><meta property="og:title" content="Jenkins_CI_CD应用"><meta property="og:url" content="https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD%E5%BA%94%E7%94%A8/Jenkins_CI_CD%E5%BA%94%E7%94%A8/"><meta property="og:site_name" content="L66"><meta property="og:description" content="什么是CI&#x2F;CD：持续集成&#x2F;持续发布—开发(git) –&gt;git主库–&gt;jenkins(git+jdk+tomcat+maven打包+测试）–&gt;发布到tomcat服务器。 Jenkins是一个功能强大的应用程序，允许持续集成和持续交付项目，无论用的是什么平台。这是一个免费的源代码，可以处理任何类型的构建或持续集成。集成Jenkins可以用于一些测试和部署技术。 为什么要 CI &#x2F;"><meta property="og:image" content="https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD应用/Jenkins_CI_CD应用/1.png"><meta property="article:published_time" content="2024-09-05T13:50:00.000Z"><meta property="article:modified_time" content="2024-09-07T03:00:14.263Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD%E5%BA%94%E7%94%A8/Jenkins_CI_CD%E5%BA%94%E7%94%A8/"><link rel="prev" title="Jenkins结合Ansible实战" href="https://l66stbz.github.io/2024/09/06/Jenkins%E7%BB%93%E5%90%88Ansible/Jenkins%E7%BB%93%E5%90%88Ansible%E5%AE%9E%E6%88%98/"><link rel="next" title="Gitlab企业级代码管理" href="https://l66stbz.github.io/2024/09/04/gitlab%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/Gitlab%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="L66" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/2.jpg" onerror="onerror=null;src='/img/2.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">54</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">35</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/photo/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、jenkins介绍"><span class="toc-number">1.</span> <span class="toc-text">一、jenkins介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1、Jenkins概述"><span class="toc-number">1.0.1.</span> <span class="toc-text">1、Jenkins概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2、Jenkins目标"><span class="toc-number">1.0.2.</span> <span class="toc-text">2、Jenkins目标</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、Jenkins特性"><span class="toc-number">1.0.3.</span> <span class="toc-text">3、Jenkins特性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4、产品发布流程"><span class="toc-number">1.0.4.</span> <span class="toc-text">4、产品发布流程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、部署应用Jenkins-Gitlub-Tomcat实战"><span class="toc-number">2.</span> <span class="toc-text">二、部署应用Jenkins+Gitlub+Tomcat实战</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#java-server-—–192-168-246-210"><span class="toc-number">2.0.1.</span> <span class="toc-text">java-server   —–192.168.246.210</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins2-303-1版本安装"><span class="toc-number">3.</span> <span class="toc-text">Jenkins2.303.1版本安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-下载安装包"><span class="toc-number">3.1.</span> <span class="toc-text">1. 下载安装包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-访问登录"><span class="toc-number">3.2.</span> <span class="toc-text">2. 访问登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-插件安装"><span class="toc-number">3.3.</span> <span class="toc-text">3. 插件安装</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-邮箱配置-可选"><span class="toc-number">3.3.1.</span> <span class="toc-text">5.邮箱配置(可选)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-配置Jenkins私钥"><span class="toc-number">3.3.2.</span> <span class="toc-text">6.配置Jenkins私钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-添加后端服务器"><span class="toc-number">3.3.3.</span> <span class="toc-text">7.添加后端服务器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-配置JDK和Maven"><span class="toc-number">3.3.4.</span> <span class="toc-text">8.配置JDK和Maven</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9-构建发布任务"><span class="toc-number">3.3.5.</span> <span class="toc-text">9.构建发布任务</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10-java服务器添加脚本"><span class="toc-number">3.3.6.</span> <span class="toc-text">10.java服务器添加脚本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-启用邮箱"><span class="toc-number">3.3.7.</span> <span class="toc-text">11.启用邮箱</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-构建项目"><span class="toc-number">3.3.8.</span> <span class="toc-text">12.构建项目</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#13-访问tomcat测试"><span class="toc-number">3.3.9.</span> <span class="toc-text">13.访问tomcat测试</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#14-更新测试"><span class="toc-number">3.3.10.</span> <span class="toc-text">14.更新测试</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#16-准备开源项目"><span class="toc-number">3.3.11.</span> <span class="toc-text">16.准备开源项目</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、Jenkins-Gitlab-maven项目实战"><span class="toc-number">4.</span> <span class="toc-text">三、Jenkins+Gitlab+maven项目实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、Jenkins-git参数化构建"><span class="toc-number">5.</span> <span class="toc-text">四、Jenkins git参数化构建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-配置Jenkins参数化构建（tag方式）"><span class="toc-number">5.1.</span> <span class="toc-text">1. 配置Jenkins参数化构建（tag方式）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-配置Jenkins参数化构建-commit修订号"><span class="toc-number">5.2.</span> <span class="toc-text">2. 配置Jenkins参数化构建(commit修订号)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、Jenkins多节点配置"><span class="toc-number">6.</span> <span class="toc-text">五、Jenkins多节点配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-添加从节点"><span class="toc-number">6.1.</span> <span class="toc-text">1.添加从节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-参数详解"><span class="toc-number">6.2.</span> <span class="toc-text">2.参数详解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-指定java命令路径"><span class="toc-number">6.3.</span> <span class="toc-text">3.指定java命令路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-测试从节点"><span class="toc-number">6.4.</span> <span class="toc-text">4.测试从节点</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD应用/Jenkins_CI_CD应用/1.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">L66</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/photo/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Jenkins_CI_CD应用</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2024-09-05 21:50:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2024-09-05</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2024-09-07 11:00:14"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2024-09-07</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p><strong>什么是CI/CD</strong>：持续集成/持续发布—开发(git) –&gt;git主库–&gt;jenkins(git+jdk+tomcat+maven打包+测试）–&gt;发布到tomcat服务器。</p>
<p>Jenkins是一个功能强大的应用程序，允许<strong>持续集成和持续交付项目</strong>，无论用的是什么平台。这是一个免费的源代码，可以处理任何类型的构建或持续集成。集成Jenkins可以用于一些测试和部署技术。</p>
<p>为什么要 CI / CD 方法</p>
<p>简介</p>
<p>软件开发的连续方法基于自动执行脚本，以最大限度地减少在开发应用程序时引入错误的可能性。从新代码的开发到部署，它们需要较少的人为干预甚至根本不需要干预。</p>
<p>它涉及在每次小迭代中不断构建，测试和部署代码更改，从而减少基于有缺陷或失败的先前版本开发新代码的机会。</p>
<p>这种方法有三种主要方法，每种方法都根据最适合您的策略进行应用。</p>
<p><strong>持续集成</strong>(Continuous Integration, CI):  代码合并，构建，部署，测试都在一起，不断地执行这个过程，并对结果反馈。</p>
<p><strong>持续部署</strong>(Continuous Deployment, CD):　部署到测试环境、预生产环境/灰度环境、生产环境。</p>
<p><strong>持续交付</strong>(Continuous Delivery, CD):  将最终产品发布到生产环境、给用户使用。</p>
<h3 id="一、jenkins介绍"><a href="#一、jenkins介绍" class="headerlink" title="一、jenkins介绍"></a>一、jenkins介绍</h3><p>Jenkins是帮我们将代码进行统一的编译打包、还可以放到tomcat容器中进行发布。<br>我们通过配置，将以前：编译、打包、上传、部署到Tomcat中的过程交给Jenkins，Jenkins通过给定的代码地址URL（代码仓库地址），将代码拉取到其“宿主服务器”（Jenkins的安装位置），进行编译、打包和发布到Tomcat容器中。</p>
<h5 id="1、Jenkins概述"><a href="#1、Jenkins概述" class="headerlink" title="1、Jenkins概述"></a>1、Jenkins概述</h5><p>​    是一个开源的、提供友好操作界面的持续集成(CI)工具，主要用于持续、自动的构建的一些定时执行的任务。Jenkins用Java语言编写，可在Tomcat等流行的容器中运行，也可独立运行。</p>
<p>jenkins通常与版本管理工具(SCM)、构建工具结合使用；常用的版本控制工具有SVN、GIT。jenkins构建工具有Maven、Ant、Gradle。</p>
<h5 id="2、Jenkins目标"><a href="#2、Jenkins目标" class="headerlink" title="2、Jenkins目标"></a>2、Jenkins目标</h5><p>① 持续、自动地构建/测试软件项目。</p>
<p>② 监控软件开发流程，快速问题定位及处理，提高开发效率。</p>
<h5 id="3、Jenkins特性"><a href="#3、Jenkins特性" class="headerlink" title="3、Jenkins特性"></a>3、Jenkins特性</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">① 开源的java语言开发持续集成工具，支持CI，CD。</span><br><span class="line">② 易于安装部署配置：可通过yum安装,或下载war包以及通过docker容器等快速实现安装部署，可方便web界面配置管理。</span><br><span class="line">③ 消息通知及测试报告：集成RSS/E-mail通过RSS发布构建结果或当构建完成时通过e-mail通知，生成JUnit/TestNG测试报告。</span><br><span class="line">④ 分布式构建：支持Jenkins能够让多台计算机一起构建/测试。</span><br><span class="line">⑤ 文件识别:Jenkins能够跟踪哪次构建生成哪些jar，哪次构建使用哪个版本的jar等。</span><br><span class="line">⑥ 丰富的插件支持:支持扩展插件，你可以开发适合自己团队使用的工具，如git，svn，maven，docker等。</span><br></pre></td></tr></table></figure>

<p>工作流程图:</p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/1569246908031.png#id=pHA8p&originHeight=338&originWidth=1149&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">测试环境中：</span><br><span class="line">1.开发者会将代码上传到版本库中。</span><br><span class="line">2.jenkins通过配置版本库的连接地址，获取到源代码。</span><br><span class="line">3.jenkins获取到源代码之后通过参数化构建(或者触发器)开始编译打包。</span><br><span class="line">4.jenkins通过调用maven（Ant或者Gradle）命令实现编译打包过程。</span><br><span class="line">5.生成的war包通过ssh插件上传到远程tomcat服务器中通过shell脚本自动发布项目。</span><br><span class="line"></span><br><span class="line">生产环境：</span><br><span class="line">测试环境将项目测试没问题后，将项目推送到线上正式环境。</span><br><span class="line">1.可以选择手动。</span><br><span class="line">2.也可以通过调用脚本推送过去。</span><br></pre></td></tr></table></figure>

<h5 id="4、产品发布流程"><a href="#4、产品发布流程" class="headerlink" title="4、产品发布流程"></a>4、产品发布流程</h5><p>产品设计成型 -&gt; 开发人员开发代码 -&gt; 测试人员测试功能 -&gt; 运维人员发布上线</p>
<p>持续集成（Continuous integration，简称CI）</p>
<p>持续部署（continuous deployment）</p>
<p>持续交付（Continuous delivery）</p>
<h3 id="二、部署应用Jenkins-Gitlub-Tomcat实战"><a href="#二、部署应用Jenkins-Gitlub-Tomcat实战" class="headerlink" title="二、部署应用Jenkins+Gitlub+Tomcat实战"></a>二、部署应用Jenkins+Gitlub+Tomcat实战</h3><p>准备环境:</p>
<p>两台机器</p>
<p>git-server    —-<a href="https://github.com/bingyue/easy-springmvc-maven" target="_blank" rel="noopener">https://github.com/bingyue/easy-springmvc-maven</a></p>
<p>jenkins-server    —192.168.246.212—最好是3个G以上</p>
<h5 id="java-server-—–192-168-246-210"><a href="#java-server-—–192-168-246-210" class="headerlink" title="java-server   —–192.168.246.210"></a>java-server   —–192.168.246.210</h5><p><a href="https://github.com/bingyue/easy-springmvc-maven" target="_blank" rel="noopener">https://github.com/bingyue/easy-springmvc-maven</a></p>
<h3 id="Jenkins2-303-1版本安装"><a href="#Jenkins2-303-1版本安装" class="headerlink" title="Jenkins2.303.1版本安装"></a>Jenkins2.303.1版本安装</h3><h4 id="1-下载安装包"><a href="#1-下载安装包" class="headerlink" title="1. 下载安装包"></a>1. 下载安装包</h4><p>百度搜索openjdk11、tomcat、maven、jenkins<br>openjdk11经过测试之后，不能运行当前版本jenkins。我这里换成了jdk1.8的<br>jdk官网：<a href="https://www.oracle.com/java/technologies/downloads/" target="_blank" rel="noopener">https://www.oracle.com/java/technologies/downloads/</a><br>jenkins官网：<a href="https://www.jenkins.io/" target="_blank" rel="noopener">https://www.jenkins.io/</a><br>tomcat官网：<a href="https://tomcat.apache.org/" target="_blank" rel="noopener">https://tomcat.apache.org/</a><br>maven官网：<a href="https://maven.apache.org/" target="_blank" rel="noopener">https://maven.apache.org/</a></p>
<p><strong>因为jenkins本身BUG比较多的原因，在做以下些许实验时会出现很多报错属于正常现象。当然也可以解决。</strong></p>
<p><strong>也可以选取别的jenkins版本。本人在完成以后又采用了别的版本进行尝试，效果还不错。</strong></p>
<p><strong>使用的是yum安装的jenkins2.475，jdk17，编译安装Maven3.9.9。</strong></p>
<p><strong>最终在构建build过程可能会报一个问题，说插件版本怎么，什么6版本7版本什么的等等。</strong></p>
<p><strong>如果出现该问题，可以去管理页面工具内，将Maven修改为自动安装，版本选择3.9.9，jdk可以自己在jenkins机器上再在opt下解压一个jdk11版本，不需要配置环境变量，然后jdk安装选择自己安装，路径就写刚刚opt下解压的jdk家目录。然后应用保存，再次构建build，success！！！</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]# wget https://get.jenkins.io/war/2.461/jenkins.war</span><br><span class="line">[root@jenkins ~]# wget https://downloads.apache.org/maven/maven-3/3.8.2/binaries/apache-maven-3.8.2-bin.tar.gz</span><br><span class="line">[root@jenkins ~]# wget https://dlcdn.apache.org/tomcat/tomcat-8/v8.5.45/bin/apache-tomcat-8.5.45.tar.gz</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]<span class="comment"># ls</span></span><br><span class="line">apache-maven-3.8.5-bin.tar.gz  apache-tomcat-8.5.45.tar.gz  jdk-11.0.20_linux-x64_bin.tar.gz  jenkins.war</span><br><span class="line"></span><br><span class="line">[root@jenkins ~]<span class="comment"># tar xf apache-maven-3.8.5-bin.tar.gz  -C /usr/local/</span></span><br><span class="line">[root@jenkins ~]<span class="comment"># tar xf jdk-11.0.20_linux-x64_bin.tar.gz  -C /usr/local/</span></span><br><span class="line">[root@jenkins ~]<span class="comment"># tar xf apache-tomcat-8.5.45.tar.gz  -C /usr/local/</span></span><br><span class="line"></span><br><span class="line">[root@jenkins ~]<span class="comment"># cd /usr/local/</span></span><br><span class="line">[root@jenkins <span class="built_in">local</span>]<span class="comment"># mv apache-maven-3.8.5/ maven</span></span><br><span class="line">[root@jenkins <span class="built_in">local</span>]<span class="comment"># mv apache-tomcat-8.5.45/  tomcat</span></span><br><span class="line">[root@jenkins <span class="built_in">local</span>]<span class="comment"># mv jdk-11.0.20/ java</span></span><br><span class="line"></span><br><span class="line">[root@jenkins ~]<span class="comment"># cat &gt;&gt; /etc/profile.d/java.sh &lt;&lt;-EOF</span></span><br><span class="line">JAVA_HOME=/usr/<span class="built_in">local</span>/java</span><br><span class="line">MAVEN_HOME=/usr/<span class="built_in">local</span>/maven</span><br><span class="line">PATH=\<span class="variable">$PATH</span>:\<span class="variable">$JAVA_HOME</span>/bin:\<span class="variable">$MAVEN_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL JAVA_HOME MAVEN_HOME</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@jenkins <span class="built_in">local</span>]<span class="comment"># source /etc/profile.d/java.sh </span></span><br><span class="line"></span><br><span class="line">[root@jenkins bin]<span class="comment"># java -version</span></span><br><span class="line">java version <span class="string">"11.0.20"</span> 2023-07-18 LTS</span><br><span class="line">Java(TM) SE Runtime Environment 18.9 (build 11.0.20+9-LTS-256)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.20+9-LTS-256, mixed mode)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@jenkins <span class="built_in">local</span>]<span class="comment"># mvn -v</span></span><br><span class="line">Apache Maven 3.8.5 (3599d3414f046de2324203b78ddcf9b5e4388aa0)</span><br><span class="line">Maven home: /usr/<span class="built_in">local</span>/maven</span><br><span class="line">Java version: 17.0.12, vendor: Oracle Corporation, runtime: /usr/<span class="built_in">local</span>/java</span><br><span class="line">Default locale: zh_CN, platform encoding: UTF-8</span><br><span class="line">OS name: <span class="string">"linux"</span>, version: <span class="string">"3.10.0-1160.el7.x86_64"</span>, arch: <span class="string">"amd64"</span>, family: <span class="string">"unix"</span></span><br><span class="line"></span><br><span class="line">[root@jenkins <span class="built_in">local</span>]<span class="comment"># cd ~</span></span><br><span class="line"></span><br><span class="line">[root@jenkins ~]<span class="comment"># rm -rf /usr/local/tomcat/webapps/*</span></span><br><span class="line"></span><br><span class="line">[root@jenkins ~]<span class="comment"># cp jenkins.war  /usr/local/tomcat/webapps/</span></span><br><span class="line"></span><br><span class="line">[root@jenkins ~]<span class="comment"># /usr/local/tomcat/bin/catalina.sh  start</span></span><br><span class="line">Using CATALINA_BASE:   /usr/<span class="built_in">local</span>/tomcat</span><br><span class="line">Using CATALINA_HOME:   /usr/<span class="built_in">local</span>/tomcat</span><br><span class="line">Using CATALINA_TMPDIR: /usr/<span class="built_in">local</span>/tomcat/temp</span><br><span class="line">Using JRE_HOME:        /usr/<span class="built_in">local</span>/java</span><br><span class="line">Using CLASSPATH:       /usr/<span class="built_in">local</span>/tomcat/bin/bootstrap.jar:/usr/<span class="built_in">local</span>/tomcat/bin/tomcat-juli.jar</span><br><span class="line">Using CATALINA_OPTS:   </span><br><span class="line">Tomcat started.</span><br><span class="line"></span><br><span class="line">    [root@jenkins ~]<span class="comment"># yum install fontconfig  -y</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Jenkins 中插件依赖 <code>fontconfig</code> 来渲染字体。<code>fontconfig</code> 是一个库，主要用于管理和配置系统中的字体，使得应用程序能够正确地找到和使用字体文件。</p>
</blockquote>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409030943902.png" alt="image-20240903094334603"></p>
<h4 id="2-访问登录"><a href="#2-访问登录" class="headerlink" title="2. 访问登录"></a>2. 访问登录</h4><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409030945715.png" alt="image-20240903094549627"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409030947165.png" alt="image-20240903094719930"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409030949929.png" alt="image-20240903094913864"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312227364.png" alt="image-20240831222710254"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312253909.png" alt="image-20240831225301810"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312253474.png" alt="image-20240831225337384"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312254272.png" alt="image-20240831225404169"></p>
<blockquote>
<p>Username:admin</p>
<p>password：cat ~/.jenkins/secrets/initialAdminPassword<br>9ab0d5cf97d94dadbacfe5aa588f0c61</p>
</blockquote>
<h4 id="3-插件安装"><a href="#3-插件安装" class="headerlink" title="3. 插件安装"></a>3. 插件安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">安装插件:</span><br><span class="line">所需的插件:</span><br><span class="line">• Maven插件 Maven Integration plugin</span><br><span class="line">• 发布插件 Deploy to container Plugin</span><br><span class="line">需要安装插件如下：</span><br><span class="line">安装插件</span><br><span class="line">`Deploy to container    ---支持自动化代码部署到tomcat容器`</span><br><span class="line">`GIT plugin  可能已经安装,可在已安装列表中查询出来`</span><br><span class="line">`Maven Integration   jenkins利用Maven编译，打包所需插件`</span><br><span class="line">`Publish Over SSH  通过ssh连接`</span><br><span class="line">`ssh  插件`</span><br><span class="line"></span><br><span class="line">安装过程:</span><br><span class="line">系统管理---&gt;插件管理----&gt;可选插件---&gt;过滤Deploy to container----&gt;勾选---&gt;直接安装</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>选择Jenkins配置管理</strong></li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312256265.png" alt="image-20240831225603191"></p>
<ol start="2">
<li>==点击完成以后，进入Jenkins配置。往下拉找到<strong><code>Plugins</code></strong>==</li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312258924.png" alt="image-20240831225826850"></p>
<ol start="3">
<li><strong>更换国内插件下载地址</strong></li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312303909.png" alt="image-20240831230303843"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312304600.png" alt="image-20240831230446526"></p>
<blockquote>
<p>插件链接：<a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a> </p>
</blockquote>
<ol start="4">
<li><strong>更新插件</strong></li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312306862.png" alt="image-20240831230629797"></p>
<ol start="5">
<li><strong>下载插件</strong></li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202408312308451.png" alt="image-20240831230847378"></p>
<h5 id="5-邮箱配置-可选"><a href="#5-邮箱配置-可选" class="headerlink" title="5.邮箱配置(可选)"></a>5.邮箱配置(可选)</h5><p>安装邮件插件，才能确保邮件发送成功。否则可能不会发送邮件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Email Extension Template</span><br><span class="line">Email Ext Recipients Column</span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052117930.png" alt="image-20240605211735834"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052118645.png" alt="image-20240605211806552"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052119412.png" alt="image-20240605211939322"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052128190.png" alt="image-20240605212833063"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052125567.png" alt="image-20240605212526477"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052131280.png" alt="image-20240605213106207"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052132032.png" alt="image-20240605213200921"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052144905.png" alt="image-20240605214417819"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052144361.png" alt="image-20240605214458248"></p>
<h5 id="6-配置Jenkins私钥"><a href="#6-配置Jenkins私钥" class="headerlink" title="6.配置Jenkins私钥"></a>6.配置Jenkins私钥</h5><p>​    说明：Jenkins需要去Gitlab中拉取代码，Jenkins服务器的公钥需要配置Gitlab SSH中，Jenkins私钥配置Jenkins服务中，目的是为了实现Jenkins服务加载到本地私钥，实现服务之间密钥认证。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]# ssh-keygen</span><br><span class="line">[root@jenkins ~]# cat /root/.ssh/id_rsa</span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052152131.png" alt="image-20240605215247049"></p>
<h5 id="7-添加后端服务器"><a href="#7-添加后端服务器" class="headerlink" title="7.添加后端服务器"></a>7.添加后端服务器</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 公钥发送到后端服务器，才能实现免密；</span></span><br><span class="line">[root@jenkins ~]<span class="comment"># ssh-copy-id -i root@192.168.153.194</span></span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052219851.png" alt="image-20240605221943775"></p>
<h5 id="8-配置JDK和Maven"><a href="#8-配置JDK和Maven" class="headerlink" title="8.配置JDK和Maven"></a>8.配置JDK和Maven</h5><p>虽然Jenkins服务器上，已经安装了JDK和maven工具，但是，还需要在Jenkins服务中，进行配置；</p>
<p>这样Jenkins才能自动化的使用两个工具；</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052230149.png" alt="image-20240605223015075"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052230960.png" alt="image-20240605223041884"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052233436.png" alt="image-20240605223326356"></p>
<p>JDK配置</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052234005.png" alt="image-20240605223430949"></p>
<p>maven配置</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052237362.png" alt="image-20240605223711300"></p>
<p><strong>如果有多个jdk和maven需要配置的话，可以点击新增jdk或者新增maven</strong></p>
<p>==========================</p>
<h5 id="9-构建发布任务"><a href="#9-构建发布任务" class="headerlink" title="9.构建发布任务"></a>9.构建发布任务</h5><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052241569.png" alt="image-20240605224145476"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052243447.png" alt="image-20240605224326357"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052253276.png" alt="image-20240605225328164"></p>
<p>拉取代码环节</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052251818.png" alt="image-20240605225142703"></p>
<p><a href="https://github.com/bingyue/easy-springmvc-maven" target="_blank" rel="noopener">https://github.com/bingyue/easy-springmvc-maven</a><br>或者用以下链接<br><a href="https://gitee.com/youngfit/easy-springmvc-maven.git" target="_blank" rel="noopener">https://gitee.com/youngfit/easy-springmvc-maven.git</a></p>
<p>这里是我再github上，找的一个开源项目。能进行编译打包<br>如果jenkins服务器还未安装git客户端，请先安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install -y git</span><br></pre></td></tr></table></figure>



<p>编译打包环节</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052256521.png" alt="image-20240605225610418"></p>
<p>测试拉取代码、编译打包环节</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052310474.png" alt="image-20240605231009330"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052310568.png" alt="image-20240605231049474"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052311123.png" alt="image-20240605231132040"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052314164.png" alt="image-20240605231442049"></p>
<p><strong>持续发布</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052315434.png" alt="image-20240605231556343"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052316155.png" alt="image-20240605231625066"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406052338169.png" alt="image-20240605233844052"></p>
<blockquote>
<p>如果有多个后端服务器，可以点击 ADD server进行添加</p>
</blockquote>
<h5 id="10-java服务器添加脚本"><a href="#10-java服务器添加脚本" class="headerlink" title="10.java服务器添加脚本"></a>10.java服务器添加脚本</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 上传jdk</span></span><br><span class="line">[root@java-server ~]# tar xzf jdk-8u191-linux-x64.tar.gz -C /usr/local/</span><br><span class="line">[root@java-server ~]# cd /usr/local/</span><br><span class="line">[root@java-server local]# mv jdk1.8.0_191/ java</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载tomcat</span></span><br><span class="line">[root@java-server ~]# wget http://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-8/v8.5.42/bin/apache-tomcat-8.5.42.tar.gz</span><br><span class="line">[root@java-server ~]# tar xzf apache-tomcat-8.5.42.tar.gz -C /usr/local</span><br><span class="line">[root@java-server ~]# cd /usr/local</span><br><span class="line">[root@java-server local]# mv apache-tomcat-8.5.42/ tomcat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置环境变量</span></span><br><span class="line">[root@java-server local]# vim /etc/profile</span><br><span class="line">export JAVA_HOME=/usr/local/java</span><br><span class="line">export PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$PATH</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export TOMCAT_HOME=/data/application/tomcat</span><br><span class="line">[root@java-server local]# source /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试:</span></span><br><span class="line">[root@java-server local]# java -version </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除tomcat默认发布目录下面的内容:</span></span><br><span class="line">[root@java-server local]# rm -rf /usr/local/tomcat/webapps/*</span><br><span class="line">[root@java-server local]# cd /usr/local/tomcat/webapps/</span><br><span class="line">[root@java-server webapps]# ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建目录和脚本:</span></span><br><span class="line">[root@java-server ~]# mkdir /opt/script  #创建脚本目录</span><br><span class="line">[root@java-server ~]# vim app-jenkins.sh   #创建脚本</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 脚本内容在后面：</span></span><br><span class="line">[root@java-server ~]# chmod +x app-jenkins.sh  #添加执行权限</span><br><span class="line">[root@java-server ~]# mv app-jenkins.sh /opt/script/</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 脚本内容:</span></span><br><span class="line">[root@java-server script]# cat app-jenkins.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash">本脚本适用于jenkins持续集成，实现备份war包到代码更新上线！使用时请注意全局变量。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">================</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Defining variables</span></span><br><span class="line">export JAVA_HOME=/usr/local/java</span><br><span class="line">webapp_path="/usr/local/tomcat/webapps"</span><br><span class="line">tomcat_run="/usr/local/tomcat/bin"</span><br><span class="line">updata_path="/data/update/`date +%F-%T`"</span><br><span class="line">backup_path="/data/backup/`date +%F-%T`"</span><br><span class="line">tomcat_pid=`ps -ef | grep tomcat | grep -v grep | awk '&#123;print $2&#125;'`</span><br><span class="line">files_dir="easy-springmvc-maven"</span><br><span class="line">files="easy-springmvc-maven.war"</span><br><span class="line">job_path="/root/upload"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Preparation environment</span></span><br><span class="line">echo "Creating related directory"</span><br><span class="line">mkdir -p $updata_path</span><br><span class="line">mkdir -p $backup_path</span><br><span class="line"></span><br><span class="line">echo "Move the uploaded war package to the update directory"</span><br><span class="line">mv $job_path/$files $updata_path</span><br><span class="line"></span><br><span class="line">echo "========================================================="</span><br><span class="line">cd /opt</span><br><span class="line">echo "Backing up java project"</span><br><span class="line">if [ -f $webapp_path/$files ];then</span><br><span class="line">	tar czf $backup_path/`date +%F-%H`.tar.gz $webapp_path</span><br><span class="line">	if [ $? -ne 0 ];then</span><br><span class="line">		echo "打包失败，自动退出"</span><br><span class="line">		exit 1</span><br><span class="line">	else</span><br><span class="line">		echo "Checking if tomcat is started"</span><br><span class="line">		if [ -n "$tomcat_pid" ];then</span><br><span class="line">			kill -9 $tomcat_pid</span><br><span class="line">			if [ $? -ne 0 ];then</span><br><span class="line">				echo "tomcat关闭失败，将会自动退出"</span><br><span class="line">				exit 2</span><br><span class="line">			fi</span><br><span class="line">		fi</span><br><span class="line">		cd $webapp_path</span><br><span class="line">		rm -rf $files &amp;&amp; rm -rf $files_dir</span><br><span class="line">		cp $updata_path/$files $webapp_path</span><br><span class="line">		cd /opt</span><br><span class="line"><span class="meta">		$</span><span class="bash">tomcat_run/startup.sh</span></span><br><span class="line">		sleep 5</span><br><span class="line">		echo "显示tomcat的pid"</span><br><span class="line">		echo "`ps -ef | grep tomcat | grep -v grep | awk '&#123;print $2&#125;'`"</span><br><span class="line">		echo "tomcat startup"</span><br><span class="line">		echo "请手动查看tomcat日志。脚本将会自动退出"</span><br><span class="line">	fi</span><br><span class="line">else</span><br><span class="line">	echo "Checking if tomcat is started"</span><br><span class="line">        if [ -n "$tomcat_pid" ];then</span><br><span class="line">        	kill -9 $tomcat_pid</span><br><span class="line">                if [ $? -ne 0 ];then</span><br><span class="line">                	echo "tomcat关闭失败，将会自动退出"</span><br><span class="line">                       	exit 2</span><br><span class="line">                fi</span><br><span class="line">        fi</span><br><span class="line">	cp $updata_path/$files $webapp_path</span><br><span class="line"><span class="meta">	$</span><span class="bash">tomcat_run/startup.sh</span></span><br><span class="line">        sleep 5</span><br><span class="line">        echo "显示tomcat的pid"</span><br><span class="line">        echo "`ps -ef | grep tomcat | grep -v grep | awk '&#123;print $2&#125;'`"</span><br><span class="line">        echo "tomcat startup"</span><br><span class="line">        echo "请手动查看tomcat日志。脚本将会自动退出"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>



<h5 id="11-启用邮箱"><a href="#11-启用邮箱" class="headerlink" title="11.启用邮箱"></a>11.启用邮箱</h5><p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20210902225124311.png#id=FYeGR&originHeight=348&originWidth=1180&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<h5 id="12-构建项目"><a href="#12-构建项目" class="headerlink" title="12.构建项目"></a>12.构建项目</h5><p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20210908135616162.png#id=KdAEl&originHeight=690&originWidth=1032&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20210908135410486.png#id=v6wk4&originHeight=843&originWidth=1516&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<h5 id="13-访问tomcat测试"><a href="#13-访问tomcat测试" class="headerlink" title="13.访问tomcat测试"></a>13.访问tomcat测试</h5><h5 id="14-更新测试"><a href="#14-更新测试" class="headerlink" title="14.更新测试"></a>14.更新测试</h5><p>随便找台机器，作为开发人员</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> git <span class="built_in">clone</span> https://gitee.com/youngfit/easy-springmvc-maven.git</span></span><br><span class="line">[root@tomcat-server ~]# cd easy-springmvc-maven/</span><br><span class="line">[root@tomcat-server easy-springmvc-maven]# vim src/main/webapp/index.jsp</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670918518215-2552f3ca-ca0a-4a47-8b76-009acbafcbd2.png#averageHue=%2319120f&clientId=ue8bb4b21-b411-4&from=paste&height=270&id=ub6d69520&originHeight=337&originWidth=1374&originalType=binary&ratio=1&rotation=0&showTitle=false&size=45475&status=done&style=none&taskId=u1348085e-6537-4a05-82a6-afe703b709b&title=&width=1099.2" alt="image.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@tomcat-server easy-springmvc-maven]# git add *</span><br><span class="line">[root@tomcat-server easy-springmvc-maven]# git config --global user.email "feigeyoungfit@163.com"</span><br><span class="line">[root@tomcat-server easy-springmvc-maven]# git config --global user.name "feigeyoungfit"</span><br><span class="line">[root@tomcat-server easy-springmvc-maven]# git commit -m "username &amp; password"</span><br><span class="line">[master 5e9f4fd] username &amp; password</span><br><span class="line"> 1 file changed, 2 insertions(+), 2 deletions(-)</span><br><span class="line">[root@tomcat-server easy-springmvc-maven]# git push origin master</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919912187-f18cd605-47a6-4f10-8a12-ca11021e0e23.png#averageHue=%23e1e0e0&clientId=ue8bb4b21-b411-4&from=paste&height=537&id=ue4e4287b&originHeight=671&originWidth=828&originalType=binary&ratio=1&rotation=0&showTitle=false&size=71982&status=done&style=none&taskId=uf0b6f731-f9a5-425e-9a51-271bd54b105&title=&width=662.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919928266-aa1943a1-8b17-4a64-9e53-2a4fa91bbf92.png#averageHue=%23f9f8f6&clientId=ue8bb4b21-b411-4&from=paste&height=138&id=u6b6d26de&originHeight=172&originWidth=867&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22742&status=done&style=none&taskId=u523f16b2-2c0f-4398-8763-4b2d6d13623&title=&width=693.6" alt="image.png"></p>
<h5 id="16-准备开源项目"><a href="#16-准备开源项目" class="headerlink" title="16.准备开源项目"></a>16.准备开源项目</h5><p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919078484-e544e579-a23f-4806-9af8-c0625b6d369c.png#averageHue=%23fdfbfb&clientId=ue8bb4b21-b411-4&from=paste&height=753&id=u4588efc7&originHeight=941&originWidth=1436&originalType=binary&ratio=1&rotation=0&showTitle=false&size=106808&status=done&style=none&taskId=ucb40a564-95ff-4402-ba46-7a0979e49c1&title=&width=1148.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919234756-2fbc5a36-7d89-4fc0-a874-c4fe88dfa40b.png#averageHue=%23e6e6e5&clientId=ue8bb4b21-b411-4&from=paste&height=542&id=u0ccb950b&originHeight=677&originWidth=1431&originalType=binary&ratio=1&rotation=0&showTitle=false&size=73115&status=done&style=none&taskId=u6b8737ae-ae21-403b-9c44-51a226acaab&title=&width=1144.8" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919255822-92e587de-9e8e-4ed7-b6da-b9867306135c.png#averageHue=%23fbfafa&clientId=ue8bb4b21-b411-4&from=paste&height=392&id=ub4c62a24&originHeight=490&originWidth=1247&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47692&status=done&style=none&taskId=ucc0c67fa-5f9e-4a51-b054-ade525e3d73&title=&width=997.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919270148-4cbef903-4c46-45ed-aa52-5050b9dbb2ec.png#averageHue=%23fbfaf9&clientId=ue8bb4b21-b411-4&from=paste&height=371&id=ua0e36b8b&originHeight=464&originWidth=1427&originalType=binary&ratio=1&rotation=0&showTitle=false&size=59493&status=done&style=none&taskId=u8e5eb6d2-9958-448a-a909-033584fd918&title=&width=1141.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919311801-1ed69934-9bf2-4ac0-bf64-476be3affd3c.png#averageHue=%23fbf7f4&clientId=ue8bb4b21-b411-4&from=paste&height=372&id=ue6281309&originHeight=465&originWidth=1330&originalType=binary&ratio=1&rotation=0&showTitle=false&size=77373&status=done&style=none&taskId=ue0f2857e-bd61-4872-a256-54de1f07375&title=&width=1064" alt="image.png"><br>随便找台机器，作为开发人员的开发环境，需要安装git，以及配置git邮箱、用户名；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@tomcat-server tmp]# git clone https://gitee.com/youngfit/testweb.git</span><br><span class="line">[root@tomcat-server tmp]# cd testweb/</span><br></pre></td></tr></table></figure>
<p>将easy-springmvc-maven-master.zip 源码包，上传到开发人员机器<br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919554706-240cfaa3-2ac9-43f1-b76e-c5b493b9684c.png#averageHue=%231a100e&clientId=ue8bb4b21-b411-4&from=paste&height=60&id=u80be9d1b&originHeight=75&originWidth=956&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9004&status=done&style=none&taskId=u09afd9a8-a675-446d-8bc5-537ea9d1b20&title=&width=764.8" alt="image.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@tomcat-server testweb]# yum -y install unzip</span><br><span class="line">[root@tomcat-server testweb]# unzip easy-springmvc-maven-master.zip</span><br><span class="line">[root@tomcat-server testweb]# cp -r easy-springmvc-maven-master/* .</span><br><span class="line">cp: overwrite ‘./README.md’? y</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919639327-a296021b-c0c2-4495-bfd4-26b4538475fb.png#averageHue=%23100a09&clientId=ue8bb4b21-b411-4&from=paste&height=66&id=ub370334a&originHeight=82&originWidth=1611&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14170&status=done&style=none&taskId=u6297a9cc-c9cc-472c-9e76-8bdf8f5b8b0&title=&width=1288.8" alt="image.png"><br>因为已经拷贝出来了。删除没用的压缩包、目录、文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@tomcat-server testweb]# rm -rf easy-springmvc-maven-master easy-springmvc-maven-master.zip </span><br><span class="line">[root@tomcat-server testweb]# ls</span><br><span class="line">pom.xml  README.en.md  README.md  src</span><br><span class="line">[root@tomcat-server testweb]# rm -rf README.en.md </span><br><span class="line">[root@tomcat-server testweb]# ls</span><br><span class="line">pom.xml  README.md  src</span><br><span class="line">[root@tomcat-server testweb]# git add *</span><br><span class="line">[root@tomcat-server testweb]# git commit -m "version1"</span><br><span class="line">[root@tomcat-server testweb]# git push origin master</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919712737-dd65eae8-d3b5-4747-bce8-2b2ad0e6ae05.png#averageHue=%2314110f&clientId=ue8bb4b21-b411-4&from=paste&height=261&id=u362b0106&originHeight=326&originWidth=987&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43757&status=done&style=none&taskId=u0293cfea-497b-4f34-93cd-327b3cdd417&title=&width=789.6" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670919730307-6ed78e76-c901-4f1d-9b7a-61473ef21966.png#averageHue=%23fbf9f7&clientId=ue8bb4b21-b411-4&from=paste&height=459&id=u666e6a25&originHeight=574&originWidth=1181&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57690&status=done&style=none&taskId=u3a97539a-8010-41f1-b0be-9b3c680f3bb&title=&width=944.8" alt="image.png"></p>
<hr>
<h3 id="三、Jenkins-Gitlab-maven项目实战"><a href="#三、Jenkins-Gitlab-maven项目实战" class="headerlink" title="三、Jenkins+Gitlab+maven项目实战"></a>三、Jenkins+Gitlab+maven项目实战</h3><p>Jenkins服务器去拉取代码。所以要下载git客户端</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins-server ~]# yum -y install git</span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050943547.png" alt="image-20240905094347496"></p>
<p><strong>关闭ssh密钥认证</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060714828.png" alt="image-20240606071447681"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050942962.png" alt="image-20240905094202917"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060712798.png" alt="img"></p>
<p><strong>开始构建maven项目</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050941876.png" alt="image-20240905094127648"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060719247.png" alt="image-20240606071945163"></p>
<p>[root@jenkins ~]# cat /root/.ssh/id_rsa</p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670984467041-34a29369-80a9-4899-aa2b-ac9d87da0b2f.png#averageHue=%23faf6f6&clientId=u57f8f598-4783-4&from=paste&height=546&id=u6adabec6&originHeight=683&originWidth=1393&originalType=binary&ratio=1&rotation=0&showTitle=false&size=55101&status=done&style=none&taskId=uc846644c-9248-4ed5-bb22-fec57d76c8f&title=&width=1114.4" alt="image.png"></p>
<p>==<strong>Gitlab配置jenkins公钥</strong>==</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]# cat /root/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050944325.png" alt="image-20240905094444287"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050945288.png" alt="image-20240905094527221"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050947183.png" alt="image-20240905094720026"></p>
<p>==<strong>编译后设置</strong>==</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060722445.png" alt="image-20240606072233374"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060723001.png" alt="image-20240606072318936"></p>
<p><img src="/2024/09/05/Jenkins_CI_CD%E5%BA%94%E7%94%A8/Jenkins_CI_CD%E5%BA%94%E7%94%A8/C:%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240905094825309.png" alt="image-20240905094825309"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050949100.png" alt="image-20240905094908060"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670984967094-cb72f86f-bc21-492d-960a-0bac7994bf76.png#averageHue=%23f1f1f0&clientId=u57f8f598-4783-4&from=paste&height=578&id=uf941f65c&originHeight=722&originWidth=1628&originalType=binary&ratio=1&rotation=0&showTitle=false&size=71489&status=done&style=none&taskId=ucb0896d2-21a2-4103-9a09-132151d0fe0&title=&width=1302.4" alt="image.png"></p>
<p><strong>访问测试</strong><br><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409050950396.png" alt="image-20240905095008329"><br><strong>开发更新代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@git-client mnt]# git clone git@192.168.91.168:root&#x2F;cloudweb.git</span><br><span class="line">[root@git-client mnt]# cd cloudweb&#x2F;</span><br><span class="line">[root@git-client mnt]# vim src&#x2F;main&#x2F;webapp&#x2F;index.jsp</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670985229589-55325db8-cc65-4369-baf6-91c3e369e7e9.png#averageHue=%23100a09&clientId=u57f8f598-4783-4&from=paste&height=254&id=u37402819&originHeight=317&originWidth=1362&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37929&status=done&style=none&taskId=u47116c1a-9c12-4b57-ba0f-81ce0e09d87&title=&width=1089.6" alt="image.png"></p>
<h3 id="四、Jenkins-git参数化构建"><a href="#四、Jenkins-git参数化构建" class="headerlink" title="四、Jenkins git参数化构建"></a>四、Jenkins git参数化构建</h3><p>git参数化构建：开发人员推送代码之前，对此版本的代码，打一个标签(tag)。我们可以认作为是此套代码的版本号。后续可以方便我们进行版本之间的切换。尤其是刚上线一套代码有问题，可以运用jenkins立即进行版本回退/切换；</p>
<p>Gitlab仓库代码准备：<br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1654067572140-a2b87e7c-1721-430e-b0d4-664bb7bbe168.png#averageHue=%23f8f6f5&clientId=u6057b347-398d-4&from=paste&height=566&id=ubade1162&originHeight=708&originWidth=1399&originalType=binary&ratio=1&rotation=0&showTitle=false&size=82385&status=done&style=none&taskId=u0fba8d82-3adc-41d3-83fb-c8bb62a7fde&title=&width=1119.2" alt="image.png"><br>首先，需要安装插件”Git Parameter”。如图</p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20220326112424871.png#id=c9sRL&originHeight=619&originWidth=1782&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><strong>手动测试：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@git-client ~]# git clone git@192.168.91.168:root/cloudweb.git</span><br><span class="line">[root@git-client ~]# cd cloudweb</span><br><span class="line">[root@git-client cloudweb]# vim src/main/webapp/index.jsp</span><br></pre></td></tr></table></figure>

<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20220326113630658.png#id=C2EuJ&originHeight=463&originWidth=1289&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@gitlab easy-springmvc-maven]# git add *</span><br><span class="line">[root@gitlab easy-springmvc-maven]# git commit -m "修改用户为密码"</span><br><span class="line">[root@gitlab easy-springmvc-maven]# git tag -a "v1.0" -m "修改用户为密码"</span><br><span class="line">[root@gitlab easy-springmvc-maven]# git tag  #查看一下</span><br><span class="line">v1.0</span><br><span class="line">[root@gitlab easy-springmvc-maven]# git push origin v1.0</span><br><span class="line">[root@gitlab easy-springmvc-maven]#</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670987518538-79276bf9-3ac9-443a-9e89-06d8cadf420d.png#averageHue=%23faf8f6&clientId=u57f8f598-4783-4&from=paste&height=558&id=u5ab13157&originHeight=698&originWidth=1224&originalType=binary&ratio=1&rotation=0&showTitle=false&size=60919&status=done&style=none&taskId=u9e62e22f-f157-4f65-b376-03f22aa5879&title=&width=979.2" alt="image.png"></p>
<h4 id="1-配置Jenkins参数化构建（tag方式）"><a href="#1-配置Jenkins参数化构建（tag方式）" class="headerlink" title="1. 配置Jenkins参数化构建（tag方式）"></a>1. 配置Jenkins参数化构建（tag方式）</h4><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060125491.png" alt="image-20240606012539201"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060126396.png" alt="image-20240606012642272"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060127090.png" alt="image-20240606012743783"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042309949.png" alt="image-20240904230953886"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042311411.png" alt="image-20240904231101366"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409051610470.png" alt="image-20240905161021397"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060143446.png" alt="image-20240606014338355"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202406060143393.png" alt="image-20240606014352191"></p>
<p><strong>开发人员再次更新代码，推送仓库</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@git-client cloudweb]# vim src/main/webapp/index.jsp</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670988048171-5da1ebd5-d6ad-4f68-ac47-6e268998ed00.png#averageHue=%23070302&clientId=u57f8f598-4783-4&from=paste&height=254&id=u9452d61e&originHeight=318&originWidth=1358&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34425&status=done&style=none&taskId=u4ba042e4-bd77-4868-8219-5eabca205b1&title=&width=1086.4" alt="image.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@git-client cloudweb]# git add *</span><br><span class="line">[root@git-client cloudweb]# git commit -m "用户user &amp; 密码pass"</span><br><span class="line">[master ffa6acf] 用户user &amp; 密码pass</span><br><span class="line"> 1 file changed, 2 insertions(+), 2 deletions(-)</span><br><span class="line">[root@git-client cloudweb]# git tag -a "v1.1" -m "用户user &amp; 密码pass"</span><br><span class="line">[root@git-client cloudweb]# git tag</span><br><span class="line">v1.0</span><br><span class="line">v1.1</span><br><span class="line">[root@git-client cloudweb]# git push origin v1.1</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670988152608-80c3a16b-83e9-4363-b7f4-ba00d661a53c.png#averageHue=%23faf8f6&clientId=u57f8f598-4783-4&from=paste&height=526&id=ua1da8988&originHeight=657&originWidth=1247&originalType=binary&ratio=1&rotation=0&showTitle=false&size=59352&status=done&style=none&taskId=ue251d857-c5bd-422e-9950-f730f20c6f6&title=&width=997.6" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2022/png/23214851/1670988252805-47ea6916-a09e-44c6-a3a1-efd91dfdc5f4.png#averageHue=%23fbfafa&clientId=u57f8f598-4783-4&from=paste&height=437&id=u152c49b0&originHeight=546&originWidth=860&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34691&status=done&style=none&taskId=u1a502756-cb0b-46f3-abcb-5c6105cba0f&title=&width=688" alt="image.png"><br>访问测试<br>尝试进行版本切换，再访问测试</p>
<h4 id="2-配置Jenkins参数化构建-commit修订号"><a href="#2-配置Jenkins参数化构建-commit修订号" class="headerlink" title="2. 配置Jenkins参数化构建(commit修订号)"></a>2. 配置Jenkins参数化构建(commit修订号)</h4><p>开发人员如果不会打标签，或者说他们不愿意配合打标签<br><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042313326.png" alt="image-20240904231317277"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042313722.png" alt="image-20240904231352677"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042314229.png" alt="image-20240904231415192"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042314484.png" alt="image-20240904231444426"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042315878.png" alt="image-20240904231509849"></p>
<blockquote>
<p><strong>Root POM    # 指定编译文件</strong><br><strong>Goals and options    # 编译命令</strong></p>
</blockquote>
<p>测试：</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202409042315313.png" alt="image-20240904231547271"></p>
<h3 id="五、Jenkins多节点配置"><a href="#五、Jenkins多节点配置" class="headerlink" title="五、Jenkins多节点配置"></a>五、Jenkins多节点配置</h3><p>在企业里面使用Jenkins自动部署+测试平台时，每天更新发布几个网站版本,很频繁,但是对于一些大型的企业来讲，Jenkins就需要同时处理很多的任务，这时候就需要借助Jenkins多个node或者我们所说的Jenkins分布式SLAVE，今天我们带大家来学习Jenkins多实例的配置；</p>
<p>添加Linux平台Jenkins SLAVE配置：</p>
<ol>
<li>由于Jenkins是Java程序，添加的SLAVE客户端服务器必须安装Java JDK环境；</li>
<li>创建远程执行Jenkins任务的用户，一般为Jenkins用户，工作目录为/home/Jenkins;</li>
<li>Jenkins服务器免秘钥登录Slave服务器或者通过用户名和密码登录；</li>
</ol>
<h4 id="1-添加从节点"><a href="#1-添加从节点" class="headerlink" title="1.添加从节点"></a>1.添加从节点</h4><p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009204536504.png#id=SoNjI&originHeight=845&originWidth=1692&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009204609760.png#id=de9Yc&originHeight=631&originWidth=1893&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009204648831.png#id=qbSD8&originHeight=558&originWidth=1895&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<h4 id="2-参数详解"><a href="#2-参数详解" class="headerlink" title="2.参数详解"></a>2.参数详解</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">名字：节点的名字</span><br><span class="line">描述：说明这个节点的用途等</span><br><span class="line">of executors:并发构建数量</span><br><span class="line">远程工作目录：用于存放jenkins的工作空间的</span><br><span class="line">标签：分配job会以标签的名称去分配</span><br><span class="line">用法：节点的使用策略</span><br><span class="line">启动方法：windows的话就不要给自己添堵了，选择 Java web start</span><br></pre></td></tr></table></figure>

<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20220328104326621.png#id=kdaUn&originHeight=620&originWidth=1300&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009221943512.png#id=qG4LQ&originHeight=607&originWidth=924&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009221815103.png#id=ubYos&originHeight=655&originWidth=945&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<h4 id="3-指定java命令路径"><a href="#3-指定java命令路径" class="headerlink" title="3.指定java命令路径"></a>3.指定java命令路径</h4><p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009221903569.png#id=fMA2s&originHeight=811&originWidth=933&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009222015840.png#id=d2gER&originHeight=366&originWidth=1264&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<h4 id="4-测试从节点"><a href="#4-测试从节点" class="headerlink" title="4.测试从节点"></a>4.测试从节点</h4><p>项目指定到哪个节点运行。</p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20220328104400072.png#id=yHjLw&originHeight=528&originWidth=1559&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009222752678.png#id=ZbUbb&originHeight=691&originWidth=1584&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt></p>
<p><img src="https://youngfitfei.oss-cn-beijing.aliyuncs.com/img/image-20211009224634465.png#id=pjo2H&originHeight=270&originWidth=1481&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt>    </p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">L66</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD%E5%BA%94%E7%94%A8/Jenkins_CI_CD%E5%BA%94%E7%94%A8/">https://l66stbz.github.io/2024/09/05/Jenkins_CI_CD%E5%BA%94%E7%94%A8/Jenkins_CI_CD%E5%BA%94%E7%94%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://l66stbz.github.io" target="_blank">L66</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/Ansible/">Ansible</a><a class="post-meta__tags" href="/tags/Jenkins/">Jenkins</a></div><div class="post_share"><div class="social-share" data-image="https://l66stbz.github.io/2024/09/09/若依项目动静分离/若依项目动静分离项目实现/6.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2024/09/06/Jenkins%E7%BB%93%E5%90%88Ansible/Jenkins%E7%BB%93%E5%90%88Ansible%E5%AE%9E%E6%88%98/"><img class="prev_cover" src="https://l66stbz.github.io/2024/09/06/Jenkins结合Ansible/Jenkins结合Ansible实战/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Jenkins结合Ansible实战</div></div></a></div><div class="next-post pull_right"><a href="/2024/09/04/gitlab%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/Gitlab%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/"><img class="next_cover" src="https://l66stbz.github.io/2024/09/04/gitlab代码管理/Gitlab企业级代码管理/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Gitlab企业级代码管理</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2024/09/06/Jenkins结合Ansible/Jenkins结合Ansible实战/" title="Jenkins结合Ansible实战"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/06/Jenkins结合Ansible/Jenkins结合Ansible实战/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-06</div><div class="relatedPosts_title">Jenkins结合Ansible实战</div></div></a></div><div class="relatedPosts_item"><a href="/2024/08/20/企业自动化运维神器Ansible(1)/" title="企业自动化运维神器Ansible(1)"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/20/企业自动化运维神器Ansible(1)/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-20</div><div class="relatedPosts_title">企业自动化运维神器Ansible(1)</div></div></a></div><div class="relatedPosts_item"><a href="/2024/08/21/企业自动化运维神器Ansible(2)/" title="企业自动化运维神器Ansible(2)"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/21/企业自动化运维神器Ansible(2)/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-21</div><div class="relatedPosts_title">企业自动化运维神器Ansible(2)</div></div></a></div><div class="relatedPosts_item"><a href="/2024/09/03/study/test/" title="study"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/03/study/test/1.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-03</div><div class="relatedPosts_title">study</div></div></a></div><div class="relatedPosts_item"><a href="/2024/07/03/存储管理/" title="Linux存储管理(lvm,swap,raid)"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/07/03/存储管理/8.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-07-03</div><div class="relatedPosts_title">Linux存储管理(lvm,swap,raid)</div></div></a></div><div class="relatedPosts_item"><a href="/2024/08/16/RabbitMQ消息队列/" title="RabbitMQ消息队列"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/16/RabbitMQ消息队列/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-16</div><div class="relatedPosts_title">RabbitMQ消息队列</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By L66</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/third-party/click_heart.js"></script></body></html>