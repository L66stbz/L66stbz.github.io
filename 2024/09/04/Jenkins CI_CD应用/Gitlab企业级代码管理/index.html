<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Git工具与gitee、gitlab和github | L66</title><meta name="description" content="[TOC] 1、简介GitLab 是一个综合性的 DevOps 平台，主要用于代码存储和项目管理。它集成了 Git 仓库管理、持续集成和持续交付（CI&#x2F;CD）、项目管理、安全性等多种功能。   2、功能 提供 Git 仓库托管服务，支持分支管理、代码审查和合并请求。   提供详细的代码历史记录和变更日志，方便开发人员跟踪代码变动。   持续集成（CI），自动化构建、测试和集成代码 。3、Gitla"><meta name="keywords" content="Linux,Gitlab"><meta name="author" content="L66"><meta name="copyright" content="L66"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/3.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Git工具与gitee、gitlab和github"><meta name="twitter:description" content="[TOC] 1、简介GitLab 是一个综合性的 DevOps 平台，主要用于代码存储和项目管理。它集成了 Git 仓库管理、持续集成和持续交付（CI&#x2F;CD）、项目管理、安全性等多种功能。   2、功能 提供 Git 仓库托管服务，支持分支管理、代码审查和合并请求。   提供详细的代码历史记录和变更日志，方便开发人员跟踪代码变动。   持续集成（CI），自动化构建、测试和集成代码 。3、Gitla"><meta name="twitter:image" content="https://l66stbz.github.io/2024/09/03/Jenkins CI_CD应用/Gitlab企业级代码管理/1.png"><meta property="og:type" content="article"><meta property="og:title" content="Git工具与gitee、gitlab和github"><meta property="og:url" content="https://l66stbz.github.io/2024/09/04/Jenkins%20CI_CD%E5%BA%94%E7%94%A8/Gitlab%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/"><meta property="og:site_name" content="L66"><meta property="og:description" content="[TOC] 1、简介GitLab 是一个综合性的 DevOps 平台，主要用于代码存储和项目管理。它集成了 Git 仓库管理、持续集成和持续交付（CI&#x2F;CD）、项目管理、安全性等多种功能。   2、功能 提供 Git 仓库托管服务，支持分支管理、代码审查和合并请求。   提供详细的代码历史记录和变更日志，方便开发人员跟踪代码变动。   持续集成（CI），自动化构建、测试和集成代码 。3、Gitla"><meta property="og:image" content="https://l66stbz.github.io/2024/09/03/Jenkins CI_CD应用/Gitlab企业级代码管理/1.png"><meta property="article:published_time" content="2024-09-04T13:50:00.000Z"><meta property="article:modified_time" content="2024-09-07T01:53:56.745Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://l66stbz.github.io/2024/09/04/Jenkins%20CI_CD%E5%BA%94%E7%94%A8/Gitlab%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/"><link rel="next" title="Git工具与gitee、gitlab和github" href="https://l66stbz.github.io/2024/09/03/Jenkins%20CI_CD%E5%BA%94%E7%94%A8/Git%E5%B7%A5%E5%85%B7%E4%B8%8Egitee%E3%80%81gitlab%E5%92%8Cgithub/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="L66" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/2.jpg" onerror="onerror=null;src='/img/2.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">49</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">32</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、简介"><span class="toc-number">1.</span> <span class="toc-text">1、简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、功能"><span class="toc-number">2.</span> <span class="toc-text">2、功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、Gitlab安装"><span class="toc-number">3.</span> <span class="toc-text">3、Gitlab安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更改Root密码"><span class="toc-number">4.</span> <span class="toc-text">更改Root密码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建新项目"><span class="toc-number"></span> <span class="toc-text">创建新项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#拉取项目代码仓库"><span class="toc-number"></span> <span class="toc-text">拉取项目代码仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#上传SSH公钥"><span class="toc-number"></span> <span class="toc-text">上传SSH公钥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#拉取代码"><span class="toc-number"></span> <span class="toc-text">拉取代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tag版本推送"><span class="toc-number"></span> <span class="toc-text">Tag版本推送</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gitlab备份"><span class="toc-number"></span> <span class="toc-text">Gitlab备份</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gitlab数据恢复"><span class="toc-number"></span> <span class="toc-text">Gitlab数据恢复</span></a></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://l66stbz.github.io/2024/09/03/Jenkins CI_CD应用/Gitlab企业级代码管理/1.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">L66</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Git工具与gitee、gitlab和github</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2024-09-04 21:50:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2024-09-04</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2024-09-07 09:53:56"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2024-09-07</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>[TOC]</p>
<h3 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h3><p>GitLab 是一个综合性的 DevOps 平台，主要用于代码存储和项目管理。它集成了 Git 仓库管理、持续集成和持续交付（CI/CD）、项目管理、安全性等多种功能。  </p>
<h3 id="2、功能"><a href="#2、功能" class="headerlink" title="2、功能"></a>2、功能</h3><ul>
<li>提供 Git 仓库托管服务，支持分支管理、代码审查和合并请求。  </li>
<li>提供详细的代码历史记录和变更日志，方便开发人员跟踪代码变动。  </li>
<li>持续集成（CI），自动化构建、测试和集成代码 。<h3 id="3、Gitlab安装"><a href="#3、Gitlab安装" class="headerlink" title="3、Gitlab安装"></a>3、Gitlab安装</h3></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@gitlab ~]<span class="comment"># ls</span></span><br><span class="line">gitlab-ce-12.6.3-ce.0.el7.x86_64.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装Gitlab</span></span><br><span class="line">[root@gitlab ~]<span class="comment"># yum  localinstall -y gitlab-ce-12.6.3-ce.0.el7.x86_64.rpm</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717504165470-64e80315-0d84-4dfe-84fe-c0566cffaa9c.png#averageHue=%23020101&clientId=ud4a39c03-f9f1-4&from=paste&height=1077&id=u29d89dc5&originHeight=1077&originWidth=1963&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=34763&status=done&style=none&taskId=u1d348a36-f62a-42f0-98d2-63f3d6030ff&title=&width=1963" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建ssl证书存放路径</span></span><br><span class="line">[root@gitlab ~]<span class="comment"># mkdir /etc/gitlab/ssl</span></span><br><span class="line"><span class="comment"># 上传证书</span></span><br><span class="line">[root@gitlab ssl]<span class="comment"># ll /etc/gitlab/ssl/privkey.pem </span></span><br><span class="line">-rw-r--r--. 1 root root 241 6月   4 20:32 /etc/gitlab/ssl/privkey.pem</span><br><span class="line">[root@gitlab ssl]<span class="comment"># ll /etc/gitlab/ssl/fullchain.pem </span></span><br><span class="line">-rw-r--r--. 1 root root 3306 6月   4 20:32 /etc/gitlab/ssl/fullchain.pem</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">[root@gitlab ~]<span class="comment">#  egrep -v "^(#|$)" /etc/gitlab/gitlab.rb </span></span><br><span class="line"><span class="comment"># 定义 GitLab 实例的外部访问 URL。用户通过此 URL 访问 GitLab 界面。</span></span><br><span class="line">external_url <span class="string">'https://gitlab.tanke.love'</span></span><br><span class="line"><span class="comment"># 设置 GitLab 的时区为 "Asia/Shanghai"。这影响到 GitLab 中时间显示的区域设置。</span></span><br><span class="line">gitlab_rails[<span class="string">'time_zone'</span>] = <span class="string">'Asia/Shanghai'</span></span><br><span class="line"><span class="comment"># 定义 Git 数据存储的路径。</span></span><br><span class="line">git_data_dirs(&#123;</span><br><span class="line">  <span class="string">"default"</span> =&gt; &#123;</span><br><span class="line">    <span class="string">"path"</span> =&gt; <span class="string">"/mnt/nfs-01/git-data"</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment"># 设置 GitLab Shell 使用的 SSH 端口。</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_shell_ssh_port'</span>] = 22</span><br><span class="line"><span class="comment"># 启用 Nginx，GitLab 使用 Nginx 作为 Web 服务器。</span></span><br><span class="line">nginx[<span class="string">'enable'</span>] = <span class="literal">true</span></span><br><span class="line"><span class="comment"># 设置最大请求体大小为 250MB</span></span><br><span class="line">nginx[<span class="string">'client_max_body_size'</span>] = <span class="string">'250m'</span></span><br><span class="line"><span class="comment"># 启用 HTTP 到 HTTPS 的重定向，确保所有流量通过 HTTPS。</span></span><br><span class="line">nginx[<span class="string">'redirect_http_to_https'</span>] = <span class="literal">true</span></span><br><span class="line"><span class="comment"># 设置重定向端口为 80。</span></span><br><span class="line">nginx[<span class="string">'redirect_http_to_https_port'</span>] = 80</span><br><span class="line"><span class="comment"># 指定 SSL 证书和密钥的位置，用于 HTTPS。</span></span><br><span class="line">nginx[<span class="string">'ssl_certificate'</span>] = <span class="string">"/tmp/fullchain.pem"</span></span><br><span class="line">nginx[<span class="string">'ssl_certificate_key'</span>] = <span class="string">"/tmp/privkey.pem"</span></span><br><span class="line">nginx[<span class="string">'ssl_ciphers'</span>] = <span class="string">"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384"</span></span><br><span class="line">nginx[<span class="string">'ssl_prefer_server_ciphers'</span>] = <span class="string">"off"</span></span><br><span class="line"><span class="comment"># 定义支持的 SSL/TLS 协议版本。</span></span><br><span class="line">nginx[<span class="string">'ssl_protocols'</span>] = <span class="string">"TLSv1.2 TLSv1.3"</span></span><br><span class="line"><span class="comment"># 配置 SSL 会话缓存，提高性能。</span></span><br><span class="line">nginx[<span class="string">'ssl_session_cache'</span>] = <span class="string">"shared:SSL:10m"</span></span><br><span class="line"><span class="comment"># 超时时间。</span></span><br><span class="line">nginx[<span class="string">'ssl_session_timeout'</span>] = <span class="string">"1d"</span></span><br><span class="line"><span class="comment"># 启用 Gzip 压缩，提高传输效率。</span></span><br><span class="line">nginx[<span class="string">'gzip_enabled'</span>] = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载配置</span></span><br><span class="line">[root@gitlab ~]<span class="comment"># gitlab-ctl  reconfigure</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717511446380-79512ef7-64af-47be-b329-6ae46a65df86.png#averageHue=%230f0b0a&clientId=ud4a39c03-f9f1-4&from=paste&height=252&id=u9bd50b14&originHeight=378&originWidth=1887&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=45017&status=done&style=none&taskId=u5f202add-ac73-4ba2-b753-a42d49a3191&title=&width=1258" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/gitlab/initial_root_password #密码存放地</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动实例</span></span><br><span class="line">[root@localhost ~]<span class="comment"># gitlab-ctl start</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717511508604-33dd912f-fc49-4682-8a15-6d970cbfb37a.png#averageHue=%23110d0b&clientId=ud4a39c03-f9f1-4&from=paste&height=229&id=uca8d4221&originHeight=343&originWidth=1885&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=45740&status=done&style=none&taskId=u8fb9e4d0-584c-41bb-8d19-059a1afb9de&title=&width=1256.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717511649703-c1ad430c-796b-4eb8-a42b-93729d734b27.png#averageHue=%23fdfdfd&clientId=ud4a39c03-f9f1-4&from=paste&height=719&id=u88ebd1c1&originHeight=1078&originWidth=2535&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=89948&status=done&style=none&taskId=ued082b84-0139-4f9d-b8e7-127f6641c56&title=&width=1690" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717511741989-a0ea2451-1fe5-44c8-a9f3-1112c473bfa1.png#averageHue=%23fdfaf7&clientId=ud4a39c03-f9f1-4&from=paste&height=933&id=u4bf80155&originHeight=1399&originWidth=2560&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=118918&status=done&style=none&taskId=u3f723131-793e-40dd-b988-f37ed4dc61f&title=&width=1706.6666666666667" alt="image.png"></p>
<blockquote>
<p>任何人都可以注册帐户。<br>只允许任何人在GitLab实例上注册您打算供任何人使用的帐户。允许任何人注册会使GitLab实例更容易受到攻击。</p>
</blockquote>
<h3 id="更改Root密码"><a href="#更改Root密码" class="headerlink" title="更改Root密码"></a>更改Root密码</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717512581596-ff7100a4-3813-4816-a95a-1ee51f52bf91.png#averageHue=%23fefefd&clientId=ued8afcd3-562e-4&from=paste&height=945&id=u23c54d9e&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=96323&status=done&style=none&taskId=u4680a946-0095-4902-ac91-fe8d66117ba&title=&width=1658.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717512604305-2ad2e6d0-4f14-4c09-8383-8cae2cd73da3.png#averageHue=%23f6f4f3&clientId=ued8afcd3-562e-4&from=paste&height=945&id=ue69e4bb4&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=272559&status=done&style=none&taskId=ufbaea0f7-2e84-4228-b911-b1d94c02205&title=&width=1658.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717512639715-0788e51b-e874-47b1-bbb3-4facca124a7d.png#averageHue=%23fcfbfa&clientId=ued8afcd3-562e-4&from=paste&height=945&id=ua48dc88c&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=130595&status=done&style=none&taskId=u0cb0ced9-c95c-492b-914c-4969b0d30f1&title=&width=1658.6666666666667" alt="image.png"></p>
<h1 id="创建新项目"><a href="#创建新项目" class="headerlink" title="创建新项目"></a>创建新项目</h1><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717512742078-7b1c8a9b-9d5c-43c6-8d0f-9805378dfbce.png#averageHue=%23fefefe&clientId=ued8afcd3-562e-4&from=paste&height=945&id=ua8212c26&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=82105&status=done&style=none&taskId=u6b60cce1-468e-40d9-b5e1-26d51ebed1d&title=&width=1658.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717512764981-3ea52687-3193-4c81-9087-35b037d9ba99.png#averageHue=%23fdfcfc&clientId=ued8afcd3-562e-4&from=paste&height=945&id=u365ec4f6&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=124426&status=done&style=none&taskId=u66a32b35-50fe-4d43-a090-a37b3a959bd&title=&width=1658.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717512948284-2552f41a-6769-4a3a-98d8-3277502b268c.png#averageHue=%23fdfdfc&clientId=ued8afcd3-562e-4&from=paste&height=945&id=u7cb798c6&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=185639&status=done&style=none&taskId=uac574d60-a67d-462f-87aa-b79f214eac5&title=&width=1658.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717513019451-da05d9bb-dd5b-4f0a-bacb-557a5dbb8cd7.png#averageHue=%23f9f9f9&clientId=ued8afcd3-562e-4&from=paste&height=945&id=ue6c4a0f7&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=238509&status=done&style=none&taskId=ubed1cb15-75f0-42c3-b771-67c422966ff&title=&width=1658.6666666666667" alt="image.png"></p>
<h2 id="拉取项目代码仓库"><a href="#拉取项目代码仓库" class="headerlink" title="拉取项目代码仓库"></a>拉取项目代码仓库</h2><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717513066946-51ce8803-c576-493f-94b0-ac43344d7cca.png#averageHue=%23f9f8f8&clientId=ued8afcd3-562e-4&from=paste&height=945&id=u07def684&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=267356&status=done&style=none&taskId=ubec119dd-9831-4e31-bb46-6b4ec11e52c&title=&width=1658.6666666666667" alt="image.png"></p>
<h2 id="上传SSH公钥"><a href="#上传SSH公钥" class="headerlink" title="上传SSH公钥"></a>上传SSH公钥</h2><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717513114354-0ecb51e2-4ff2-4e98-9d7c-70120b352ca0.png#averageHue=%23f8f8f8&clientId=ued8afcd3-562e-4&from=paste&height=945&id=uffd77bb6&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=248403&status=done&style=none&taskId=uda2210e0-10f0-44f9-bb6e-9c2262ee871&title=&width=1658.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717513138518-474800a3-3ba3-407f-b6d7-7a3d721ffc94.png#averageHue=%23f6f4f3&clientId=ued8afcd3-562e-4&from=paste&height=945&id=ua08d10ef&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=276008&status=done&style=none&taskId=ua18169eb-da0e-4a95-bc9a-a50144dc331&title=&width=1658.6666666666667" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看本地公钥</span></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/qf2401 (master)</span><br><span class="line">$ cat ~/.ssh/id_rsa.pub</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDN9T3s7uqnOSI2hME0EOdyWQvVw8Cu0uBFFH/vEIaBsyzJylAPI/td0QxLHnCSbRrD+GrIfh99/5giVTx0vNo6dBwhiTp3BlrQhVgBXCqd9evH5Mn03JZBK9aIrUumliaBpWezXh4Se2OSxlpAKt1aNopw8Acvh9IvLCPEOcKHdwEloogz4nRqkG9ZGfuObXeu9sxWt7efg3eASExA7H+x9bvGOkVLm33V+LFWD1/ln4nwGbkvQkh0fCTHZiWbSCTpXKQtmknvBfrT7Fn2VtUhP4jWZhfuft1Ty2j2Jmajc6ZbgEc5z1M3JQo+KoVYlKlaONs5+u/Pmj6pdqpinMo0klwI4hJsO2J0TN+j9S6tR8V60yB5Ep8KpDpsRwANEXVaHwsBfIZEh7Cqn1rabf/mE2bXoXmRb8DDc4b/ycF9DLi8ZtHs9CcJWcs8eTuiqgyON75wNGILC4pxJLCFHEQ7JMCa3yCN/2XVSNRIeXdgaOScj2x68ezcJ+zEWEKio6E= hjm131641@163.com</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717513217081-7533de0e-b6aa-4360-8422-80a29b6d333b.png#averageHue=%23f9f8f8&clientId=ued8afcd3-562e-4&from=paste&height=945&id=u88a8b5a3&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=298441&status=done&style=none&taskId=u56aac5bf-d1cf-4dc7-9c48-eb8dcc0e975&title=&width=1658.6666666666667" alt="image.png"></p>
<h2 id="拉取代码"><a href="#拉取代码" class="headerlink" title="拉取代码"></a>拉取代码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取代码</span></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop</span><br><span class="line">$ git <span class="built_in">clone</span> git@gitlab.tanke.love:gitlab-instance-d5d699e8/study-test-cloud.git</span><br><span class="line">Cloning into <span class="string">'study-test-cloud'</span>...</span><br><span class="line">remote: Enumerating objects: 3, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">Receiving objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop</span><br><span class="line">$ ls</span><br><span class="line">Bandicam/  desktop.ini  qf2401/  study-test-cloud/  work/  郑州千锋/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试</span></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"# 铭哥真帅"</span> &gt; test.md</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git add .</span><br><span class="line">warning: <span class="keyword">in</span> the working copy of <span class="string">'test.md'</span>, LF will be replaced by CRLF the next time Git touches it</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git commit  -am <span class="string">"first commit"</span></span><br><span class="line">[main 1416f75] first commit</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"> create mode 100644 test.md</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git push origin main</span><br><span class="line">Enumerating objects: 4, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (4/4), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 32 threads</span><br><span class="line">Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 280 bytes | 280.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)</span><br><span class="line">To gitlab.tanke.love:gitlab-instance-d5d699e8/study-test-cloud.git</span><br><span class="line">   7f887e5..1416f75  main -&gt; main</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717513417941-ee049544-9882-4e41-a9de-98ddc3793bb5.png#averageHue=%23fbfafa&clientId=ued8afcd3-562e-4&from=paste&height=945&id=u7297f72b&originHeight=1417&originWidth=2488&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=161087&status=done&style=none&taskId=ub1983467-349a-4486-987b-c2462bddda7&title=&width=1658.6666666666667" alt="image.png"></p>
<h2 id="Tag版本推送"><a href="#Tag版本推送" class="headerlink" title="Tag版本推送"></a>Tag版本推送</h2><p>GitLab 的 tag（标签）在版本控制中主要用于标记某个特定的提交（commit）点。这些标签通常用于表示软件的发布版本，使得开发者能够轻松地引用和查找这些重要的提交点。</p>
<ol>
<li><strong>版本标记</strong>：<ul>
<li>标签可以标记代码库中的特定版本，如 v1.0.0、v2.1.3 等。这有助于开发者和其他利益相关者（如产品经理、测试人员、用户等）清楚地了解代码的当前状态和历史版本。</li>
</ul>
</li>
<li><strong>发布管理</strong>：<ul>
<li>当软件达到某个稳定状态并准备发布时，可以为该状态创建一个标签。这有助于在后续开发过程中追踪和比较不同版本之间的差异。</li>
<li>通过标签，可以轻松地回滚到以前的版本，如果新版本出现严重问题或不符合预期。</li>
</ul>
</li>
<li><strong>构建和部署</strong>：<ul>
<li>在持续集成/持续部署（CI/CD）流程中，标签经常用于触发构建和部署操作。例如，当一个新的标签被推送到代码库时，CI/CD 系统可以自动构建和部署该版本的软件。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ vim tag.txt</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git add .</span><br><span class="line">warning: <span class="keyword">in</span> the working copy of <span class="string">'tag.txt'</span>, LF will be replaced by CRLF the next time Git touches it</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git commit  -m <span class="string">"net tag.txt"</span></span><br><span class="line">[main 3461e18] net tag.txt</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"> create mode 100644 tag.txt</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git tag  -a <span class="string">"v1.1"</span> -m <span class="string">"new e.txt"</span></span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git push origin  main</span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git push origin  v1.1</span><br><span class="line">Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 32 threads</span><br><span class="line">Compressing objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (4/4), 424 bytes | 424.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 4 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)</span><br><span class="line">To gitlab.tanke.love:gitlab-instance-d5d699e8/study-test-cloud.git</span><br><span class="line"> * [new tag]         v1.1 -&gt; v1.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lenovo@LAPTOP-P0AL7U72 MINGW64 ~/Desktop/study-test-cloud (main)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 3461e180cc300dddd9ea289c619b74f771e57dd9 (HEAD -&gt; main, tag: v1.1)</span><br><span class="line">Author: jiaming &lt;hjm131641@163.com&gt;</span><br><span class="line">Date:   Tue Jun 4 23:30:26 2024 +0800</span><br><span class="line"></span><br><span class="line">    net tag.txt</span><br><span class="line"></span><br><span class="line">commit c3aba0f8f1d3fa73789ce7562ed97526433628b0 (origin/main, origin/HEAD)</span><br><span class="line">Author: jiaming &lt;hjm131641@163.com&gt;</span><br><span class="line">Date:   Tue Jun 4 23:22:26 2024 +0800</span><br><span class="line"></span><br><span class="line">    first commit</span><br><span class="line"></span><br><span class="line">commit 1416f75324c274ae5b813ee7ce8d80a09d61212b</span><br><span class="line">Author: jiaming &lt;hjm131641@163.com&gt;</span><br><span class="line">Date:   Tue Jun 4 23:02:44 2024 +0800</span><br><span class="line"></span><br><span class="line">    first commit</span><br><span class="line"></span><br><span class="line">commit 7f887e5c316766a6cab4b81ba73cfd00e1230fc2</span><br><span class="line">Author: Administrator &lt;admin@example.com&gt;</span><br><span class="line">Date:   Tue Jun 4 22:55:52 2024 +0800</span><br><span class="line"></span><br><span class="line">    Initial commit</span><br></pre></td></tr></table></figure>
<h2 id="Gitlab备份"><a href="#Gitlab备份" class="headerlink" title="Gitlab备份"></a>Gitlab备份</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看Gitlab的版本</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /opt/gitlab/embedded/service/gitlab-rails/VERSION </span></span><br><span class="line">15.1.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开配置文件数据备份</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/gitlab/gitlab.rb </span></span><br><span class="line">gitlab_rails[<span class="string">'backup_path'</span>] = <span class="string">"/var/opt/gitlab/backups"</span>	<span class="comment">#备份的路径</span></span><br><span class="line">gitlab_rails[<span class="string">'backup_archive_permissions'</span>] = 0644		<span class="comment">#备份文件的默认权限</span></span><br><span class="line">gitlab_rails[<span class="string">'backup_keep_time'</span>] = 604800				<span class="comment">#保留时长，秒为单位</span></span><br></pre></td></tr></table></figure>
设置备份保留时长，防止每天执行备份，肯定有目录被爆满的风险，打开/etc/gitlab/gitlab.rb配置文件，找到如下配置<br>该项定义了默认备份出文件的路径，可以通过修改该配置，并执行 <strong>gitlab-ctl reconfigure 或者 gitlab-ctl  restart</strong> 重启服务生效。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># gitlab-ctl reconfigure</span></span><br><span class="line">或者</span><br><span class="line">[root@localhost ~]<span class="comment"># gitlab-ctl  restart</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $?</span></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行备份命令进行备份</span></span><br><span class="line">[root@localhost ~]<span class="comment"># gitlab-rake gitlab:backup:create</span></span><br></pre></td></tr></table></figure>
<img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717517879520-40f15e41-1a8a-4f0b-8dec-30185ae70ed1.png#averageHue=%23110706&clientId=ued8afcd3-562e-4&from=paste&height=322&id=u5067e48b&originHeight=483&originWidth=2304&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=74135&status=done&style=none&taskId=u0eacec38-4d01-4935-b02b-fc5b96207a5&title=&width=1536" alt="image.png"><br>也可以添加到 crontab 中定时执行：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 2 * * * /opt/gitlab/bin/gitlab-rake gitlab:backup:create</span><br></pre></td></tr></table></figure>
可以到/var/opt/gitlab/backups找到备份包，解压查看，会发现备份的还是比较全面的，数据库、repositories、build、upload等分类还是比较清晰的。备份完成，会在备份目录中生成一个当天日期的tar包。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ll /var/opt/gitlab/backups/</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
<h2 id="Gitlab数据恢复"><a href="#Gitlab数据恢复" class="headerlink" title="Gitlab数据恢复"></a>Gitlab数据恢复</h2><p>特别注意：</p>
<ul>
<li>备份目录和gitlab.rb中定义的备份目录必须一致</li>
<li>GitLab的版本和备份文件中的版本必须一致，否则还原时会报错。</li>
</ul>
<p>模拟删除数据<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717518575379-ebd49296-7206-4a12-b4d7-c90d49794792.png#averageHue=%23fbfafa&clientId=ued8afcd3-562e-4&from=paste&height=933&id=uc3b9c3e3&originHeight=1399&originWidth=2560&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=166353&status=done&style=none&taskId=u0fa09a64-ef82-4bcb-b3ca-150ba34c140&title=&width=1706.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717518652601-e7f25ebc-1301-4c0b-a295-d5190e427c4c.png#averageHue=%23e5e5e5&clientId=ued8afcd3-562e-4&from=paste&height=337&id=uff679f85&originHeight=505&originWidth=1168&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=24830&status=done&style=none&taskId=u036f151c-dcbe-4ce8-938b-31cf8e90bb5&title=&width=778.6666666666666" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment">#  cd /var/opt/gitlab/backups</span></span><br><span class="line">[root@localhost backups]<span class="comment"># ls</span></span><br><span class="line">1717517821_2024_06_05_15.1.2_gitlab_backup.tar</span><br><span class="line">[root@localhost ~]<span class="comment">#  gitlab-rake gitlab:backup:restore BACKUP=/var/opt/gitlab/backups/</span></span><br><span class="line"><span class="comment"># 注意恢复文件的名称</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717518899452-6bfb8d82-90fd-4969-841c-2dd1561ffb71.png#averageHue=%230d0404&clientId=ued8afcd3-562e-4&from=paste&height=455&id=u3cca4501&originHeight=682&originWidth=2302&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=78297&status=done&style=none&taskId=ud6524fd3-87d9-4f81-92ca-346fb1ecfa6&title=&width=1534.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717519006307-206d83b4-2a2c-4afb-8e06-2ba73f12538b.png#averageHue=%230f0d0c&clientId=ued8afcd3-562e-4&from=paste&height=444&id=u3c1082bf&originHeight=666&originWidth=1674&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=95727&status=done&style=none&taskId=ub7b8d439-5831-4b8e-b61c-bfe69b20fb3&title=&width=1116" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717519030944-9de30b46-c1fb-4ffc-a9d4-7fce862bff83.png#averageHue=%23150e0d&clientId=ued8afcd3-562e-4&from=paste&height=335&id=u2dfcc94d&originHeight=502&originWidth=2305&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=88401&status=done&style=none&taskId=ua70807c8-3ba2-492c-9bbe-c5e8bd05a9a&title=&width=1536.6666666666667" alt="image.png"><br>恢复完成后，启动刚刚的两个服务，或者重启所有服务，再打开浏览器进行访问，发现数据和之前的一致：<br><strong>注意：通过备份文件恢复gitlab必须保证两台主机的gitlab版本一致，否则会提示版本不匹配</strong></p>
<p>再次查看Gitlab<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40379882/1717519194226-fce9dcd9-3ce8-42fd-b3ec-1c4c6ee5f72a.png#averageHue=%23fbfbfb&clientId=ued8afcd3-562e-4&from=paste&height=588&id=uc3c79e4d&originHeight=882&originWidth=2097&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=92571&status=done&style=none&taskId=u6d6817f5-daea-4f5b-a78c-dfd9379750c&title=&width=1398" alt="image.png"></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">L66</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://l66stbz.github.io/2024/09/04/Jenkins%20CI_CD%E5%BA%94%E7%94%A8/Gitlab%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/">https://l66stbz.github.io/2024/09/04/Jenkins%20CI_CD%E5%BA%94%E7%94%A8/Gitlab%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://l66stbz.github.io" target="_blank">L66</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/Gitlab/">Gitlab</a></div><div class="post_share"><div class="social-share" data-image="https://l66stbz.github.io/2024/09/03/study/test/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2024/09/03/Jenkins%20CI_CD%E5%BA%94%E7%94%A8/Git%E5%B7%A5%E5%85%B7%E4%B8%8Egitee%E3%80%81gitlab%E5%92%8Cgithub/"><img class="next_cover" src="https://l66stbz.github.io/2024/09/03/Jenkins CI_CD应用/Git工具与gitee、gitlab和github/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Git工具与gitee、gitlab和github</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2024/05/19/作业_zabbix监控内存/" title="作业_zabbix监控内存"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/19/作业_zabbix监控内存/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-19</div><div class="relatedPosts_title">作业_zabbix监控内存</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/21/Keepalived/" title="Keepalived"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/21/Keepalived/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-21</div><div class="relatedPosts_title">Keepalived</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/15/2024.05随记/" title="2024.05随记"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/15/2024.05随记/66.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-15</div><div class="relatedPosts_title">2024.05随记</div></div></a></div><div class="relatedPosts_item"><a href="/2024/08/13/LVS-NAT-Keepalived/" title="LVS-NAT-Keepalived"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/13/LVS-NAT-Keepalived/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-13</div><div class="relatedPosts_title">LVS-NAT-Keepalived</div></div></a></div><div class="relatedPosts_item"><a href="/2024/07/27/Mysql高可用-MHA/" title="Mysql高可用-MHA"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/07/27/Mysql高可用-MHA/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-07-27</div><div class="relatedPosts_title">Mysql高可用-MHA</div></div></a></div><div class="relatedPosts_item"><a href="/2024/08/14/NoSQL-Redis/" title="NoSQL-Redis"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/14/NoSQL-Redis/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-14</div><div class="relatedPosts_title">NoSQL-Redis</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By L66</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/third-party/click_heart.js"></script></body></html>