<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨ | L66</title><meta name="description" content="[TOC] å®˜ç½‘ï¼š â€‹       https:&#x2F;&#x2F;kubernetes.io&#x2F;zh-cn&#x2F;docs&#x2F;concepts&#x2F;storage&#x2F;volumes&#x2F; å‰è¨€ï¼šâ€‹        å®¹å™¨å†…éƒ¨å­˜å‚¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼Œä¼šéšç€å®¹å™¨ç¯å¢ƒçš„é”€æ¯è€Œé”€æ¯ï¼Œå…·æœ‰ä¸ç¨³å®šæ€§ã€‚å¦‚æœå¤šä¸ªå®¹å™¨å¸Œæœ›å…±äº«åŒä¸€ä»½å­˜å‚¨ï¼Œåˆ™ä»…ä»…ä¾èµ–å®¹å™¨æœ¬èº«æ˜¯å¾ˆéš¾å®ç°çš„ã€‚åœ¨Kubernetesç³»ç»Ÿä¸­ï¼Œå°†å¯¹å®¹å™¨åº”ç”¨æ‰€éœ€çš„å­˜å‚¨èµ„æºæŠ½è±¡ä¸ºå­˜å‚¨å·ï¼ˆVolumeï¼‰"><meta name="keywords" content="Linux,Kubernetes"><meta name="author" content="L66"><meta name="copyright" content="L66"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/3.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨"><meta name="twitter:description" content="[TOC] å®˜ç½‘ï¼š â€‹       https:&#x2F;&#x2F;kubernetes.io&#x2F;zh-cn&#x2F;docs&#x2F;concepts&#x2F;storage&#x2F;volumes&#x2F; å‰è¨€ï¼šâ€‹        å®¹å™¨å†…éƒ¨å­˜å‚¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼Œä¼šéšç€å®¹å™¨ç¯å¢ƒçš„é”€æ¯è€Œé”€æ¯ï¼Œå…·æœ‰ä¸ç¨³å®šæ€§ã€‚å¦‚æœå¤šä¸ªå®¹å™¨å¸Œæœ›å…±äº«åŒä¸€ä»½å­˜å‚¨ï¼Œåˆ™ä»…ä»…ä¾èµ–å®¹å™¨æœ¬èº«æ˜¯å¾ˆéš¾å®ç°çš„ã€‚åœ¨Kubernetesç³»ç»Ÿä¸­ï¼Œå°†å¯¹å®¹å™¨åº”ç”¨æ‰€éœ€çš„å­˜å‚¨èµ„æºæŠ½è±¡ä¸ºå­˜å‚¨å·ï¼ˆVolumeï¼‰"><meta name="twitter:image" content="https://l66stbz.github.io/2024/09/20/KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨/08-KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨/1.png"><meta property="og:type" content="article"><meta property="og:title" content="KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨"><meta property="og:url" content="https://l66stbz.github.io/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/"><meta property="og:site_name" content="L66"><meta property="og:description" content="[TOC] å®˜ç½‘ï¼š â€‹       https:&#x2F;&#x2F;kubernetes.io&#x2F;zh-cn&#x2F;docs&#x2F;concepts&#x2F;storage&#x2F;volumes&#x2F; å‰è¨€ï¼šâ€‹        å®¹å™¨å†…éƒ¨å­˜å‚¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼Œä¼šéšç€å®¹å™¨ç¯å¢ƒçš„é”€æ¯è€Œé”€æ¯ï¼Œå…·æœ‰ä¸ç¨³å®šæ€§ã€‚å¦‚æœå¤šä¸ªå®¹å™¨å¸Œæœ›å…±äº«åŒä¸€ä»½å­˜å‚¨ï¼Œåˆ™ä»…ä»…ä¾èµ–å®¹å™¨æœ¬èº«æ˜¯å¾ˆéš¾å®ç°çš„ã€‚åœ¨Kubernetesç³»ç»Ÿä¸­ï¼Œå°†å¯¹å®¹å™¨åº”ç”¨æ‰€éœ€çš„å­˜å‚¨èµ„æºæŠ½è±¡ä¸ºå­˜å‚¨å·ï¼ˆVolumeï¼‰"><meta property="og:image" content="https://l66stbz.github.io/2024/09/20/KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨/08-KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨/1.png"><meta property="article:published_time" content="2024-09-20T13:50:00.000Z"><meta property="article:modified_time" content="2024-09-26T13:07:40.713Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://l66stbz.github.io/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/"><link rel="prev" title="KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨" href="https://l66stbz.github.io/2024/09/23/spring%20cloud%20k8s%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2/spring%20cloud%20k8s%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E8%8B%A5%E4%BE%9D/"><link rel="next" title="Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†" href="https://l66stbz.github.io/2024/09/19/Kubernetes%20RBAC%E7%BB%86%E7%B2%92%E5%BA%A6%E6%9D%83%E9%99%90%E5%88%92%E5%88%86/07-Kubernetes%20RBAC%E7%BB%86%E7%B2%92%E5%BA%A6%E6%9D%83%E9%99%90%E5%88%92%E5%88%86/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="L66" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/2.jpg" onerror="onerror=null;src='/img/2.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">67</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">37</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> åˆ—è¡¨</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/photo/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#å‰è¨€ï¼š"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1ã€emptyDir"><span class="toc-number">2.</span> <span class="toc-text">1ã€emptyDir</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2ã€hostPathï¼ˆäº†è§£ï¼‰"><span class="toc-number">3.</span> <span class="toc-text">2ã€hostPathï¼ˆäº†è§£ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3ã€NFS"><span class="toc-number">4.</span> <span class="toc-text">3ã€NFS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4ã€æŒä¹…å·"><span class="toc-number">5.</span> <span class="toc-text">4ã€æŒä¹…å·</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-PersistentVolume"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 PersistentVolume</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-1-PVåˆ›å»º"><span class="toc-number">5.1.1.</span> <span class="toc-text">4.1.1 PVåˆ›å»º</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-PersistentVolumeClaim"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 PersistentVolumeClaim</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2-1-PVCçš„å…³é”®é…ç½®å‚æ•°"><span class="toc-number">5.2.1.</span> <span class="toc-text">4.2.1 PVCçš„å…³é”®é…ç½®å‚æ•°</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-PVå’ŒPVCçš„ç”Ÿå‘½å‘¨æœŸ"><span class="toc-number">5.3.</span> <span class="toc-text">4.3 PVå’ŒPVCçš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-PVCåˆ›å»ºå’ŒæŒ‚è½½å¤±è´¥çš„åŸå› "><span class="toc-number">5.4.</span> <span class="toc-text">4.4 PVCåˆ›å»ºå’ŒæŒ‚è½½å¤±è´¥çš„åŸå› </span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://l66stbz.github.io/2024/09/20/KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨/08-KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨/1.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">L66</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> åˆ—è¡¨</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/photo/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="å‘è¡¨äº 2024-09-20 21:50:00"><i class="fa fa-calendar" aria-hidden="true"></i> å‘è¡¨äº 2024-09-20</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="æ›´æ–°äº 2024-09-26 21:07:40"><i class="fa fa-history" aria-hidden="true"></i> æ›´æ–°äº 2024-09-26</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>[TOC]</p>
<p>å®˜ç½‘ï¼š</p>
<p>â€‹       <a href="https://kubernetes.io/zh-cn/docs/concepts/storage/volumes/" target="_blank" rel="noopener">https://kubernetes.io/zh-cn/docs/concepts/storage/volumes/</a></p>
<h3 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h3><p>â€‹        <strong>å®¹å™¨å†…éƒ¨å­˜å‚¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼Œä¼šéšç€å®¹å™¨ç¯å¢ƒçš„é”€æ¯è€Œé”€æ¯ï¼Œå…·æœ‰ä¸ç¨³å®šæ€§</strong>ã€‚å¦‚æœå¤šä¸ªå®¹å™¨å¸Œæœ›å…±äº«åŒä¸€ä»½å­˜å‚¨ï¼Œåˆ™ä»…ä»…ä¾èµ–å®¹å™¨æœ¬èº«æ˜¯å¾ˆéš¾å®ç°çš„ã€‚åœ¨Kubernetesç³»ç»Ÿä¸­ï¼Œå°†å¯¹å®¹å™¨åº”ç”¨æ‰€éœ€çš„å­˜å‚¨èµ„æºæŠ½è±¡ä¸ºå­˜å‚¨å·ï¼ˆVolumeï¼‰æ¦‚å¿µæ¥è§£å†³è¿™äº›é—®é¢˜ã€‚ Volumeæ˜¯ä¸Podç»‘å®šçš„ï¼ˆç‹¬ç«‹äºå®¹å™¨ï¼‰ä¸Podå…·æœ‰ç›¸åŒç”Ÿå‘½å‘¨æœŸçš„èµ„æºå¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥å°†Volumeçš„å†…å®¹ç†è§£ä¸ºç›®å½•æˆ–æ–‡ä»¶ï¼Œå®¹å™¨å¦‚éœ€ä½¿ç”¨æŸä¸ªVolumeï¼Œåˆ™ä»…éœ€è®¾ç½®volumeMountså°†ä¸€ä¸ªæˆ–å¤šä¸ªVolumeæŒ‚è½½ä¸ºå®¹å™¨ä¸­çš„ç›®å½•æˆ–æ–‡ä»¶ï¼Œå³å¯è®¿é—®Volumeä¸­çš„æ•°æ®ã€‚Volumeå…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä»¥åŠç”±å“ªä¸ªç³»ç»Ÿæä¾›ï¼Œå¯¹å®¹å™¨åº”ç”¨æ¥è¯´æ˜¯é€æ˜çš„ã€‚</p>
<h3 id="1ã€emptyDir"><a href="#1ã€emptyDir" class="headerlink" title="1ã€emptyDir"></a>1ã€emptyDir</h3><p>â€‹    ç®€ä»‹ï¼š</p>
<p>â€‹            è¿™ç§ç±»å‹çš„Volumeå°†åœ¨Podè¢«è°ƒåº¦åˆ°Nodeæ—¶è¿›è¡Œåˆ›å»ºï¼Œåœ¨åˆå§‹çŠ¶æ€ä¸‹ç›®å½•ä¸­æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å‘½åä¸ºâ€œç©ºç›®å½•â€ï¼ˆEmpty Directoryï¼‰ï¼Œå®ƒä¸Podå…·æœ‰ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“Podè¢«é”€æ¯æ—¶ï¼ŒNodeä¸Šç›¸åº”çš„ç›®å½•ä¹Ÿä¼šè¢«åˆ é™¤ã€‚ åŒä¸€ä¸ªPodä¸­çš„å¤šä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‚è½½è¿™ç§Volumeã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºèµ„æºæ¸…å•</span></span><br><span class="line"><span class="string">[root@k8s-master01</span> <span class="string">~]#</span> <span class="string">vim</span> <span class="string">nginx-deploy.yaml</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">labels:</span></span><br><span class="line">   <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">     <span class="attr">labels:</span></span><br><span class="line">       <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/hujiaming/nginx:1.24.0</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/tmp</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">test-volume</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/hujiaming/tomcat:9.0.89-jdk8</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">tomcat</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/tmp</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">test-volume</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">test-volume</span></span><br><span class="line">        <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">       <span class="comment"># medium: Memory</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#&gt;&gt;&gt; åˆ›å»ºèµ„æº</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl create  -f nginx-deploy.yaml </span></span><br><span class="line">deployment.apps/nginx created</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹èµ„æº</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl get po  -w</span></span><br><span class="line">NAME                     READY   STATUS    RESTARTS   AGE</span><br><span class="line">nginx-66744bbb6b-8mg2r   2/2     Running   0          5s</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; è¿›å…¥å…¶ä¸­ä¸€ä¸ªå®¹å™¨ä¸­</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl  exec -it nginx-66744bbb6b-8mg2r  -c nginx -- bash</span></span><br><span class="line">root@nginx-66744bbb6b-8mg2r:/<span class="comment"># df -Th</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/2.png" alt="image-20240628224527461"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; å®¹å™¨æŒ‚è½½ç›®å½•åˆ›å»ºæµ‹è¯•æ–‡ä»¶</span></span><br><span class="line">root@nginx-66744bbb6b-8mg2r:/<span class="comment"># echo "hello world" &gt; /tmp/test.txt  </span></span><br><span class="line">root@nginx-66744bbb6b-8mg2r:/<span class="comment"># ls /tmp/test.txt </span></span><br><span class="line">/tmp/test.txt</span><br><span class="line">root@nginx-66744bbb6b-8mg2r:/<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; è¿›å…¥Podä¸­å¦å¤–ä¸€ä¸ªå®¹å™¨ä¸­ï¼ŒæŸ¥çœ‹æŒ‚è½½ç›®å½•å†…å®¹</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl  exec -it nginx-66744bbb6b-8mg2r  -c tomcat  -- bash</span></span><br><span class="line">root@nginx-66744bbb6b-8mg2r:/usr/<span class="built_in">local</span>/tomcat<span class="comment"># ls /tmp/</span></span><br><span class="line">hsperfdata_root  test.txt</span><br><span class="line">root@nginx-66744bbb6b-8mg2r:/usr/<span class="built_in">local</span>/tomcat<span class="comment"># cat /tmp/test.txt </span></span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/3.png" alt="image-20240922220047550"></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">volume-pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">tomcat</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/hujiaming/tomcat:9.0.89-jdk8</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8080</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">app-logs</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/usr/local/tomcat/logs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/hujiaming/busybox:1.36.1</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">["sh",</span> <span class="string">"-c"</span><span class="string">,</span> <span class="string">"tail -f /logs/catalina*.log"</span><span class="string">]</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">app-logs</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">/logs</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">app-logs</span></span><br><span class="line">    <span class="attr">emptyDir:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="2ã€hostPathï¼ˆäº†è§£ï¼‰"><a href="#2ã€hostPathï¼ˆäº†è§£ï¼‰" class="headerlink" title="2ã€hostPathï¼ˆäº†è§£ï¼‰"></a>2ã€hostPathï¼ˆäº†è§£ï¼‰</h3><p>â€‹          ä»‹ç»ï¼šHostPathç±»å‹çš„å­˜å‚¨å·ç”¨äºå°†Nodeæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨ä½¿ç”¨ã€‚å¯¹äºå¤§å¤šæ•°å®¹å™¨åº”ç”¨æ¥è¯´ï¼Œéƒ½ä¸éœ€è¦ä½¿ç”¨å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿã€‚é€‚åˆä½¿ç”¨HostPathå­˜å‚¨å·çš„ä¸€äº›åº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼š </p>
<ul>
<li>å®¹å™¨åº”ç”¨çš„å…³é”®æ•°æ®éœ€è¦è¢«æŒä¹…åŒ–åˆ°å®¿ä¸»æœºä¸Šã€‚ </li>
</ul>
<p><strong>ä½¿ç”¨hostPathå·çš„ç¤ºä¾‹</strong></p>
<p>â€‹    ç¤ºä¾‹ï¼š ä¿®æ”¹å®¹å™¨æ—¶åŒºã€‚é»˜è®¤å®¹å™¨æ—¶é—´ä¸ºUTCæ—¶é—´ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºèµ„æºæ¸…å•</span></span><br><span class="line"><span class="string">[root@k8s-master01</span> <span class="string">~]#</span> <span class="string">vim</span> <span class="string">nginx-deploy.yaml</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">labels:</span></span><br><span class="line">   <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">     <span class="attr">labels:</span></span><br><span class="line">       <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/hujiaming/nginx:1.24.0</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/timezone</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">timezone</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/localtime</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">date</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">timezone</span></span><br><span class="line">        <span class="attr">hostPath:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">/etc/timezone</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">File</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">date</span></span><br><span class="line">        <span class="attr">hostPath:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">/etc/localtime</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">File</span></span><br></pre></td></tr></table></figure>

<p><code>hostPath</code>å·¥ä½œç±»å‹ï¼š</p>
<ul>
<li><p>type ä¸ºç©ºå­—ç¬¦ä¸²ï¼šé»˜è®¤é€‰é¡¹ï¼Œæ„å‘³ç€æŒ‚è½½ hostPathå·ä¹‹å‰ä¸ä¼šæ‰§è¡Œä»»ä½•æ£€æŸ¥ã€‚</p>
</li>
<li><p>DirectoryOrCreateï¼šå¦‚æœç»™å®šçš„pathä¸å­˜åœ¨ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå°†æ ¹æ®éœ€è¦åˆ›å»ºä¸€ä¸ªæƒé™ä¸º0755 çš„ç©ºç›®å½•ï¼Œå’Œ Kubelet å…·æœ‰ç›¸åŒçš„ç»„å’Œæƒé™ã€‚</p>
</li>
<li><p>Directoryï¼šç›®å½•å¿…é¡»å­˜åœ¨äºç»™å®šçš„è·¯å¾„ä¸‹ã€‚</p>
</li>
<li><p>FileOrCreateï¼šå¦‚æœç»™å®šçš„è·¯å¾„ä¸å­˜å‚¨ä»»ä½•å†…å®¹ï¼Œåˆ™ä¼šæ ¹æ®éœ€è¦åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œæƒé™è®¾ç½®ä¸º 0644ï¼Œå’Œ Kubelet å…·æœ‰ç›¸åŒçš„ç»„å’Œæ‰€æœ‰æƒã€‚</p>
</li>
<li><p><strong><code>File</code></strong>ï¼šæ–‡ä»¶ï¼Œå¿…é¡»å­˜åœ¨äºç»™å®šè·¯å¾„ä¸­ã€‚</p>
</li>
<li><p>Socketï¼šUNIX å¥—æ¥å­—ï¼Œå¿…é¡»å­˜åœ¨äºç»™å®šè·¯å¾„ä¸­ã€‚</p>
</li>
<li><p>CharDeviceï¼šå­—ç¬¦è®¾å¤‡ï¼Œå¿…é¡»å­˜åœ¨äºç»™å®šè·¯å¾„ä¸­ã€‚</p>
</li>
<li><p>BlockDeviceï¼šå—è®¾å¤‡ï¼Œå¿…é¡»å­˜åœ¨äºç»™å®šè·¯å¾„ä¸­</p>
</li>
</ul>
<h3 id="3ã€NFS"><a href="#3ã€NFS" class="headerlink" title="3ã€NFS"></a>3ã€NFS</h3><p>â€‹        ç®€ä»‹ï¼š<code>nfs</code> å·èƒ½å°† NFS (ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ) æŒ‚è½½åˆ°ä½ çš„ Pod ä¸­ã€‚ ä¸åƒ <code>emptyDir</code> é‚£æ ·ä¼šåœ¨åˆ é™¤ Pod çš„åŒæ—¶ä¹Ÿä¼šè¢«åˆ é™¤ï¼Œ<code>nfs</code> å·çš„å†…å®¹åœ¨åˆ é™¤ Pod æ—¶ä¼šè¢«ä¿å­˜ï¼Œå·åªæ˜¯è¢«å¸è½½ã€‚ è¿™æ„å‘³ç€ <code>nfs</code> å·å¯ä»¥è¢«é¢„å…ˆå¡«å……æ•°æ®ï¼Œå¹¶ä¸”è¿™äº›æ•°æ®å¯ä»¥åœ¨ Pod ä¹‹é—´å…±äº«ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; æ‰€æœ‰å®‰è£…nfsæœåŠ¡</span></span><br><span class="line">$  yum -y install nfs-utils rpcbind</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; master01ä½œä¸ºæœåŠ¡ç«¯</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># mkdir -p /data/nfs</span></span><br><span class="line"></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># chmod 666 /data/nfs</span></span><br><span class="line"></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># cat /etc/exports</span></span><br><span class="line">/data/nfs  192.168.174.0/24(rw,sync,no_root_squash,no_subtree_check)</span><br><span class="line"></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># exportfs -r</span></span><br><span class="line"></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># systemctl enable --now rpcbind nfs</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; å®¢æˆ·ç«¯æµ‹è¯•</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># showmount  -e 192.168.174.30</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; ç¼–å†™æŒ‚è½½æµ‹è¯•èµ„æºæ¸…å•</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># cat nginx-deploy.yaml </span></span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line"> labels:</span><br><span class="line">   app: nginx</span><br><span class="line"> name: nginx</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: nginx</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">     labels:</span><br><span class="line">       app: nginx</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - image: registry.cn-hangzhou.aliyuncs.com/hujiaming/nginx:1.24.0</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        name: nginx</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - mountPath: /etc/timezone</span><br><span class="line">          name: timezone</span><br><span class="line">        - mountPath: /etc/localtime</span><br><span class="line">          name: date</span><br><span class="line">        - mountPath: /tmp</span><br><span class="line">          name: nfs-volume</span><br><span class="line">      restartPolicy: Always</span><br><span class="line">      volumes:</span><br><span class="line">      - name: timezone</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /etc/timezone</span><br><span class="line">          <span class="built_in">type</span>: File</span><br><span class="line">      - name: date</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /etc/localtime</span><br><span class="line">          <span class="built_in">type</span>: File</span><br><span class="line">      - name: nfs-volume</span><br><span class="line">        nfs:</span><br><span class="line">          server: 192.168.174.30</span><br><span class="line">          path: /data/nfs/<span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºèµ„æº</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl apply -f nginx-deploy.yaml </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æµ‹è¯•</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl exec  nginx-54879c9c9c-zp4zl  -- touch  /tmp/222</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹æœåŠ¡ç«¯æŒ‚è½½è·¯å¾„</span></span><br><span class="line">[root@k8s-master01 <span class="built_in">test</span>]<span class="comment"># ll /data/nfs/test/</span></span><br><span class="line">-rw-r--r-- 1 root root 0 6æœˆ  29 22:00 222</span><br></pre></td></tr></table></figure>



<h3 id="4ã€æŒä¹…å·"><a href="#4ã€æŒä¹…å·" class="headerlink" title="4ã€æŒä¹…å·"></a>4ã€æŒä¹…å·</h3><p>â€‹        Kuberneteså¯¹äºæœ‰çŠ¶æ€çš„å®¹å™¨åº”ç”¨æˆ–è€…å¯¹æ•°æ®éœ€è¦æŒä¹…åŒ–çš„åº”ç”¨ï¼Œä¸ä»…éœ€è¦å°†å®¹å™¨å†…çš„ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºçš„ç›®å½•æˆ–è€…emptyDirä¸´æ—¶å­˜å‚¨å·ï¼Œè€Œä¸”éœ€è¦æ›´åŠ å¯é çš„å­˜å‚¨æ¥ä¿å­˜åº”ç”¨äº§ç”Ÿçš„é‡è¦æ•°æ®ï¼Œä»¥ä¾¿å®¹å™¨åº”ç”¨åœ¨é‡å»ºä¹‹åä»ç„¶å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„æ•°æ®ã€‚ä¸è¿‡ï¼Œå­˜å‚¨èµ„æºå’Œè®¡ç®—èµ„æºï¼ˆCPU/å†…å­˜ï¼‰çš„ç®¡ç†æ–¹å¼å®Œå…¨ä¸åŒã€‚ä¸ºäº†èƒ½å¤Ÿå±è”½åº•å±‚å­˜å‚¨å®ç°çš„ç»†èŠ‚ï¼Œè®©ç”¨æˆ·æ–¹ä¾¿ä½¿ç”¨ï¼ŒåŒæ—¶è®©ç®¡ç†å‘˜æ–¹ä¾¿ç®¡ç†ï¼ŒKubernetesä»1.0ç‰ˆæœ¬å°±å¼•å…¥PersistentVolumeï¼ˆPVï¼‰å’ŒPersistentVolumeClaimï¼ˆPVCï¼‰ä¸¤ä¸ªèµ„æºå¯¹è±¡æ¥å®ç°å¯¹å­˜å‚¨çš„ç®¡ç†å­ç³»ç»Ÿã€‚<br>â€‹    </p>
<p>â€‹        <strong>æŒä¹…å·ï¼ˆPersistentVolumeï¼ŒPVï¼‰</strong> æ˜¯é›†ç¾¤ä¸­çš„ä¸€å—å­˜å‚¨ï¼Œå¯ä»¥ç”±ç®¡ç†å‘˜äº‹å…ˆåˆ¶å¤‡ï¼Œ æˆ–è€…ä½¿ç”¨<a href="https://kubernetes.io/zh-cn/docs/concepts/storage/storage-classes/" target="_blank" rel="noopener">å­˜å‚¨ç±»ï¼ˆStorage Classï¼‰</a>æ¥åŠ¨æ€åˆ¶å¤‡ã€‚ æŒä¹…å·æ˜¯é›†ç¾¤èµ„æºï¼Œå°±åƒèŠ‚ç‚¹ä¹Ÿæ˜¯é›†ç¾¤èµ„æºä¸€æ ·ã€‚PV æŒä¹…å·å’Œæ™®é€šçš„Volumeä¸€æ ·ï¼Œ ä¹Ÿæ˜¯ä½¿ç”¨å·æ’ä»¶æ¥å®ç°çš„ï¼Œåªæ˜¯å®ƒä»¬æ‹¥æœ‰ç‹¬ç«‹äºä»»ä½•ä½¿ç”¨ PV çš„ Pod çš„ç”Ÿå‘½å‘¨æœŸã€‚ æ­¤ API å¯¹è±¡ä¸­è®°è¿°äº†å­˜å‚¨çš„å®ç°ç»†èŠ‚ï¼Œæ— è®ºå…¶èƒŒåæ˜¯NFSè¿˜æ˜¯ç‰¹å®šäºäº‘å¹³å°çš„å­˜å‚¨ç³»ç»Ÿã€‚<br>â€‹        <strong>æŒä¹…å·ç”³é¢†ï¼ˆPersistentVolumeClaimï¼ŒPVCï¼‰</strong> è¡¨è¾¾çš„æ˜¯ç”¨æˆ·å¯¹å­˜å‚¨çš„è¯·æ±‚ã€‚æ¦‚å¿µä¸Šä¸ Pod ç±»ä¼¼ã€‚Pod ä¼šè€—ç”¨èŠ‚ç‚¹èµ„æºï¼Œè€Œ PVC ç”³é¢†ä¼šè€—ç”¨ PV èµ„æºã€‚Pod å¯ä»¥è¯·æ±‚ç‰¹å®šæ•°é‡çš„èµ„æºï¼ˆCPU å’Œå†…å­˜ï¼‰ã€‚åŒæ · PVC ç”³é¢†ä¹Ÿå¯ä»¥è¯·æ±‚ç‰¹å®šçš„å¤§å°å’Œè®¿é—®æ¨¡å¼ ï¼ˆä¾‹å¦‚ï¼Œå¯ä»¥æŒ‚è½½ä¸º ReadWriteOnceã€ReadOnlyManyã€ReadWriteMany æˆ– ReadWriteOncePodï¼Œ è¯·å‚é˜…<a href="https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/#access-modes" target="_blank" rel="noopener">è®¿é—®æ¨¡å¼</a>ï¼‰ã€‚</p>
<p>å°½ç®¡ PersistentVolumeClaim å…è®¸ç”¨æˆ·æ¶ˆè€—æŠ½è±¡çš„å­˜å‚¨èµ„æºï¼Œ å¸¸è§çš„æƒ…å†µæ˜¯é’ˆå¯¹ä¸åŒçš„é—®é¢˜ç”¨æˆ·éœ€è¦çš„æ˜¯å…·æœ‰ä¸åŒå±æ€§ï¼ˆå¦‚ï¼Œæ€§èƒ½ï¼‰çš„ PersistentVolume å·ã€‚ é›†ç¾¤ç®¡ç†å‘˜éœ€è¦èƒ½å¤Ÿæä¾›ä¸åŒæ€§è´¨çš„PersistentVolumeï¼Œ å¹¶ä¸”è¿™äº› PV å·ä¹‹é—´çš„å·®åˆ«ä¸ä»…é™äºå·å¤§å°å’Œè®¿é—®æ¨¡å¼ï¼ŒåŒæ—¶åˆä¸èƒ½å°†å·æ˜¯å¦‚ä½•å®ç°çš„è¿™äº›ç»†èŠ‚æš´éœ²ç»™ç”¨æˆ·ã€‚ ä¸ºäº†æ»¡è¶³è¿™ç±»éœ€æ±‚ï¼Œå°±æœ‰äº†<strong>å­˜å‚¨ç±»ï¼ˆStorageClassï¼‰</strong> èµ„æºã€‚</p>
<h4 id="4-1-PersistentVolume"><a href="#4-1-PersistentVolume" class="headerlink" title="4.1 PersistentVolume"></a>4.1 PersistentVolume</h4><p>â€‹    ç®€ä»‹ï¼šç®€ç§°PVï¼Œæ˜¯ç”±Kubernetesç®¡ç†å‘˜è®¾ç½®çš„å­˜å‚¨ï¼Œå¯ä»¥é…ç½®Cephã€NFSã€GlusterFSç­‰å¸¸ç”¨å­˜å‚¨é…ç½®ï¼Œç›¸å¯¹äºVolumeé…ç½®ï¼Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€å¤§å°çš„é™åˆ¶ã€‚PVåˆ†ä¸ºé™æ€å’ŒåŠ¨æ€ã€‚PVå¯ä»¥è¢«ç†è§£æˆKubernetesé›†ç¾¤ä¸­çš„æŸä¸ªç½‘ç»œå­˜å‚¨å¯¹åº”çš„ä¸€å—å­˜å‚¨ï¼ŒPVä½œä¸ºå­˜å‚¨èµ„æºï¼Œä¸»è¦åŒ…æ‹¬å­˜å‚¨èƒ½åŠ›ã€è®¿é—®æ¨¡å¼ã€å­˜å‚¨ç±»å‹ã€å›æ”¶ç­–ç•¥ã€åç«¯å­˜å‚¨ç±»å‹ç­‰å…³é”®ä¿¡æ¯çš„è®¾ç½®ã€‚</p>
<p><strong>PVçš„å…³é”®é…ç½®å‚æ•°</strong></p>
<p><strong>å­˜å‚¨èƒ½åŠ›ï¼ˆCapacityï¼‰ï¼š</strong></p>
<p>â€‹        æè¿°å­˜å‚¨è®¾å¤‡å…·å¤‡çš„èƒ½åŠ›ï¼Œç›®å‰ä»…æ”¯æŒå¯¹å­˜å‚¨ç©ºé—´çš„è®¾ç½®ã€‚ç›®å‰ï¼Œå­˜å‚¨å¤§å°æ˜¯å¯ä»¥è®¾ç½®å’Œè¯·æ±‚çš„å”¯ä¸€èµ„æºã€‚ </p>
<p><strong>å­˜å‚¨å·æ¨¡å¼ï¼ˆVolume Modeï¼‰ï¼š</strong></p>
<p>â€‹        é’ˆå¯¹ PV æŒä¹…å·ï¼ŒKubernetes æ”¯æŒä¸¤ç§å·æ¨¡å¼ï¼ˆ<code>volumeModes</code>ï¼‰ï¼š<code>Filesystemï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰</code> å’Œ <code>Blockï¼ˆå—ï¼‰</code>ã€‚ <code>volumeMode</code> æ˜¯ä¸€ä¸ªå¯é€‰çš„ API å‚æ•°ã€‚ å¦‚æœè¯¥å‚æ•°è¢«çœç•¥ï¼Œé»˜è®¤çš„å·æ¨¡å¼æ˜¯ <code>Filesystem</code>ã€‚<code>volumeMode</code> å±æ€§è®¾ç½®ä¸º <code>Filesystem</code> çš„å·ä¼šè¢« Pod <strong>æŒ‚è½½ï¼ˆMountï¼‰</strong> åˆ°æŸä¸ªç›®å½•ã€‚ å¦‚æœå·çš„å­˜å‚¨æ¥è‡ªæŸå—è®¾å¤‡è€Œè¯¥è®¾å¤‡ç›®å‰ä¸ºç©ºï¼ŒKuberneretes ä¼šåœ¨ç¬¬ä¸€æ¬¡æŒ‚è½½å·ä¹‹å‰åœ¨è®¾å¤‡ä¸Šåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿã€‚ä½ å¯ä»¥å°† <code>volumeMode</code> è®¾ç½®ä¸º <code>Block</code>ï¼Œä»¥ä¾¿å°†å·ä½œä¸ºåŸå§‹å—è®¾å¤‡æ¥ä½¿ç”¨ã€‚ è¿™ç±»å·ä»¥å—è®¾å¤‡çš„æ–¹å¼äº¤ç»™ Pod ä½¿ç”¨ï¼Œå…¶ä¸Šæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç³»ç»Ÿã€‚ è¿™ç§æ¨¡å¼å¯¹äºä¸º Pod æä¾›ä¸€ç§ä½¿ç”¨æœ€å¿«å¯èƒ½æ–¹å¼æ¥è®¿é—®å·è€Œè¨€å¾ˆæœ‰å¸®åŠ©ï¼Œ Pod å’Œå·ä¹‹é—´ä¸å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿå±‚ã€‚å¦å¤–ï¼ŒPodä¸­è¿è¡Œçš„åº”ç”¨å¿…é¡»çŸ¥é“å¦‚ä½•å¤„ç†åŸå§‹å—è®¾å¤‡ã€‚ å…³äºå¦‚ä½•åœ¨ Pod ä¸­ä½¿ç”¨ <code>volumeMode: Block</code> çš„å·ï¼Œ å¯å‚é˜…<a href="https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/#raw-block-volume-support" target="_blank" rel="noopener">åŸå§‹å—å·æ”¯æŒ</a>ã€‚</p>
<p><strong>PVå›æ”¶ç­–ç•¥ï¼ˆReclaim Policyï¼‰</strong>ï¼š</p>
<ul>
<li><code>Retain</code>ï¼šä¿ç•™ï¼Œè¯¥ç­–ç•¥å…è®¸æ‰‹åŠ¨å›æ”¶èµ„æºï¼Œå½“åˆ é™¤PVCæ—¶ï¼ŒPVä»ç„¶å­˜åœ¨ï¼ŒPVè¢«è§†ä¸ºå·²é‡Šæ”¾ï¼Œç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨å›æ”¶å·ã€‚</li>
<li><code>Recycle</code>ï¼šå›æ”¶ï¼Œå¦‚æœVolumeæ’ä»¶æ”¯æŒï¼ŒRecycleç­–ç•¥ä¼šå¯¹å·æ‰§è¡Œ ==rm -rf==æ¸…ç†è¯¥PVï¼Œå¹¶ä½¿å…¶å¯ç”¨äºä¸‹ä¸€ä¸ªæ–°çš„PVCï¼Œä½†æ˜¯æœ¬ç­–ç•¥å°†æ¥ä¼šè¢«å¼ƒç”¨ï¼Œç›®å‰åªæœ‰NFSå’ŒHostPathæ”¯æŒè¯¥ç­–ç•¥ã€‚</li>
<li><code>Delete</code>ï¼šåˆ é™¤ï¼Œå¦‚æœVolumeæ’ä»¶æ”¯æŒï¼Œåˆ é™¤PVCæ—¶ä¼šåŒæ—¶åˆ é™¤PVï¼ŒåŠ¨æ€å·é»˜è®¤ä¸ºDeleteï¼Œç›®å‰æ”¯æŒDeleteçš„å­˜å‚¨åç«¯åŒ…æ‹¬AWS EBS, GCE PD, Azure Disk, or OpenStack Cinderç­‰ã€‚</li>
</ul>
<p><strong>PVè®¿é—®ç­–ç•¥ï¼ˆAccess Modesï¼‰</strong>ï¼š</p>
<ul>
<li><code>ReadWriteOnce</code>ï¼šå¯ä»¥è¢«å•èŠ‚ç‚¹ä»¥è¯»å†™æ¨¡å¼æŒ‚è½½ï¼Œå‘½ä»¤è¡Œä¸­å¯ä»¥è¢«ç¼©å†™ä¸ºRWOã€‚ï¼ˆå—å­˜å‚¨ï¼‰</li>
<li><code>ReadOnlyMany</code>ï¼šå¯ä»¥è¢«å¤šä¸ªèŠ‚ç‚¹ä»¥åªè¯»æ¨¡å¼æŒ‚è½½ï¼Œå‘½ä»¤è¡Œä¸­å¯ä»¥è¢«ç¼©å†™ä¸ºROXã€‚</li>
<li><code>ReadWriteMany</code>ï¼šå¯ä»¥è¢«å¤šä¸ªèŠ‚ç‚¹ä»¥è¯»å†™æ¨¡å¼æŒ‚è½½ï¼Œå‘½ä»¤è¡Œä¸­å¯ä»¥è¢«ç¼©å†™ä¸ºRWXã€‚ï¼ˆæ–‡ä»¶å…±äº«å­˜å‚¨ï¼‰</li>
<li><code>ReadWriteOncePod</code>ï¼šå¯ä»¥è¢«å•ä¸ª Pod ä»¥è¯»å†™æ–¹å¼æŒ‚è½½ã€‚ å¦‚æœä½ æƒ³ç¡®ä¿æ•´ä¸ªé›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ª Pod å¯ä»¥è¯»å–æˆ–å†™å…¥è¯¥ PVCï¼Œ è¯·ä½¿ç”¨ ReadWriteOnceè®¿é—®æ¨¡å¼ã€‚è¿™åªæ”¯æŒ CSI å·ä»¥åŠéœ€è¦ Kubernetes 1.22 ä»¥ä¸Šç‰ˆæœ¬ã€‚å‘½ä»¤è¡Œä¸­å¯ä»¥ç¼©å†™ä¸ºRWOPã€‚</li>
</ul>
<p><strong>PVå‘¨æœŸçš„å„ä¸ªé˜¶æ®µï¼š</strong></p>
<ul>
<li><strong>Availableï¼š</strong>å¯ç”¨ï¼Œæ²¡æœ‰è¢«PVCç»‘å®šçš„ç©ºé—²èµ„æºã€‚</li>
<li><strong>Boundï¼š</strong>å·²ç»‘å®šï¼Œå·²ç»è¢«PVCç»‘å®šã€‚</li>
<li><strong>Releasedï¼š</strong>å·²é‡Šæ”¾ï¼ŒPVCè¢«åˆ é™¤ï¼Œä½†æ˜¯èµ„æºè¿˜æœªè¢«é‡æ–°ä½¿ç”¨ã€‚</li>
<li><strong>Failedï¼š</strong>å¤±è´¥ï¼Œè‡ªåŠ¨å›æ”¶å¤±è´¥</li>
</ul>
<p>ğŸš’ï¼šPVå’ŒPVCæˆåŠŸåˆ›å»ºå¹¶ä¸ä»£è¡¨æŒ‚è½½æˆåŠŸï¼Œéœ€è¦PodæˆåŠŸå¯åŠ¨è¿‡åæ‰å¯ä»¥å‘ç°æŒ‚è½½æ˜¯å¦æˆåŠŸã€‚</p>
<p><strong>å­˜å‚¨åˆ†ç±»</strong></p>
<ul>
<li><strong>æ–‡ä»¶å­˜å‚¨ï¼š</strong>ä¸€äº›æ•°æ®å¯èƒ½éœ€è¦è¢«å¤šä¸ªèŠ‚ç‚¹ä½¿ç”¨ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å¤´åƒã€ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ç­‰ï¼Œå®ç°æ–¹å¼ï¼šNFSã€NASã€FTPã€CephFSç­‰ã€‚</li>
<li><strong>å—å­˜å‚¨ï¼š</strong>ä¸€äº›æ•°æ®åªèƒ½è¢«ä¸€ä¸ªèŠ‚ç‚¹ä½¿ç”¨ï¼Œæˆ–è€…æ˜¯éœ€è¦å°†ä¸€å—è£¸ç›˜æ•´ä¸ªæŒ‚è½½ä½¿ç”¨ï¼Œæ¯”å¦‚æ•°æ®åº“ã€Redisç­‰ï¼Œå®ç°æ–¹å¼ï¼šCephã€GlusterFSã€å…¬æœ‰äº‘ã€‚</li>
<li><strong>å¯¹è±¡å­˜å‚¨ï¼š</strong>ç”±ç¨‹åºä»£ç ç›´æ¥å®ç°çš„ä¸€ç§å­˜å‚¨æ–¹å¼ï¼Œäº‘åŸç”Ÿåº”ç”¨æ— çŠ¶æ€åŒ–å¸¸ç”¨çš„å®ç°æ–¹å¼ï¼Œå®ç°æ–¹å¼ï¼šä¸€èˆ¬æ˜¯ç¬¦åˆS3åè®®çš„äº‘å­˜å‚¨ï¼Œæ¯”å¦‚AWSçš„S3å­˜å‚¨ã€Minioã€ä¸ƒç‰›äº‘ç­‰</li>
</ul>
<h5 id="4-1-1-PVåˆ›å»º"><a href="#4-1-1-PVåˆ›å»º" class="headerlink" title="4.1.1 PVåˆ›å»º"></a>4.1.1 PVåˆ›å»º</h5><p>â€‹        <strong>æ³¨æ„ï¼šPVæ²¡æœ‰å‘½åç©ºé—´éš”ç¦»æ€§</strong></p>
<ol>
<li><strong>NFSé…ç½®</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; æœåŠ¡ç«¯å®‰è£…NFS</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># yum install nfs-utils rpcbind -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æœåŠ¡ç«¯åˆ›å»ºå…±äº«ç›®å½•</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># mkdir -p /data/k8s</span></span><br><span class="line"></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># vim /etc/exports </span></span><br><span class="line">/data/ 192.168.174.0/24(rw,sync,no_subtree_check,no_root_squash)</span><br><span class="line"></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># exportfs -r</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æœåŠ¡ç«¯å¯åŠ¨NFS</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># systemctl restart nfs rpcbind</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æ‰€æœ‰å®¢æˆ·ç«¯å®‰è£…nfs-utils</span></span><br><span class="line">$ yum install -y nfs-utils</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŒ‚è½½æµ‹è¯•</span></span><br><span class="line">$ mount -t nfs 192.168.174.30:/data/ /mnt/</span><br><span class="line">	</span><br><span class="line"><span class="comment">#&gt;&gt;&gt; å–æ¶ˆæŒ‚è½½</span></span><br><span class="line">$ umount /mnt/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºèµ„æºæ¸…å•</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># vim nfs-pv.yaml</span></span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: PersistentVolume</span><br><span class="line">metadata:</span><br><span class="line">  name: pv-nfs  <span class="comment"># PVåç§°</span></span><br><span class="line">spec:</span><br><span class="line">  capacity:</span><br><span class="line">    storage: 5Gi  <span class="comment"># å®¹é‡é…ç½®ï¼Œnfsä¸æ”¯æŒï¼Œé…ç½®æ—¶éœ€è¦åç«¯å­˜å‚¨è®¾å¤‡æ”¯æŒ</span></span><br><span class="line">  volumeMode: Filesystem <span class="comment"># å·çš„æ¨¡å¼ï¼Œç›®å‰æ”¯æŒFilesystemï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰å’ŒBlockï¼ˆå—ï¼‰ï¼Œå…¶ä¸­Blockç±»å‹éœ€è¦åç«¯å­˜å‚¨æ”¯æŒï¼Œé»˜è®¤ä¸ºæ–‡ä»¶ç³»ç»Ÿ</span></span><br><span class="line">  accessModes:</span><br><span class="line">  - ReadWriteOnce     <span class="comment"># PVçš„è®¿é—®æ¨¡å¼</span></span><br><span class="line">  persistentVolumeReclaimPolicy: Delete   <span class="comment"># PVçš„å›æ”¶ç­–ç•¥</span></span><br><span class="line">  storageClassName: nfs-slow   <span class="comment"># PVçš„ç±»ï¼Œä¸€ä¸ªç‰¹å®šç±»å‹çš„PVåªèƒ½ç»‘å®šåˆ°ç‰¹å®šç±»åˆ«çš„PVCï¼›</span></span><br><span class="line">  nfs:</span><br><span class="line">    path: /data/k8s    <span class="comment"># NFSä¸Šçš„å…±äº«ç›®å½•</span></span><br><span class="line">    server: 192.168.174.30   <span class="comment"># NFSçš„IPåœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºPV</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl create -f nfs-pv.yaml</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹PV</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl get pv</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/4.png" alt="image-20240630002010458"></p>
<p><strong>hostPathé…ç½®</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master01 ~]<span class="comment"># vim hostPath-pv.yaml</span></span><br><span class="line">---</span><br><span class="line">kind: PersistentVolume</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: task-pv-volume</span><br><span class="line">  labels:</span><br><span class="line">    <span class="built_in">type</span>: <span class="built_in">local</span></span><br><span class="line">spec:</span><br><span class="line">  storageClassName: hostpath</span><br><span class="line">  capacity:</span><br><span class="line">    storage: 1Gi</span><br><span class="line">  accessModes:</span><br><span class="line">  - ReadWriteOnce</span><br><span class="line">  hostPath:  <span class="comment"># hostPathæœåŠ¡é…ç½®</span></span><br><span class="line">    path: <span class="string">"/mnt/data"</span>  <span class="comment"># å®¿ä¸»æœºè·¯å¾„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºPV</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl create -f hostPath-pv.yaml</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹PV</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl  get -f hostPath-pv.yaml</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/5.png" alt="image-20240630002447200"></p>
<h4 id="4-2-PersistentVolumeClaim"><a href="#4-2-PersistentVolumeClaim" class="headerlink" title="4.2 PersistentVolumeClaim"></a>4.2 PersistentVolumeClaim</h4><p>â€‹    ç®€ç§°PVCï¼Œæ˜¯å¯¹å­˜å‚¨PVçš„è¯·æ±‚ï¼Œè¡¨ç¤ºéœ€è¦ä»€ä¹ˆç±»å‹çš„PVï¼Œéœ€è¦å­˜å‚¨çš„æŠ€æœ¯äººå‘˜åªéœ€è¦é…ç½®PVCå³å¯ä½¿ç”¨å­˜å‚¨ï¼Œæˆ–è€…Volumeé…ç½®PVCçš„åç§°å³å¯ã€‚PVCä½œä¸ºç”¨æˆ·å¯¹å­˜å‚¨èµ„æºçš„éœ€æ±‚ç”³è¯·ï¼Œä¸»è¦åŒ…æ‹¬å­˜å‚¨ç©ºé—´è¯·æ±‚ã€è®¿é—®æ¨¡å¼ã€PVé€‰æ‹©æ¡ä»¶å’Œå­˜å‚¨ç±»åˆ«ç­‰ä¿¡æ¯çš„è®¾ç½®ã€‚</p>
<h5 id="4-2-1-PVCçš„å…³é”®é…ç½®å‚æ•°"><a href="#4-2-1-PVCçš„å…³é”®é…ç½®å‚æ•°" class="headerlink" title="4.2.1 PVCçš„å…³é”®é…ç½®å‚æ•°"></a>4.2.1 PVCçš„å…³é”®é…ç½®å‚æ•°</h5><p><strong>èµ„æºè¯·æ±‚ï¼ˆResourcesï¼‰ï¼š</strong></p>
<p>â€‹        æè¿°å¯¹å­˜å‚¨èµ„æºçš„è¯·æ±‚ã€‚ç”³è¯·çš„èµ„æºåªèƒ½å°äºæˆ–ç­‰äºpvçš„å®¹é‡ã€‚ä½†å¦‚æœç”³è¯·çš„å®¹é‡å°äºPVçš„å®é™…å®¹é‡ï¼Œé‚£ä¹ˆå‰©ä½™æœªç”³è¯·å®¹é‡ä¼šæµªè´¹</p>
<p><strong>è®¿é—®æ¨¡å¼ï¼ˆAccess Modesï¼‰ï¼š</strong></p>
<p>â€‹        PVCä¹Ÿå¯ä»¥è®¾ç½®è®¿é—®æ¨¡å¼ï¼Œç”¨äºæè¿°ç”¨æˆ·åº”ç”¨å¯¹å­˜å‚¨èµ„æºçš„è®¿é—®æƒé™ã€‚è®¿é—®æ¨¡å¼çš„è®¾ç½®ä¸PVçš„è®¾ç½®ç›¸åŒã€‚</p>
<p><strong>å­˜å‚¨å·æ¨¡å¼ï¼ˆVolume Modesï¼‰ï¼š</strong></p>
<p>â€‹        PVCä¹Ÿå¯ä»¥è®¾ç½®å­˜å‚¨å·æ¨¡å¼ï¼Œç”¨äºæè¿°å¸Œæœ›ä½¿ç”¨çš„PVå­˜å‚¨å·æ¨¡å¼ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿå’Œå—è®¾å¤‡ã€‚</p>
<p><strong>PVCåˆ›å»º(PVCå—å‘½åç©ºé—´éš”ç¦»æ€§)</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master01 ~]<span class="comment"># vim pvc-nfs.yaml</span></span><br><span class="line">---</span><br><span class="line">kind: PersistentVolumeClaim</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: task-pvc-claim   <span class="comment"># pvcçš„åç§°</span></span><br><span class="line">spec:</span><br><span class="line">  storageClassName: nfs-slow     <span class="comment"># pv SCåç§°</span></span><br><span class="line">  accessModes:</span><br><span class="line">  - ReadWriteOnce         <span class="comment"># å’ŒPVçš„è®¿é—®ç­–ç•¥ä¸€è‡´</span></span><br><span class="line">  resources:</span><br><span class="line">    requests:</span><br><span class="line">      storage: 3Gi      <span class="comment"># åªèƒ½å°äºç­‰äºPVçš„å®¹é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºPVC</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl create -f pvc-nfs.yaml </span></span><br><span class="line">persistentvolumeclaim/task-pvc-claim created</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹PVC </span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl get -f pvc-nfs.yaml</span></span><br><span class="line">NAME             STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span><br><span class="line">task-pvc-claim   Bound    pv-nfs   5Gi        RWO            nfs-slow       17s</span><br><span class="line">	</span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹ç»‘å®šçš„PV</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl get -f  nfs-pv.yaml</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/6.png" alt="image-20240630002901244"></p>
<blockquote>
<p>ç»“æœæ˜¾ç¤ºpvçš„çŠ¶æ€å˜ä¸ºBoundï¼Œå·²è¢«æŒ‚è½½ã€‚</p>
</blockquote>
<p><strong>åˆ›å»ºdeployå®ä¾‹ï¼Œæµ‹è¯•æŒ‚è½½PVC</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master01 ~]<span class="comment"># vim nfs-pvc-deploy.yaml</span></span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">    labels:</span><br><span class="line">      app: nginx</span><br><span class="line">    name: nginx</span><br><span class="line">    namespace: default</span><br><span class="line">spec:</span><br><span class="line">    replicas: 1</span><br><span class="line">    selector:</span><br><span class="line">      matchLabels:</span><br><span class="line">        app: nginx</span><br><span class="line">    template:</span><br><span class="line">      metadata:</span><br><span class="line">        labels:</span><br><span class="line">          app: nginx</span><br><span class="line">      spec:</span><br><span class="line">        containers:</span><br><span class="line">        - image: registry.cn-hangzhou.aliyuncs.com/hujiaming/nginx:1.24.0</span><br><span class="line">          imagePullPolicy: IfNotPresent</span><br><span class="line">          name: nginx</span><br><span class="line">          volumeMounts:</span><br><span class="line">          - mountPath: <span class="string">"/usr/share/nginx/html"</span>  <span class="comment"># æŒ‚è½½è·¯å¾„</span></span><br><span class="line">            name: task-pv-storage</span><br><span class="line">        restartPolicy: Always</span><br><span class="line">        volumes:</span><br><span class="line">        - name: task-pv-storage     <span class="comment"># volumeåç§°</span></span><br><span class="line">          persistentVolumeClaim:</span><br><span class="line">            claimName: task-pvc-claim     <span class="comment"># pvcåç§°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; åˆ›å»ºèµ„æº</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl create -f nfs-pvc-deploy.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æŸ¥çœ‹pod</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl get po </span></span><br><span class="line">NAME                    READY   STATUS    RESTARTS   AGE</span><br><span class="line">nginx-8d486646b-tcrp4   1/1     Running   0          5s</span><br><span class="line">nginx-8d486646b-v46hc   1/1     Running   0          5s</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; æµ‹è¯•</span></span><br><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl exec  nginx-8d486646b-tcrp4  -- df -Th</span></span><br></pre></td></tr></table></figure>



<h4 id="4-3-PVå’ŒPVCçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#4-3-PVå’ŒPVCçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="4.3 PVå’ŒPVCçš„ç”Ÿå‘½å‘¨æœŸ"></a>4.3 PVå’ŒPVCçš„ç”Ÿå‘½å‘¨æœŸ</h4><p>â€‹        å¯ä»¥å°†PVçœ‹ä½œå¯ç”¨çš„å­˜å‚¨èµ„æºï¼ŒPVCåˆ™æ˜¯å¯¹å­˜å‚¨èµ„æºçš„éœ€æ±‚ï¼ŒPVå’ŒPVCçš„ç›¸äº’å…³ç³»éµå¾ªå¦‚å›¾8.1æ‰€ç¤ºçš„ç”Ÿå‘½å‘¨æœŸã€‚<img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/7.png" alt="image-20230403162950501"></p>
<p><strong>èµ„æºä¾›åº”</strong></p>
<p>â€‹    Kubernetesæ”¯æŒä¸¤ç§èµ„æºçš„ä¾›åº”æ¨¡å¼ï¼šé™æ€æ¨¡å¼ï¼ˆStaticï¼‰å’ŒåŠ¨æ€æ¨¡å¼ï¼ˆDynamicï¼‰ã€‚ èµ„æºä¾›åº”çš„ç»“æœå°±æ˜¯åˆ›å»ºå¥½çš„PVã€‚</p>
<ul>
<li><p><strong>é™æ€æ¨¡å¼ï¼š</strong></p>
<ul>
<li>é›†ç¾¤ç®¡ç†å‘˜æ‰‹å·¥åˆ›å»ºè®¸å¤šPVï¼Œåœ¨å®šä¹‰PVæ—¶éœ€è¦å°†åç«¯å­˜å‚¨çš„ç‰¹æ€§è¿›è¡Œè®¾ç½®ã€‚</li>
</ul>
</li>
<li><p><strong>åŠ¨æ€æ¨¡å¼ï¼š</strong></p>
<ul>
<li>é›†ç¾¤ç®¡ç†å‘˜æ— é¡»æ‰‹å·¥åˆ›å»ºPVï¼Œè€Œæ˜¯é€šè¿‡StorageClassçš„è®¾ç½®å¯¹åç«¯å­˜å‚¨è¿›è¡Œæè¿°ï¼Œæ ‡è®°ä¸ºæŸç§ç±»å‹ã€‚æ­¤æ—¶è¦æ±‚PVCå¯¹å­˜å‚¨çš„ç±»å‹è¿›è¡Œå£°æ˜ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å®ŒæˆPVçš„åˆ›å»ºåŠä¸PVCçš„ç»‘å®šã€‚PVCå¯ä»¥å£°æ˜Classä¸ºâ€â€ï¼Œè¯´æ˜è¯¥PVCç¦æ­¢ä½¿ç”¨åŠ¨æ€æ¨¡å¼ã€‚</li>
</ul>
</li>
</ul>
<p><strong>èµ„æºç»‘å®š</strong></p>
<p>â€‹        åœ¨ç”¨æˆ·å®šä¹‰å¥½PVCä¹‹åï¼Œç³»ç»Ÿå°†æ ¹æ®PVCå¯¹å­˜å‚¨èµ„æºçš„è¯·æ±‚ï¼ˆå­˜å‚¨ç©ºé—´å’Œè®¿é—®æ¨¡å¼ï¼‰åœ¨å·²å­˜åœ¨çš„PVä¸­é€‰æ‹©ä¸€ä¸ªæ»¡è¶³PVCè¦æ±‚çš„PVï¼Œä¸€æ—¦æ‰¾åˆ°ï¼Œå°±å°†è¯¥PVä¸ç”¨æˆ·å®šä¹‰çš„PVCè¿›è¡Œç»‘å®šï¼Œ ç”¨æˆ·çš„åº”ç”¨å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªPVCäº†ã€‚å¦‚æœåœ¨ç³»ç»Ÿä¸­æ²¡æœ‰æ»¡è¶³PVCè¦æ±‚çš„PVï¼ŒPVCåˆ™ä¼šæ— é™æœŸå¤„äºPendingçŠ¶æ€ï¼Œç›´åˆ°ç­‰åˆ°ç³»ç»Ÿç®¡ç†å‘˜åˆ›å»ºäº†ä¸€ä¸ªç¬¦åˆå…¶è¦æ±‚çš„PVã€‚PVä¸€æ—¦ç»‘å®šåˆ°æŸä¸ªPVCä¸Šï¼Œå°±ä¼šè¢«è¿™ä¸ªPVCç‹¬å ï¼Œä¸èƒ½å†ä¸å…¶ä»–PVCè¿›è¡Œç»‘å®šäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“PVCç”³è¯·çš„å­˜å‚¨ç©ºé—´æ¯”PVçš„å°‘æ—¶ï¼Œæ•´ä¸ªPVçš„ç©ºé—´å°±éƒ½èƒ½å¤Ÿä¸ºPVCæ‰€ç”¨ï¼Œå¯èƒ½ä¼šé€ æˆèµ„æºçš„æµªè´¹ã€‚å¦‚æœèµ„æºä¾›åº”ä½¿ç”¨çš„æ˜¯åŠ¨æ€æ¨¡å¼ï¼Œåˆ™ç³»ç»Ÿåœ¨ä¸ºPVCæ‰¾åˆ°åˆé€‚çš„StorageClassåï¼Œå°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªPVå¹¶å®Œæˆä¸PVCçš„ç»‘å®šã€‚</p>
<p><strong>èµ„æºä½¿ç”¨</strong></p>
<p>â€‹        Podä½¿ç”¨Volumeçš„å®šä¹‰ï¼Œå°†PVCæŒ‚è½½åˆ°å®¹å™¨å†…çš„æŸä¸ªè·¯å¾„è¿›è¡Œä½¿ç”¨ã€‚Volumeçš„ç±»å‹ä¸ºpersistentVolumeClaimï¼Œåœ¨å®¹å™¨åº”ç”¨æŒ‚è½½äº†ä¸€ä¸ªPVCåï¼Œ å°±èƒ½è¢«æŒç»­ç‹¬å ä½¿ç”¨ã€‚ä¸è¿‡ï¼Œå¤šä¸ªPodå¯ä»¥æŒ‚è½½åŒä¸€ä¸ªPVCï¼Œåº”ç”¨ç¨‹åºéœ€è¦è€ƒè™‘å¤šä¸ªå®ä¾‹å…±åŒè®¿é—®ä¸€å—å­˜å‚¨ç©ºé—´çš„é—®é¢˜ã€‚</p>
<p><strong>èµ„æºé‡Šæ”¾</strong></p>
<p>â€‹         å½“ç”¨æˆ·å¯¹å­˜å‚¨èµ„æºä½¿ç”¨å®Œæ¯•åï¼Œç”¨æˆ·å¯ä»¥åˆ é™¤PVCï¼Œä¸è¯¥PVCç»‘å®šçš„PVå°†ä¼šè¢«æ ‡è®°ä¸º â€œå·²é‡Šæ”¾â€ï¼Œä½†è¿˜ä¸èƒ½ç«‹åˆ»ä¸å…¶ä»–PVCè¿›è¡Œç»‘å®šã€‚é€šè¿‡ä¹‹å‰PVCå†™å…¥çš„æ•°æ®å¯èƒ½è¿˜è¢«ç•™åœ¨å­˜å‚¨è®¾å¤‡ä¸Šï¼Œåªæœ‰åœ¨æ¸…é™¤ä¹‹åè¯¥PVæ‰èƒ½å†æ¬¡ä½¿ç”¨</p>
<p><strong>èµ„æºå›æ”¶</strong></p>
<p>â€‹            å¯¹äºPVï¼Œç®¡ç†å‘˜å¯ä»¥è®¾å®šå›æ”¶ç­–ç•¥ï¼Œç”¨äºè®¾ç½®ä¸ä¹‹ç»‘å®šçš„PVCé‡Šæ”¾èµ„æºä¹‹åå¦‚ä½•å¤„ç† é—ç•™æ•°æ®çš„é—®é¢˜ã€‚åªæœ‰PVçš„å­˜å‚¨ç©ºé—´å®Œæˆå›æ”¶ï¼Œæ‰èƒ½ä¾›æ–°çš„PVCç»‘å®šå’Œä½¿ç”¨ã€‚</p>
<p><strong>å›¾8.2æè¿°äº†åœ¨é™æ€èµ„æºä¾›åº”æ¨¡å¼ä¸‹ï¼Œé€šè¿‡PVå’ŒPVCå®Œæˆç»‘å®šï¼Œå¹¶ä¾›Podä½¿ç”¨çš„å­˜å‚¨ç®¡ç†æœºåˆ¶ã€‚</strong><img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/8.png" alt="image-20230403163719564"></p>
<p><strong>å›¾8.3æè¿°äº†åœ¨åŠ¨æ€èµ„æºä¾›åº”æ¨¡å¼ä¸‹ï¼Œé€šè¿‡StorageClasså’ŒPVCå®Œæˆèµ„æºåŠ¨æ€ç»‘å®šï¼ˆç³» ç»Ÿè‡ªåŠ¨ç”ŸæˆPVï¼‰ï¼Œå¹¶ä¾›Podä½¿ç”¨çš„å­˜å‚¨ç®¡ç†æœºåˆ¶</strong>ã€‚<img src="/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/9.png" alt="image-20230403163826839"></p>
<h4 id="4-4-PVCåˆ›å»ºå’ŒæŒ‚è½½å¤±è´¥çš„åŸå› "><a href="#4-4-PVCåˆ›å»ºå’ŒæŒ‚è½½å¤±è´¥çš„åŸå› " class="headerlink" title="4.4 PVCåˆ›å»ºå’ŒæŒ‚è½½å¤±è´¥çš„åŸå› "></a>4.4 PVCåˆ›å»ºå’ŒæŒ‚è½½å¤±è´¥çš„åŸå› </h4><ul>
<li><p><strong>PVCä¸€ç›´Pendingçš„åŸå› </strong>ï¼š</p>
<ul>
<li><p>PVCçš„ç©ºé—´ç”³è¯·å¤§å°å¤§äºPVçš„å¤§å°ï¼›</p>
</li>
<li><p>PVCçš„StorageClassNameæ²¡æœ‰å’ŒPVçš„ä¸€è‡´ï¼›</p>
</li>
<li><p>PVCçš„accessModeså’ŒPVçš„ä¸ä¸€è‡´ã€‚</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>æŒ‚è½½PVCçš„Podä¸€ç›´å¤„äºPending</strong>ï¼š</p>
<ul>
<li><p>PVCæ²¡æœ‰åˆ›å»ºæˆåŠŸ/PVCä¸å­˜åœ¨ï¼›</p>
</li>
<li><p>PVCå’ŒPodä¸åœ¨åŒä¸€ä¸ªNamespace</p>
</li>
</ul>
</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">L66</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://l66stbz.github.io/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/">https://l66stbz.github.io/2024/09/20/Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/08-Kubernetes%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://l66stbz.github.io" target="_blank">L66</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/Kubernetes/">Kubernetes</a></div><div class="post_share"><div class="social-share" data-image="https://l66stbz.github.io/2024/09/23/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²è‹¥ä¾/1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> æ‰“èµ<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="å¾®ä¿¡"/><div class="post-qr-code__desc">å¾®ä¿¡</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="æ”¯ä»˜å¯¶"/><div class="post-qr-code__desc">æ”¯ä»˜å¯¶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2024/09/23/spring%20cloud%20k8s%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2/spring%20cloud%20k8s%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E8%8B%A5%E4%BE%9D/"><img class="prev_cover" src="https://l66stbz.github.io/2024/09/23/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²è‹¥ä¾/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨</div></div></a></div><div class="next-post pull_right"><a href="/2024/09/19/Kubernetes%20RBAC%E7%BB%86%E7%B2%92%E5%BA%A6%E6%9D%83%E9%99%90%E5%88%92%E5%88%86/07-Kubernetes%20RBAC%E7%BB%86%E7%B2%92%E5%BA%A6%E6%9D%83%E9%99%90%E5%88%92%E5%88%86/"><img class="next_cover" src="https://l66stbz.github.io/2024/09/19/Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†/07-Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2024/09/23/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²è‹¥ä¾/" title="KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/23/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²/spring cloud k8så®¹å™¨åŒ–éƒ¨ç½²è‹¥ä¾/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-23</div><div class="relatedPosts_title">KubernetesæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨</div></div></a></div><div class="relatedPosts_item"><a href="/2024/09/13/KubernetesåŸºç¡€æ¦‚å¿µ/01-KubernetesåŸºç¡€æ¦‚å¿µ/" title="KubernetesåŸºç¡€æ¦‚å¿µ"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/13/KubernetesåŸºç¡€æ¦‚å¿µ/01-KubernetesåŸºç¡€æ¦‚å¿µ/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-13</div><div class="relatedPosts_title">KubernetesåŸºç¡€æ¦‚å¿µ</div></div></a></div><div class="relatedPosts_item"><a href="/2024/09/14/Kuberneteså®¹å™¨ç¼–æ’å·¥å…·éƒ¨ç½²ï¼ˆadmï¼‰/02-Kuberneteså®¹å™¨ç¼–æ’å·¥å…·éƒ¨ç½²ï¼ˆadmï¼‰/" title="Kuberneteså®¹å™¨ç¼–æ’å·¥å…·éƒ¨ç½²ï¼ˆadmï¼‰"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/14/Kuberneteså®¹å™¨ç¼–æ’å·¥å…·éƒ¨ç½²ï¼ˆadmï¼‰/02-Kuberneteså®¹å™¨ç¼–æ’å·¥å…·éƒ¨ç½²ï¼ˆadmï¼‰/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-14</div><div class="relatedPosts_title">Kuberneteså®¹å™¨ç¼–æ’å·¥å…·éƒ¨ç½²ï¼ˆadmï¼‰</div></div></a></div><div class="relatedPosts_item"><a href="/2024/09/15/kubernetes äºŒè¿›åˆ¶é«˜å¯ç”¨å®‰è£…éƒ¨ç½²ï¼ˆv1.23+ï¼‰/kubernetes äºŒè¿›åˆ¶é«˜å¯ç”¨å®‰è£…éƒ¨ç½²ï¼ˆv1.23+ï¼‰/" title="kubernetes äºŒè¿›åˆ¶é«˜å¯ç”¨å®‰è£…éƒ¨ç½²ï¼ˆv1.23+ï¼‰"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/15/kubernetes äºŒè¿›åˆ¶é«˜å¯ç”¨å®‰è£…éƒ¨ç½²ï¼ˆv1.23+ï¼‰/kubernetes äºŒè¿›åˆ¶é«˜å¯ç”¨å®‰è£…éƒ¨ç½²ï¼ˆv1.23+ï¼‰/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-15</div><div class="relatedPosts_title">kubernetes äºŒè¿›åˆ¶é«˜å¯ç”¨å®‰è£…éƒ¨ç½²ï¼ˆv1.23+ï¼‰</div></div></a></div><div class="relatedPosts_item"><a href="/2024/09/19/Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†/07-Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†/" title="Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/19/Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†/07-Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-19</div><div class="relatedPosts_title">Kubernetes RBACç»†ç²’åº¦æƒé™åˆ’åˆ†</div></div></a></div><div class="relatedPosts_item"><a href="/2024/09/18/Kubernetesé…ç½®ç®¡ç†/06-Kubernetesé…ç½®ç®¡ç†/" title="Kubernetesé…ç½®ç®¡ç†"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/09/18/Kubernetesé…ç½®ç®¡ç†/06-Kubernetesé…ç½®ç®¡ç†/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-09-18</div><div class="relatedPosts_title">Kubernetesé…ç½®ç®¡ç†</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By L66</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="é˜…è¯»æ¨¡å¼"></i><i class="fa fa-plus" id="font_plus" title="æ”¾å¤§å­—ä½“"></i><i class="fa fa-minus" id="font_minus" title="ç¼©å°å­—ä½“"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="ç®€ç¹è½¬æ¢" target="_self">ç¹</a><i class="darkmode fa fa-moon-o" id="darkmode" title="å¤œé—´æ¨¡å¼"></i></div><div id="rightside-config-show"><div id="rightside_config" title="è®¾ç½®"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="ç›®å½•" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="å›åˆ°é¡¶éƒ¨" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/third-party/click_heart.js"></script></body></html>