<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>文件服务器 | L66</title><meta name="description" content="文件服务器1.构建NFS远程共享存储1234567文件系统级别共享（是NAS存储） ---------  已经做好了格式化，可以直接用。 速度慢比如：nfs，samba&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;因为NFS有很多功能，不同的功能需要使用不同的端口。因此NFS无法固定端口。而RPC会记录NFS端口的信息，这样就能够通过RP"><meta name="keywords" content="Linux,NFS,FTP"><meta name="author" content="L66"><meta name="copyright" content="L66"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/3.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="文件服务器"><meta name="twitter:description" content="文件服务器1.构建NFS远程共享存储1234567文件系统级别共享（是NAS存储） ---------  已经做好了格式化，可以直接用。 速度慢比如：nfs，samba&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;因为NFS有很多功能，不同的功能需要使用不同的端口。因此NFS无法固定端口。而RPC会记录NFS端口的信息，这样就能够通过RP"><meta name="twitter:image" content="https://l66stbz.github.io/2024/07/04/文件服务器/8.jpg"><meta property="og:type" content="article"><meta property="og:title" content="文件服务器"><meta property="og:url" content="https://l66stbz.github.io/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/"><meta property="og:site_name" content="L66"><meta property="og:description" content="文件服务器1.构建NFS远程共享存储1234567文件系统级别共享（是NAS存储） ---------  已经做好了格式化，可以直接用。 速度慢比如：nfs，samba&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;因为NFS有很多功能，不同的功能需要使用不同的端口。因此NFS无法固定端口。而RPC会记录NFS端口的信息，这样就能够通过RP"><meta property="og:image" content="https://l66stbz.github.io/2024/07/04/文件服务器/8.jpg"><meta property="article:published_time" content="2024-07-04T13:00:00.000Z"><meta property="article:modified_time" content="2024-07-04T11:55:05.916Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://l66stbz.github.io/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/"><link rel="prev" title="WEB服务器" href="https://l66stbz.github.io/2024/07/05/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8/"><link rel="next" title="Linux存储管理(lvm,swap,raid)" href="https://l66stbz.github.io/2024/07/03/%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="L66" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/2.jpg" onerror="onerror=null;src='/img/2.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">25</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">20</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#文件服务器"><span class="toc-number">1.</span> <span class="toc-text">文件服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-构建NFS远程共享存储"><span class="toc-number">1.1.</span> <span class="toc-text">1.构建NFS远程共享存储</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#实例"><span class="toc-number">1.1.0.0.1.</span> <span class="toc-text">实例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、Ftp-介绍"><span class="toc-number">1.2.</span> <span class="toc-text">2、Ftp 介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、FTP基础"><span class="toc-number">1.2.1.</span> <span class="toc-text">一、FTP基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ftp主动模式"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">1.ftp主动模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ftp被动模式"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">2.ftp被动模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Vsftp-服务器简介"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">3.Vsftp 服务器简介</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、vsftpd配置"><span class="toc-number">1.2.2.</span> <span class="toc-text">二、vsftpd配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ftp配置匿名用户登录"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">1.ftp配置匿名用户登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ftp配置本地用户登录"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.ftp配置本地用户登录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1服务端操作"><span class="toc-number">1.2.2.2.1.</span> <span class="toc-text">2.1服务端操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2客户端操作"><span class="toc-number">1.2.2.2.2.</span> <span class="toc-text">2.2客户端操作</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-系统优化检测常用命令"><span class="toc-number">1.3.</span> <span class="toc-text">3.系统优化检测常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、查看平均负载"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、查看平均负载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、释放buffer和cache"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、释放buffer和cache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、带宽使用情况"><span class="toc-number">1.3.3.</span> <span class="toc-text">3、带宽使用情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、网络接口统计报告"><span class="toc-number">1.3.4.</span> <span class="toc-text">4、网络接口统计报告</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://l66stbz.github.io/2024/07/04/文件服务器/8.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">L66</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">文件服务器</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2024-07-04 21:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2024-07-04</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2024-07-04 19:55:05"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2024-07-04</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="文件服务器"><a href="#文件服务器" class="headerlink" title="文件服务器"></a>文件服务器</h1><h2 id="1-构建NFS远程共享存储"><a href="#1-构建NFS远程共享存储" class="headerlink" title="1.构建NFS远程共享存储"></a>1.构建NFS远程共享存储</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">文件系统级别共享（是NAS存储） ---------  已经做好了格式化，可以直接用。 速度慢比如：nfs，samba</span><br><span class="line">=====================================================</span><br><span class="line">因为NFS有很多功能，不同的功能需要使用不同的端口。因此NFS无法固定端口。而RPC会记录NFS端口的信息，这样就能够通过RPC实现服务端和客户端的RPC来沟通端口信息。</span><br><span class="line"></span><br><span class="line">那RPC和NFS之间又是如何之间相互通讯的？</span><br><span class="line"></span><br><span class="line">首先当NFS启动后，就会随机的使用一些端口，然后NFS就会向RPC去注册这些端口。RPC就会记录下这些端口。并且RPC会开启111端口，等待客户端RPC的请求，如果客户端有请求，那服务端的RPC就会将记录的NFS端口信息告知客户端。</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NFS </span><br><span class="line">NFS：Network File System 网络文件系统，NFS 和其他文件系统一样，是在 Linux 内核中实现的，因此 NFS 很难做到与 Windows 兼容。NFS 共享出的文件系统会被客户端识别为一个文件系统，客户端可以直接挂载并使用。是Unix系统之间共享文件的一种协议</span><br><span class="line">NFS 文件系统仅支持基于 IP 的用户访问控制，NFS 的客户端主要为Linux。</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">实验环境准备两台机器</span><br><span class="line">支持多节点同时挂载以及并发写入</span><br><span class="line">服务端：nfs-server 192.168.100.60</span><br><span class="line">客户端：web1 192.168.100.70</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">centos7（服务端和客户端都关闭防火墙和selinux内核防火墙）</span><br><span class="line"><span class="meta">#</span><span class="bash">systemctl stop firewalld</span></span><br><span class="line"><span class="meta">#</span><span class="bash">systemctl <span class="built_in">disable</span> firewalld	</span></span><br><span class="line"><span class="meta">#</span><span class="bash">setenforce 0</span></span><br></pre></td></tr></table></figure>

<h5 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">NFS-server操作</span><br><span class="line">[root@nfs-server ~]# setenforce 0</span><br><span class="line">[root@nfs-server ~]# systemctl stop firewalld</span><br><span class="line">分区格式化挂载</span><br><span class="line">[root@nfs-server ~]# fdisk /dev/sdb</span><br><span class="line">欢迎使用 fdisk (util-linux 2.23.2)。</span><br><span class="line"></span><br><span class="line">更改将停留在内存中，直到您决定将更改写入磁盘。</span><br><span class="line">使用写入命令前请三思。</span><br><span class="line"></span><br><span class="line">Device does not contain a recognized partition table</span><br><span class="line">使用磁盘标识符 0x2dbf8bc5 创建新的 DOS 磁盘标签。</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): p</span><br><span class="line">分区号 (1-4，默认 1)：1</span><br><span class="line">起始 扇区 (2048-41943039，默认为 2048)：</span><br><span class="line">将使用默认值 2048</span><br><span class="line">Last 扇区, +扇区 or +size&#123;K,M,G&#125; (2048-41943039，默认为 41943039)：+20G</span><br><span class="line">值超出范围。</span><br><span class="line">Last 扇区, +扇区 or +size&#123;K,M,G&#125; (2048-41943039，默认为 41943039)：+10G     </span><br><span class="line">分区 1 已设置为 Linux 类型，大小设为 10 GiB</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：W</span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">正在同步磁盘。</span><br><span class="line">[root@localhost ~]# lsblk </span><br><span class="line">NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda               8:0    0   20G  0 disk </span><br><span class="line">├─sda1            8:1    0    1G  0 part /boot</span><br><span class="line">└─sda2            8:2    0   19G  0 part </span><br><span class="line">  ├─centos-root 253:0    0   17G  0 lvm  /</span><br><span class="line">  └─centos-swap 253:1    0    2G  0 lvm  [SWAP]</span><br><span class="line">sdb               8:16   0   20G  0 disk </span><br><span class="line">└─sdb1            8:17   0   10G  0 part </span><br><span class="line">sr0              11:0    1  4.4G  0 rom  </span><br><span class="line">[root@nfs-server ~]# mkfs.xfs /dev/sdb1 </span><br><span class="line">meta-data=/dev/sdb1              isize=512    agcount=4, agsize=655360 blks</span><br><span class="line">         =                       sectsz=512   attr=2, projid32bit=1</span><br><span class="line">         =                       crc=1        finobt=0, sparse=0</span><br><span class="line">data     =                       bsize=4096   blocks=2621440, imaxpct=25</span><br><span class="line">         =                       sunit=0      swidth=0 blks</span><br><span class="line">naming   =version 2              bsize=4096   ascii-ci=0 ftype=1</span><br><span class="line">log      =internal log           bsize=4096   blocks=2560, version=2</span><br><span class="line">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none                   extsz=4096   blocks=0, rtextents=0</span><br><span class="line">[root@nfs-server ~]# mount /dev/sdb1 /XFS/</span><br><span class="line">[root@nfs-server ~]# df -Th</span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">devtmpfs                devtmpfs  475M     0  475M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     487M     0  487M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     487M  7.7M  479M    2% /run</span><br><span class="line">tmpfs                   tmpfs     487M     0  487M    0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/centos-root xfs        17G  1.6G   16G   10% /</span><br><span class="line">/dev/sda1               xfs      1014M  138M  877M   14% /boot</span><br><span class="line">tmpfs                   tmpfs      98M     0   98M    0% /run/user/0</span><br><span class="line">/dev/sdb1               xfs        10G   33M   10G    1% /XFS</span><br><span class="line">[root@nfs-server ~]# yum -y install rpcbind  #安装rpc协议的包</span><br><span class="line">[root@nfs-server ~]# yum -y install nfs-utils #安装nfs服务,提供文件系统</span><br><span class="line">启动服务</span><br><span class="line">[root@nfs-server ~]# systemctl start nfs</span><br><span class="line">[root@nfs-server ~]# systemctl start rpcbind</span><br><span class="line">[root@nfs-server ~]# mkdir /XFS   #创建存储目录</span><br><span class="line">[root@nfs-server ~]# echo "nfs-test" &gt;&gt; /XFS/index.html  #制作test文件</span><br><span class="line">[root@nfs-server ~]# vim /etc/exports   #编辑共享文件</span><br><span class="line">/XFS        192.168.100.0/24(rw,no_root_squash,sync)</span><br><span class="line"></span><br><span class="line">可选参数注释：</span><br><span class="line">ro：只读</span><br><span class="line">rw：读写</span><br><span class="line">*:表示共享给所有网段。</span><br><span class="line">sync：所有数据在请求时写入共享</span><br><span class="line">root_squash： 对于使用分享目录的使用者如果是root用户，那么这个使用者的权限将被压缩成为匿名使用者，只读权限。</span><br><span class="line">no_root_squash：使用分享目录的使用者，如果是 root 的话，那么对于这个分享的目录来说，他就具有 root 的权限。</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/1.png" class></strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@nfs-server ~]# systemctl restart nfs-server #重启服务。</span><br><span class="line">[root@nfs-server ~]# systemctl enable nfs-server #制作开机启</span><br><span class="line">[root@nfs-server ~]# exportfs -v   #确认 NFS 服务器启动</span><br><span class="line">/XFS            192.168.100.0/24(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">web1  客户端操作</span><br><span class="line">[root@web1 ~]# setenforce 0</span><br><span class="line">[root@web1 ~]# systemctl stop firewalld</span><br><span class="line">[root@web1 ~]# yum -y install rpcbind</span><br><span class="line">[root@web1 ~]# yum -y install nfs-utils</span><br><span class="line">启动服务</span><br><span class="line">[root@web1 ~]# systemctl start nfs</span><br><span class="line">[root@web1 ~]# systemctl start rpcbind</span><br><span class="line">[root@web1 ~]# mkdir /nfs #创建挂载点</span><br><span class="line">[root@web1 ~]# mount -t nfs 192.168.100.60:/XFS /nfs  #挂载</span><br><span class="line">[root@web1 ~]# df -Th</span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">devtmpfs                devtmpfs  475M     0  475M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     487M     0  487M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     487M  7.8M  479M    2% /run</span><br><span class="line">tmpfs                   tmpfs     487M     0  487M    0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/centos-root xfs        17G  1.6G   16G   10% /</span><br><span class="line">/dev/sda1               xfs      1014M  138M  877M   14% /boot</span><br><span class="line">tmpfs                   tmpfs      98M     0   98M    0% /run/user/0</span><br><span class="line">192.168.100.60:/XFS     nfs4       10G   33M   10G    1% /nfs</span><br><span class="line"></span><br><span class="line">[root@web1 ~]# ls /nfs</span><br><span class="line">index.html</span><br><span class="line">[root@web1 ~]# umount /nfs  #取消挂载</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">制作开机挂载</span><br><span class="line">[root@web1 ~]# vim /etc/fstab</span><br><span class="line">192.168.100.60:/XFS    /nfs          nfs     defaults        0 0</span><br><span class="line">[root@web1 ~]# mount -a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@web1 ~]# reboot</span><br><span class="line">[root@web1 ~]# df -Th</span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">devtmpfs                devtmpfs  475M     0  475M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     487M     0  487M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     487M  7.7M  479M    2% /run</span><br><span class="line">tmpfs                   tmpfs     487M     0  487M    0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/centos-root xfs        17G  1.6G   16G   10% /</span><br><span class="line">/dev/sda1               xfs      1014M  138M  877M   14% /boot</span><br><span class="line">192.168.100.60:/XFS     nfs4       10G   33M   10G    1% /nfs</span><br><span class="line">tmpfs                   tmpfs      98M     0   98M    0% /run/user/0</span><br></pre></td></tr></table></figure>



<h2 id="2、Ftp-介绍"><a href="#2、Ftp-介绍" class="headerlink" title="2、Ftp 介绍"></a>2、Ftp 介绍</h2><ul>
<li><p>文件传输协议（File Transfer Protocol，FTP），基于该协议FTP客户端与服务端可以实现共享文件、上传文件、下载文件。 FTP 基于TCP协议生成一个虚拟的连接，用户可以通过客户端向FTP服务器端上传、下载、删除文件，FTP服务器端可以同时提供给多人共享使用。</p>
</li>
<li><p>FTP服务是Client/Server（简称C/S）模式，基于FTP协议实现FTP文件对外共享及传输的软件称之为FTP服务器源端，客户端程序基于FTP协议，则称之为FTP客户端，FTP客户端可以向FTP服务器上传、下载文件。</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FTP Server</span><br><span class="line">作用：提供文件共享服务,实现上传下载</span><br><span class="line">端口：</span><br><span class="line">21号，建立tcp连接  默认端口</span><br><span class="line">20号：传输数据</span><br></pre></td></tr></table></figure>

<h3 id="一、FTP基础"><a href="#一、FTP基础" class="headerlink" title="一、FTP基础"></a>一、FTP基础</h3><p>下载后使用，不能直接在ftp内打开</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">软件包:        vsftpd</span><br><span class="line">FTP端口:         控制端口 command 21/tcp </span><br><span class="line">配置文件:          /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>

<h4 id="1-ftp主动模式"><a href="#1-ftp主动模式" class="headerlink" title="1.ftp主动模式"></a>1.ftp主动模式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ftp主动模式：客户端开启一个端口N（&gt;1023）向服务端的21端口，建立连接，同时开启一个N+1，告诉服务端，我监听的是N+1端口，服务端接到请求之后，用自己的20端口连接到客户端的N+1端口，进行传输。</span><br><span class="line"></span><br><span class="line">21端口建立连接</span><br><span class="line">20端口传输数据</span><br><span class="line">N+1就是另一个&gt;1023的端口</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/2.png" class></strong></p>
<h4 id="2-ftp被动模式"><a href="#2-ftp被动模式" class="headerlink" title="2.ftp被动模式"></a>2.ftp被动模式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp被动模式：客户端同时开启两个端口（1024，1025），一个端口（1024）跟服务端的21端口建立连接，并请求，大哥，我连上了，你再开一个端口呗。服务端接到请求之后，随机会开启一个端口（1027）并告诉客户端我开启的是1027端口，客户端用另一个端口（1025）(图中用的是1026)与服务端的（1027）(图中用的是1025)端口进行连接，传输数据。</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/3.png" class></strong></p>
<h4 id="3-Vsftp-服务器简介"><a href="#3-Vsftp-服务器简介" class="headerlink" title="3.Vsftp 服务器简介"></a>3.Vsftp 服务器简介</h4><ul>
<li>非常安全的FTP服务进程（Very Secure FTP daemon，Vsftpd），Vsftpd在Unix/Linux发行版中最主流的FTP服务器程序，优点小巧轻快，安全易用、稳定高效、满足企业跨部门、多用户的使用（1000用户）等。</li>
</ul>
<h3 id="二、vsftpd配置"><a href="#二、vsftpd配置" class="headerlink" title="二、vsftpd配置"></a>二、vsftpd配置</h3><h4 id="1-ftp配置匿名用户登录"><a href="#1-ftp配置匿名用户登录" class="headerlink" title="1.ftp配置匿名用户登录"></a>1.ftp配置匿名用户登录</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">FTP Server（服务端）</span><br><span class="line">实验环境--准备两台机器</span><br><span class="line">关闭防火墙和selinux</span><br><span class="line"><span class="meta">#</span><span class="bash">systemctl stop firewalld</span></span><br><span class="line"><span class="meta">#</span><span class="bash">systemctl <span class="built_in">disable</span> firewalld	</span></span><br><span class="line"><span class="meta">#</span><span class="bash">setenforce 0</span></span><br><span class="line">=========================================</span><br><span class="line">ftp-server 192.168.100.60</span><br><span class="line">client 192.168.100.70</span><br><span class="line">==========================================</span><br><span class="line">[root@ftp-server ~]# yum install -y vsftpd</span><br><span class="line">[root@ftp-server ~]# systemctl start vsftpd   #  启动vsftpd</span><br><span class="line">[root@ftp-server ~]# id ftp</span><br><span class="line">uid=14(ftp) gid=50(ftp) 组=50(ftp)</span><br><span class="line">[root@ftp-server ~]# grep ftp /etc/passwd</span><br><span class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line"><span class="meta">#</span><span class="bash">可以发现系统自己创建了一个名为ftp的系统用户(uid&lt;1000),当别的机器连接后其实就是在以ftp用户的身份来进行操作的。并且可以看到该用户的shell信息为不可登陆shell。说明该用户并不能是用我们系统终端内的命令。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FTP默认共享目录：/var/ftp</span><br><span class="line">[root@ftp-server ~]# touch /var/ftp/pub/test.txt  #创建文件到共享目录</span><br><span class="line">[root@ftp-server ~]# systemctl enable vsftpd</span><br><span class="line">[root@ftp-server ~]# cd /var/ftp/</span><br><span class="line">[root@ftp-server ftp]# ls</span><br><span class="line">pub</span><br><span class="line">[root@ftp-server ftp]# chown ftp.ftp pub/ -R  #修改根目录的属主与属组，或者chmod修改O权限也可</span><br><span class="line">或[root@ftp-server ftp]# chmod 777 /var/ftp/pub/ -R</span><br><span class="line">[root@ftp-server ftp]# ll </span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x. 2 ftp ftp 22 Aug  3 03:15 pub</span><br></pre></td></tr></table></figure>

<ul>
<li><p>重点：改变根目录的属主，如果不改变的话，只能访问，其他权限不能生效。因为我们是以ftp用户的身份访问的，而pub默认的属主属组是root。ftp对于该目录的身份为其他人。</p>
</li>
<li><p>注意：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 修改完配置之后需要重启完服务才能生效</span><br><span class="line">- 还需要从新从客户端登陆，否则修改后的配置看不到效果。</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>编辑配置文件    #  /var/ftp目录本身权限不能超过755</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp-server ~]# vi /etc/vsftpd/vsftpd.conf ----找到29行将下面的注释取消</span><br><span class="line">34 anon_other_write_enable=YES</span><br><span class="line">anon_umask=000  #匿名用户上传下载目录权限掩码</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/4.png" class></strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp-server ~]# systemctl restart vsftpd</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">FTP Clinet（客户端）</span><br><span class="line">关闭防火墙和selinux</span><br><span class="line">[root@client ~]# yum -y install lftp #安装客户端</span><br><span class="line">get命令（下载，首先要开启下载功能）</span><br><span class="line">[root@client ~]# lftp 192.168.100.60</span><br><span class="line">lftp 192.168.100.60:~&gt; ls</span><br><span class="line">drwxr-xr-x    2 0        0               6 Oct 30  2018 pub</span><br><span class="line">lftp 192.168.100.60:/&gt; cd pub/</span><br><span class="line">lftp 192.168.100.60:/pub&gt; ls</span><br><span class="line">-rw-r--r--    1 14       50              0 Aug 02 19:14 test.txt</span><br><span class="line">lftp 192.168.100.60:/pub&gt; get test.txt   #下载</span><br><span class="line">lftp 192.168.100.60:/pub&gt; exit</span><br><span class="line">[root@client ~]# ls  #会下载到当前目录</span><br><span class="line">anaconda-ks.cfg  test.txt</span><br><span class="line"></span><br><span class="line">[root@client ~]# lftp 192.168.100.60</span><br><span class="line">lftp 192.168.100.60:/pub&gt; mkdir dir  #也可以创建目录</span><br><span class="line">mkdir ok, `dir' created</span><br><span class="line"></span><br><span class="line">put命令（上传命令，上传之前请在服务端进行配置，将上传功能打开）</span><br><span class="line">[root@client ~]# touch upload.txt  #创建测试文件</span><br><span class="line">[root@client ~]# mkdir /test/  #创建测试目录</span><br><span class="line">[root@client ~]# touch /test/test1.txt #在测试目录下面创建测试文件</span><br><span class="line">[root@client ~]# lftp 192.168.100.60</span><br><span class="line">lftp 192.168.100.60:~&gt; cd pub/</span><br><span class="line">lftp 192.168.100.60:/pub&gt; put /root/upload.txt  #上传文件</span><br><span class="line">lftp 192.168.100.60:/pub&gt; ls</span><br><span class="line">-rw-------    1 14       50              0 Nov 16 12:14 upload.txt</span><br><span class="line">drwx------    2 14       50              6 Aug 02 19:17 dir</span><br><span class="line">lftp 192.168.100.60:/pub&gt; mirror -R /test/  #上传目录以及目录中的子文件</span><br><span class="line">Total: 1 directory, 1 file, 0 symlinks</span><br><span class="line">New: 1 file, 0 symlinks</span><br><span class="line">lftp 192.168.100.60:/pub&gt; ls</span><br><span class="line">drwx------    2 14       50             23 Nov 16 12:18 test</span><br><span class="line">-rw-------    1 14       50              0 Nov 16 12:14 upload.txt</span><br><span class="line"></span><br><span class="line">mirror 下载目录</span><br><span class="line"><span class="meta">#</span><span class="bash">注意:进去ftp后使用的ls <span class="built_in">cd</span>命令不是我们centos的命令，而是lftp服务的命令，只是恰好名字一样。ftp用户是无权使用我们系统中的命令。</span></span><br></pre></td></tr></table></figure>

<h4 id="2-ftp配置本地用户登录"><a href="#2-ftp配置本地用户登录" class="headerlink" title="2.ftp配置本地用户登录"></a>2.ftp配置本地用户登录</h4><h5 id="2-1服务端操作"><a href="#2-1服务端操作" class="headerlink" title="2.1服务端操作"></a>2.1服务端操作</h5><p><strong>创建 zhangsan、lisi  密码都设置为 “123456”</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp-server ~]# useradd zhangsan </span><br><span class="line">[root@ftp-server ~]# useradd lisi</span><br><span class="line">[root@ftp-server ~]# echo '123456' | passwd --stdin  zhangsan  #设置密码</span><br><span class="line">Changing password for user zhangsan.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">[root@ftp-server ~]# echo '123456' | passwd --stdin  lisi </span><br><span class="line">Changing password for user lisi.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure>

<p><strong>配置本地用户ftp配置文件</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp-server ~]# vim /etc/vsftpd/vsftpd.conf  ---添加注释并修改 </span><br><span class="line">anonymous_enable=NO           #将允许匿名登录关闭</span><br><span class="line"><span class="meta">#</span><span class="bash">anon_umask=022                <span class="comment">#匿名用户所上传文件的权限掩码 </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">anon_upload_enable=YES        <span class="comment">#允许匿名用户上传文件</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">anon_mkdir_write_enable=YES   <span class="comment">#允许匿名用户创建目录</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">anon_other_write_enable=YES    <span class="comment">#是否允许匿名用户有其他写入权（改名，删除，覆盖）</span></span></span><br><span class="line">新添加</span><br><span class="line">local_root=/home/zhangsan       # 设置本地用户的FTP根目录，一般为用户的家目录</span><br><span class="line">local_max_rate=0                # 限制最大传输速率（字节/秒）0为无限制</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/5.png" class></strong></p>
<p><strong>重启vsftpd</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp-server ~]# systemctl restart vsftpd</span><br></pre></td></tr></table></figure>

<h5 id="2-2客户端操作"><a href="#2-2客户端操作" class="headerlink" title="2.2客户端操作"></a>2.2客户端操作</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp-client ~]# lftp 192.168.153.137 -u zhangsan</span><br><span class="line">Password: </span><br><span class="line">lftp zhangsan@192.168.153.137:~&gt; ls</span><br><span class="line">lftp zhangsan@192.168.153.137:~&gt; mkdir aaa</span><br><span class="line">mkdir ok, `aaa' created</span><br><span class="line">lftp zhangsan@192.168.153.137:~&gt; ls</span><br><span class="line">drwxr-xr-x    2 1000     1000            6 Aug 02 20:55 aaa</span><br><span class="line">lftp zhangsan@192.168.153.137:~&gt; put /root/test.txt </span><br><span class="line">lftp zhangsan@192.168.153.137:~&gt; ls</span><br><span class="line">drwxr-xr-x    2 1000     1000            6 Aug 02 20:55 aaa</span><br><span class="line">-rw-r--r--    1 1000     1000            0 Aug 02 20:59 test.txt</span><br><span class="line"></span><br><span class="line">服务器端查看</span><br><span class="line">[root@ftp-server ~]# cd /home/zhangsan/</span><br><span class="line">[root@ftp-server zhangsan]# ls</span><br><span class="line">aaa  test.txt</span><br><span class="line">[root@ftp-server zhangsan]# ll</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x. 2 zhangsan zhangsan 6 Aug  3 04:55 aaa</span><br><span class="line">-rw-r--r--. 1 zhangsan zhangsan 0 Aug  3 04:59 test.txt</span><br></pre></td></tr></table></figure>

<h2 id="3-系统优化检测常用命令"><a href="#3-系统优化检测常用命令" class="headerlink" title="3.系统优化检测常用命令"></a>3.系统优化检测常用命令</h2><p>*<em>知识点： *</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">（简介：系统优化其本质是系统在提供服务的同时，承受压力过大需进行参数调优）</span><br></pre></td></tr></table></figure>

<h3 id="1、查看平均负载"><a href="#1、查看平均负载" class="headerlink" title="1、查看平均负载"></a>1、查看平均负载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">系统负载System Load：系统CPU繁忙程度的度量，即有多少进程在等待被CPU调度,平均负载（Load Average）：一段时间内系统的平均负载，这个一段时间一般取1分钟、5分钟、15分钟</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@linux-server ~]# uptime</span><br><span class="line">20:42:26 up  6:12,  2 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">1分钟平均负载，5分钟平均负载，15分钟平均负载分别是0.00,0.01,0.05</span><br></pre></td></tr></table></figure>

<h3 id="2、释放buffer和cache"><a href="#2、释放buffer和cache" class="headerlink" title="2、释放buffer和cache"></a>2、释放buffer和cache</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@linux-server ~]# echo 3 &gt; /proc/sys/vm/drop_caches</span><br></pre></td></tr></table></figure>

<h3 id="3、带宽使用情况"><a href="#3、带宽使用情况" class="headerlink" title="3、带宽使用情况"></a>3、带宽使用情况</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@linux-server ~]# yum install -y iftop.x86_64</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/6.png" class></strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">第一行：界面上面显示的是类似刻度尺的刻度范围，为显示流量图形的长条作标尺用的。</span><br><span class="line">中间部分：中间的&lt;= =&gt;这两个左右箭头，表示的是流量的方向。=&gt;代表发送，&lt;=代表接收。</span><br><span class="line">TX：发送流量(transmit)</span><br><span class="line">RX：接收流量(receive)</span><br><span class="line">TOTAL：总流量</span><br><span class="line">Cum：运行iftop到目前时间的总流量</span><br><span class="line">peak：流量峰值</span><br><span class="line">rates：分别表示过去 2s 10s 40s 的平均流量</span><br></pre></td></tr></table></figure>

<h3 id="4、网络接口统计报告"><a href="#4、网络接口统计报告" class="headerlink" title="4、网络接口统计报告"></a>4、网络接口统计报告</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@linux-server ~]# yum install -y nethogs.x86_64</span><br><span class="line">[root@linux-server ~]# nethogs</span><br></pre></td></tr></table></figure>

<p><strong><img src="/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/7.png" class></strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> 实例1：监视ens33网络带宽 </span><br><span class="line"><span class="meta">#</span><span class="bash"> nethogs ens33 </span></span><br><span class="line">实例2：同时监视ens33和ens34接口 </span><br><span class="line"><span class="meta">#</span><span class="bash"> nethogs ens33 ens34</span></span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">L66</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://l66stbz.github.io/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/">https://l66stbz.github.io/2024/07/04/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://l66stbz.github.io" target="_blank">L66</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/NFS/">NFS</a><a class="post-meta__tags" href="/tags/FTP/">FTP</a></div><div class="post_share"><div class="social-share" data-image="https://l66stbz.github.io/2024/07/05/WEB服务器/4.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2024/07/05/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8/"><img class="prev_cover" src="https://l66stbz.github.io/2024/07/05/WEB服务器/4.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">WEB服务器</div></div></a></div><div class="next-post pull_right"><a href="/2024/07/03/%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><img class="next_cover" src="https://l66stbz.github.io/2024/07/03/存储管理/8.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux存储管理(lvm,swap,raid)</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2024/05/23/基础测试脚本题/" title="基础测试脚本题"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/23/基础测试脚本题/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-23</div><div class="relatedPosts_title">基础测试脚本题</div></div></a></div><div class="relatedPosts_item"><a href="/2024/07/05/WEB服务器/" title="WEB服务器"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/07/05/WEB服务器/4.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-07-05</div><div class="relatedPosts_title">WEB服务器</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/18/Zabbix监控Nginx指标/" title="Zabbix监控Nginx指标"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/18/Zabbix监控Nginx指标/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-18</div><div class="relatedPosts_title">Zabbix监控Nginx指标</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/21/Keepalived/" title="Keepalived"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/21/Keepalived/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-21</div><div class="relatedPosts_title">Keepalived</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/25/shell脚本相关问题/" title="shell脚本相关问题总结"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/25/shell脚本相关问题/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-25</div><div class="relatedPosts_title">shell脚本相关问题总结</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/17/zabbix部署/" title="zabbix部署"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/17/zabbix部署/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-17</div><div class="relatedPosts_title">zabbix部署</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By L66</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/third-party/click_heart.js"></script></body></html>