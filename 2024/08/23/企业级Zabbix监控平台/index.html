<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>企业级Zabbix监控平台 | L66</title><meta name="description" content="企业级Zabbix监控平台1、监控的意义 **保障业务稳定运行**：监控系统通过实时关注与业务相关的各项指标，确保服务器、网络设备等硬件资源的正常运行，从而保障公司线上业务的稳定性。  **及时发现和解决问题**：监控系统能够及时发现系统的异常和故障，通过告警管理迅速通知运维人员，以便尽快采取措施解决问题，减少潜在的损失。  数据收集与分析：监控系统可以收集系统运行的各种数据，如性能数据、日志信息"><meta name="keywords" content="Linux,Zabbix"><meta name="author" content="L66"><meta name="copyright" content="L66"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/3.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="企业级Zabbix监控平台"><meta name="twitter:description" content="企业级Zabbix监控平台1、监控的意义 **保障业务稳定运行**：监控系统通过实时关注与业务相关的各项指标，确保服务器、网络设备等硬件资源的正常运行，从而保障公司线上业务的稳定性。  **及时发现和解决问题**：监控系统能够及时发现系统的异常和故障，通过告警管理迅速通知运维人员，以便尽快采取措施解决问题，减少潜在的损失。  数据收集与分析：监控系统可以收集系统运行的各种数据，如性能数据、日志信息"><meta name="twitter:image" content="https://l66stbz.github.io/2024/08/23/企业级Zabbix监控平台/1.png"><meta property="og:type" content="article"><meta property="og:title" content="企业级Zabbix监控平台"><meta property="og:url" content="https://l66stbz.github.io/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"><meta property="og:site_name" content="L66"><meta property="og:description" content="企业级Zabbix监控平台1、监控的意义 **保障业务稳定运行**：监控系统通过实时关注与业务相关的各项指标，确保服务器、网络设备等硬件资源的正常运行，从而保障公司线上业务的稳定性。  **及时发现和解决问题**：监控系统能够及时发现系统的异常和故障，通过告警管理迅速通知运维人员，以便尽快采取措施解决问题，减少潜在的损失。  数据收集与分析：监控系统可以收集系统运行的各种数据，如性能数据、日志信息"><meta property="og:image" content="https://l66stbz.github.io/2024/08/23/企业级Zabbix监控平台/1.png"><meta property="article:published_time" content="2024-08-23T13:50:00.000Z"><meta property="article:modified_time" content="2024-08-31T02:20:06.629Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://l66stbz.github.io/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"><link rel="prev" title="Zabbix自定义监控脚本" href="https://l66stbz.github.io/2024/08/26/Zabbix%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC/"><link rel="next" title="企业自动化运维神器Ansible(2)" href="https://l66stbz.github.io/2024/08/21/%E4%BC%81%E4%B8%9A%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E7%A5%9E%E5%99%A8Ansible(2)/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="L66" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/2.jpg" onerror="onerror=null;src='/img/2.jpg'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">60</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">37</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/photo/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#企业级Zabbix监控平台"><span class="toc-number">1.</span> <span class="toc-text">企业级Zabbix监控平台</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、监控的意义"><span class="toc-number">1.1.</span> <span class="toc-text">1、监控的意义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、监控的对象"><span class="toc-number">1.2.</span> <span class="toc-text">2、监控的对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、常见监控软件：-夜莺监控-睿象云"><span class="toc-number">1.3.</span> <span class="toc-text">3、常见监控软件： 夜莺监控 睿象云</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、Zabbix应用手册"><span class="toc-number">1.4.</span> <span class="toc-text">4、Zabbix应用手册</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-Zabbix介绍"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 Zabbix介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-zabbix企业版选型"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">4.1.1 zabbix企业版选型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-zabbix架构图详解"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 zabbix架构图详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-zabbix-组件介绍"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">4.2.1 zabbix 组件介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-zabbix-进程介绍"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">4.2.2 zabbix 进程介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Zabbix-优点和不足"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 Zabbix 优点和不足</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-Zabbix功能"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 Zabbix功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-zabbix-监控数据流程"><span class="toc-number">1.4.5.</span> <span class="toc-text">4.5 zabbix 监控数据流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-1-Zabbix-核心概念"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">4.5.1 Zabbix 核心概念</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、Zabbix-常用监控架构"><span class="toc-number">1.4.6.</span> <span class="toc-text">5、Zabbix 常用监控架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、Zabbix-监控系统监控对象"><span class="toc-number">1.4.7.</span> <span class="toc-text">6、Zabbix 监控系统监控对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-Zabbix监控方式"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">6.1 Zabbix监控方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7、安装和配置-Zabbix-服务"><span class="toc-number">1.4.8.</span> <span class="toc-text">7、安装和配置 Zabbix 服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-实验准备"><span class="toc-number">1.4.8.1.</span> <span class="toc-text">7.1 实验准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-安装-Zabbix-server端"><span class="toc-number">1.4.8.2.</span> <span class="toc-text">7.2 安装 Zabbix-server端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-测试访问"><span class="toc-number">1.4.8.3.</span> <span class="toc-text">7.3 测试访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-zabbix-主机图形乱码解决"><span class="toc-number">1.4.8.4.</span> <span class="toc-text">7.4 zabbix 主机图形乱码解决</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8、配置文件详解"><span class="toc-number">1.4.9.</span> <span class="toc-text">8、配置文件详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9、zabbix-agent版本差异解释-了解"><span class="toc-number">1.4.10.</span> <span class="toc-text">9、zabbix agent版本差异解释(了解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10、监控任意主机"><span class="toc-number">1.4.11.</span> <span class="toc-text">10、监控任意主机</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-快速添加新的主机"><span class="toc-number">1.4.11.1.</span> <span class="toc-text">10.1 快速添加新的主机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11、主机群组使用"><span class="toc-number">1.4.12.</span> <span class="toc-text">11、主机群组使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12、自定义监控模版"><span class="toc-number">1.4.13.</span> <span class="toc-text">12、自定义监控模版</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-boot分区剩余容量监控"><span class="toc-number">1.4.13.1.</span> <span class="toc-text">12.1 boot分区剩余容量监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2-网卡出入流量监控"><span class="toc-number">1.4.13.2.</span> <span class="toc-text">12.2 网卡出入流量监控</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#12-2-1-ens33网卡进入流量监控"><span class="toc-number">1.4.13.2.1.</span> <span class="toc-text">12.2.1 ens33网卡进入流量监控</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-2-2-ens33网卡出去流量监控"><span class="toc-number">1.4.13.2.2.</span> <span class="toc-text">12.2.2 ens33网卡出去流量监控</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-监控服务端口"><span class="toc-number">1.4.13.3.</span> <span class="toc-text">12.3 监控服务端口</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#12-2-3监控网卡的上下流量总和"><span class="toc-number">1.4.13.3.1.</span> <span class="toc-text">12.2.3监控网卡的上下流量总和</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-4-监控系统进程数量"><span class="toc-number">1.4.13.4.</span> <span class="toc-text">12.4 监控系统进程数量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-监控cpu的状态"><span class="toc-number">1.4.13.5.</span> <span class="toc-text">12.5 监控cpu的状态</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13、自定义监控设置-Items"><span class="toc-number">1.4.14.</span> <span class="toc-text">13、自定义监控设置(Items)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-自定义监控项编写"><span class="toc-number">1.4.14.1.</span> <span class="toc-text">13.1 自定义监控项编写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-2-获取不到内容报错解决"><span class="toc-number">1.4.14.2.</span> <span class="toc-text">13.2 获取不到内容报错解决</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-3-使用脚本定义自定义监控项"><span class="toc-number">1.4.14.3.</span> <span class="toc-text">13.3 使用脚本定义自定义监控项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14、-自定义图形"><span class="toc-number">1.4.15.</span> <span class="toc-text">14、 自定义图形</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#14-1-自定义单个监控项图形"><span class="toc-number">1.4.15.1.</span> <span class="toc-text">14.1 自定义单个监控项图形</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-2-仪表盘创建-聚合图形"><span class="toc-number">1.4.15.2.</span> <span class="toc-text">14.2 仪表盘创建(聚合图形)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15、触发器器设置-Triggers-P0级服务"><span class="toc-number">1.4.16.</span> <span class="toc-text">15、触发器器设置( Triggers)  P0级服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#15-1-触发器介绍"><span class="toc-number">1.4.16.1.</span> <span class="toc-text">15.1 触发器介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-2-触发器严重性"><span class="toc-number">1.4.16.2.</span> <span class="toc-text">15.2 触发器严重性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-3-配置触发器"><span class="toc-number">1.4.16.3.</span> <span class="toc-text">15.3 配置触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#15-3-1-触发器示例一：web服务端口"><span class="toc-number">1.4.16.3.1.</span> <span class="toc-text">15.3.1 触发器示例一：web服务端口</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#15-3-2-触发器示例二：cpu-1分钟负载"><span class="toc-number">1.4.16.3.2.</span> <span class="toc-text">15.3.2 触发器示例二：cpu 1分钟负载</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-4-触发器常用表达式功能函数介绍"><span class="toc-number">1.4.16.4.</span> <span class="toc-text">15.4 触发器常用表达式功能函数介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16、zabbix监控模版"><span class="toc-number">1.4.17.</span> <span class="toc-text">16、zabbix监控模版</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#16-1-zabbix-server自带模版"><span class="toc-number">1.4.17.1.</span> <span class="toc-text">16.1 zabbix server自带模版</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17、触发器-Action"><span class="toc-number">1.4.18.</span> <span class="toc-text">17、触发器 Action</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#17-1-Action-动作介绍"><span class="toc-number">1.4.18.1.</span> <span class="toc-text">17.1 Action 动作介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-2-告警分类"><span class="toc-number">1.4.18.2.</span> <span class="toc-text">17.2 告警分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-2-邮箱告警"><span class="toc-number">1.4.18.3.</span> <span class="toc-text">17.2 邮箱告警</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-3-飞书告警"><span class="toc-number">1.4.18.4.</span> <span class="toc-text">17.3 飞书告警</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-4-zabbix-基于ssh远程执行故障恢复操作"><span class="toc-number">1.4.19.</span> <span class="toc-text">17.4 zabbix 基于ssh远程执行故障恢复操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18、宏"><span class="toc-number">1.4.20.</span> <span class="toc-text">18、宏</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#18-1-介绍"><span class="toc-number">1.4.20.1.</span> <span class="toc-text">18.1 介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-2-设置优先级"><span class="toc-number">1.4.20.2.</span> <span class="toc-text">18.2 设置优先级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-3-作用及场景"><span class="toc-number">1.4.20.3.</span> <span class="toc-text">18.3 作用及场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-4-宏设置"><span class="toc-number">1.4.20.4.</span> <span class="toc-text">18.4 宏设置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19、zabbix-自动发现"><span class="toc-number">1.4.21.</span> <span class="toc-text">19、zabbix 自动发现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20、zabbix自动注册"><span class="toc-number">1.4.22.</span> <span class="toc-text">20、zabbix自动注册</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#20-1-zabbix自动注册介绍"><span class="toc-number">1.4.22.1.</span> <span class="toc-text">20.1 zabbix自动注册介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#20-2-zabbix自动注册操作"><span class="toc-number">1.4.22.2.</span> <span class="toc-text">20.2 zabbix自动注册操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21、Zabbix-系列之分布式监控-Proxy-代理"><span class="toc-number">1.4.23.</span> <span class="toc-text">21、Zabbix 系列之分布式监控 Proxy 代理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#21-1-介绍"><span class="toc-number">1.4.23.1.</span> <span class="toc-text">21.1 介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#21-2-应用场景"><span class="toc-number">1.4.23.2.</span> <span class="toc-text">21.2 应用场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#21-3-Zabbix-Proxy-必须使用单独的数据库的原因"><span class="toc-number">1.4.23.3.</span> <span class="toc-text">21.3 Zabbix Proxy 必须使用单独的数据库的原因</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#21-4-安装"><span class="toc-number">1.4.23.4.</span> <span class="toc-text">21.4 安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zabbix-agent2配置"><span class="toc-number">1.4.23.5.</span> <span class="toc-text">zabbix-agent2配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22、zabbix优化方案"><span class="toc-number">1.4.24.</span> <span class="toc-text">22、zabbix优化方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23、zabbix结合Grafana实现图形展示"><span class="toc-number">1.4.25.</span> <span class="toc-text">23、zabbix结合Grafana实现图形展示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#"><span class="toc-number">1.4.25.0.1.</span> <span class="toc-text"></span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://l66stbz.github.io/2024/08/23/企业级Zabbix监控平台/1.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">L66</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/photo/"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">企业级Zabbix监控平台</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2024-08-23 21:50:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2024-08-23</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2024-08-31 10:20:06"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2024-08-31</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="企业级Zabbix监控平台"><a href="#企业级Zabbix监控平台" class="headerlink" title="企业级Zabbix监控平台"></a>企业级Zabbix监控平台</h1><h2 id="1、监控的意义"><a href="#1、监控的意义" class="headerlink" title="1、监控的意义"></a>1、监控的意义</h2><ol>
<li><p><code>**保障业务稳定运行**</code>：监控系统通过实时关注与业务相关的<code>各项指标</code>，确保服务器、网络设备等硬件资源的正常运行，从而保障公司线上业务的稳定性。</p>
</li>
<li><p><code>**及时发现和解决问题**</code>：监控系统能够及时发现系统的异常和故障，通过<code>告警</code>管理迅速通知运维人员，以便尽快采取措施解决问题，减少潜在的损失。</p>
</li>
<li><p><strong>数据收集与分析</strong>：监控系统可以收集系统运行的各种数据，如性能数据、日志信息等，通过数据分析帮助管理者更好地理解系统运行状况，优化系统性能。</p>
</li>
<li><p><code>**预防故障**</code>：除了发现和解决已经发生的故障，监控系统还能够通过<code>历史数据</code>分析预测潜在的问题，提前采取预防措施，避免故障发生。</p>
</li>
</ol>
<h2 id="2、监控的对象"><a href="#2、监控的对象" class="headerlink" title="2、监控的对象"></a>2、监控的对象</h2><p>通常情况下，我们可以将监控对象这么来分：</p>
<ol>
<li><p><strong>服务器监控</strong>：主要监控服务器如：CPU 负载、内存使用率、磁盘使用率、登陆用户数、进程状态、网卡状态等。</p>
</li>
<li><p><strong>应用程序监控</strong>：主要监控该应用程序的服务状态，吞吐率和响应时间，因为不同应用需要监控的对象不同，这里不一一列举。</p>
</li>
<li><p><strong>数据库监控</strong>：只所以把数据库监控单独列出来，足以说明它的重要性，一般监控数据库状态，数据库表或者表空间的使用情况，是否有死锁，错误日志，性能信息等等。</p>
</li>
<li><p><strong>网络监控</strong>：主要监控当前的网络状况，网络流量，端口，连接等。</p>
</li>
</ol>
<p>举例：</p>
<p><strong>Nginx监控</strong>：Zabbix可以收集包括活跃连接数（active connections）、已接受的连接数（accepts）、已处理的请求总数（handled requests）等在内的关键性能指标。这些数据可以通过自定义脚本使用<code>awk</code>等工具从Nginx状态页中提取出来。</p>
<h2 id="3、常见监控软件：-夜莺监控-睿象云"><a href="#3、常见监控软件：-夜莺监控-睿象云" class="headerlink" title="3、常见监控软件： 夜莺监控 睿象云"></a>3、常见监控软件： 夜莺监控 睿象云</h2><ol>
<li><p>Nagios：Nagios是一款开源的监控工具，主要用于监控系统和网络的运行状态，它可以通过多种插件来监控不同的服务和应用。Nagios的特点是轻量级，配置复杂，但是功能强大。<br><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/image-20240425111948184.png" alt="img"> </p>
</li>
<li><p>Zabbix：Zabbix是一款更加强大的监控工具，它不仅可以监控系统和应用的运行状态，还可以进行分布式监控、容器监控、网络监控等。Zabbix的特点是功能强大，界面友好，同时支持多种插件和自定义脚本。 MySQL zabbix-proxy<br><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425112701820.png" alt="img"> </p>
</li>
<li><p>Prometheus：Prometheus是一款开源的监控和报警系统，它将所有监控数据保存为时间序列数据，并对这些数据进行高效的查询和聚合。Prometheus的特点是数据模型简单，强大的查询语言，以及可通过Pull模式获取监控数据。  grfana</p>
</li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20230524135314127.png" alt="img"></p>
<h2 id="4、Zabbix应用手册"><a href="#4、Zabbix应用手册" class="headerlink" title="4、Zabbix应用手册"></a>4、Zabbix应用手册</h2><h3 id="4-1-Zabbix介绍"><a href="#4-1-Zabbix介绍" class="headerlink" title="4.1 Zabbix介绍"></a>4.1 Zabbix介绍</h3><p>zabbix官方网站：<a href="https://www.zabbix.com/" target="_blank" rel="noopener">https://www.zabbix.com/</a></p>
<p>Zabbix是一款开源的监控软件，用于监控各种网络参数、服务器的健康状况以及应用程序的状态。它能够提供灵活的通知机制，允许用户在问题发生时立即得到通知</p>
<ol>
<li><p><code>**分布式监控**</code>：Zabbix支持<code>分布式监控</code>，可以轻松地从一台主机监控远程主机和服务。</p>
</li>
<li><p><code>**实时数据收集**</code>：Zabbix提供了<code>实时数据收集</code>和图形展示功能，使管理员能够快速了解系统状态并及时响应问题。</p>
</li>
<li><p><strong>灵活的告警机制</strong>：Zabbix具有灵活的告警机制，可以根据预设的条件触发告警，并通过多种方式（如邮件、短信）通知管理员。</p>
</li>
<li><p><code>**自动发现**</code>：Zabbix支持自动发现功能，可以自动检测网络中的设备和服务，简化了配置过程。</p>
</li>
<li><p><strong>模板化管理</strong>：Zabbix使用模板来简化监控项的配置，只需将模板应用于特定的主机或服务，就可以实现对多个对象的统一监控。</p>
</li>
<li><p><code>**Web界面**</code>：Zabbix提供了一个直观的Web界面，使管理员能够轻松查看监控数据、配置告警和管理系统设置。</p>
</li>
<li><p><strong>Agent和Agentless监控</strong>：Zabbix支持基于Agent的监控和无Agent的监控。基于Agent的监控需要在被监控的主机上安装Zabbix Agent，而无Agent的监控则通过SNMP、IPMI等协议收集数据。</p>
</li>
<li><p><strong>历史数据存储</strong>：Zabbix可以将历史数据存储在数据库中，以便进行长期趋势分析和报告生成。</p>
</li>
<li><p><code>**权限管理**</code>：Zabbix具有强大的权限管理功能，可以定义不同角色的用户，并赋予他们对特定资源的访问权限。</p>
</li>
</ol>
<h4 id="4-1-1-zabbix企业版选型"><a href="#4-1-1-zabbix企业版选型" class="headerlink" title="4.1.1 zabbix企业版选型"></a>4.1.1 zabbix企业版选型</h4><p>网站：<a href="https://www.zabbix.com/cn/life_cycle_and_release_policy" target="_blank" rel="noopener">Zabbix产品周期&amp;发布日志</a></p>
<p><strong>Zabbix LTS （长期支持版本）的生命周期</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/life_cycle_of_zabbix_lts_release.png" alt="img"></p>
<p><strong>Zabbix标准版本的生命周期</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/life_cycle_standard_release.svg" alt="img"></p>
<h3 id="4-2-zabbix架构图详解"><a href="#4-2-zabbix架构图详解" class="headerlink" title="4.2 zabbix架构图详解"></a>4.2 zabbix架构图详解</h3><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240424095830180.png" alt="img"></p>
<p><code>zabbix</code>是一个典型的C/S（客户端/服务端）架构。</p>
<p><strong>监控大致流程：</strong>zabbix-agent(客户端)获取监控数据，zabbix_server端(服务端)索要数据，然后数据会被存放至数据库，zabbix web展示所收集的监控数据。</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425145214990.png" alt="img"></p>
<h4 id="4-2-1-zabbix-组件介绍"><a href="#4-2-1-zabbix-组件介绍" class="headerlink" title="4.2.1 zabbix 组件介绍"></a>4.2.1 zabbix 组件介绍</h4><ul>
<li><p><strong>Zabbix Server</strong>：Zabbix Server 是 Zabbix 的核心组件，是所有配置信息、统计信息和操作数据的核心存储器。 它主要负责接收客户端发送的报告和信息，同时，所有配置、统计数据及配置操作数据均由其组织进行。</p>
</li>
<li><p><strong>Zabbix Database Storage</strong>：主要用于存储数据，所有配置信息和 Zabbix 收集到的数据都被存储在数据库中。常用的存储设备有 MySQL、Oracle 等。</p>
</li>
<li><p><strong>Zabbix Web 界面：</strong>这是 Zabbix 提供的 GUI 接口，通常（但不一定）与 Zabbix Server 运行在同一台物理机器上。</p>
</li>
<li><p><strong>Zabbix Proxy 代理服务器：</strong>这是一个可选组件，常用于分布监控环境中，代理 Server 可以替 Zabbix Server 收集性能和可用性数据，汇总后统一发往 Zabbix Server 端。</p>
</li>
<li><p><strong>Zabbix Agent 监控代理：</strong> Zabbix Agent 部署在被监控主机上，能够主动监控本地资源和应用程序，并负责收集数据发往 Zabbix Server 端或 Zabbix Proxy 端。从 zabbix 5 版本开始，zabbix_agent 分为 zabbix_agent 和 zabbix_agent2，zabbix_agent2 是第二个 agent 版本，功能更加强大，采用 go 语言编写，支持 zabbix_agent 所有功能。使用 zabbix_agent2 可监控 docker 容器、ceph、mysql、oracle、 redis等。</p>
</li>
</ul>
<h4 id="4-2-2-zabbix-进程介绍"><a href="#4-2-2-zabbix-进程介绍" class="headerlink" title="4.2.2 zabbix 进程介绍"></a>4.2.2 zabbix 进程介绍</h4><p>​    根据功能和用途，默认情况下 zabbix 包含 5 个进程，分别是 zabbix_agentd/zabbix_agent2、zabbix_get、zabbix_proxy、zabbix_sender、zabbix_server，另外还有一个 zabbix_java_gateway 是可选的功能，需要另外安装。下面分别介绍下它们各自的作用。</p>
<ul>
<li><p><code>**zabbix_agentd/zabbix_agent2**</code>： zabbix_agentd/agent2 是 Zabbix Agent 监控代理端守护进程，此进程收集客户端数据，例如cpu 负载、内存、硬盘、网络使用情况等，推荐使用 zabbix_agent2。</p>
</li>
<li><p><code>**zabbix_get**</code>： zabbix 提供的一个工具，通常在 Zabbix server 或者 Zabbix proxy 端执行用来获取远程客户端信息，这其实是 Zabbix server 去 Zabbix Agent 端拉取数据的过程，此工具主要用来进行用户排错。例如在 Zabbix server 端获取不到客户端的监控数据时，可以使用 zabbix_get 命令测试获取客户端数据来做故障排查。</p>
</li>
<li><p><strong>zabbix_sender：</strong>zabbix 提供的一个工具，用于发送数据给 Zabbix server 或者 Zabbix proxy，这其实是 Zabbix Agent 端主动推送监控数据到 Zabbix Server 端的过程，通常用于耗时比较长的检查或者有大量主机（千台以上）需要监控的场景。此时通过主动推送数据到 Zabbix server，可以在很大程度上减轻 Zabbix server 的压力和负载。</p>
</li>
<li><p><strong>zabbix_proxy：</strong>Zabbix Proxy 的代理守护进程。功能类似 Zabbix server，唯一不同的是它只是一个中转站，它需要把收集到的数据提交或者被提交到 Zabbix server上。</p>
</li>
<li><p><strong>zabbix_java_gateway</strong>：Zabbix 2.0 之后引入的一个功能。顾名思义：Java 网关，主要用来监控 JAVA 应用环境，类似 zabbix_agentd 进程。需要特别注意的是，它只能主动去推送数据，而不能等待 zabbix server或者 zabbix proxy 来拉取数据。它的数据最终会给到 zabbix server 或者 zabbix proxy 上。</p>
</li>
<li><p><code>**zabbix_server**</code><strong>：</strong>Zabbix server 是整个 Zabbix 系统的核心进程。其它进程 zabbix_agentd、zabbix_get、zabbix_sender、zabbix_proxy、zabbix_java_gateway 的数据最终都是提交到 Zabbix server 来统一进行处理。</p>
</li>
<li><p><strong>zabbix web service：</strong>Zabbix web service 是一个用来连接外部网站服务的进程。</p>
</li>
</ul>
<h3 id="4-3-Zabbix-优点和不足"><a href="#4-3-Zabbix-优点和不足" class="headerlink" title="4.3 Zabbix 优点和不足"></a>4.3 Zabbix 优点和不足</h3><p><strong>优点：</strong></p>
<ol>
<li><p><strong>开源性</strong>：Zabbix作为一个开源工具，意味着用户可以免费使用，并且拥有对软件进行二次开发的灵活性。</p>
</li>
<li><p><strong>数据采集能力</strong>：它支持多种数据收集方式，包括agent、SNMP、JMX和telnet等，还支持主动和被动模式的数据传输。用户还可以自定义插件来收集数据，这提供了高度的灵活性和适应性。</p>
</li>
<li><p><strong>高可用性</strong>：Zabbix server对设备性能要求低，支持proxy分布式监控，这使得它能够适应不同规模和需求的监控环境。</p>
</li>
<li><p><strong>监控能力</strong>：Zabbix能够监控各种网络参数，并提供灵活的通知机制，帮助运维人员快速定位并解决存在的问题。</p>
</li>
<li><p><strong>模板丰富</strong>：Zabbix自带多种监控模板，这简化了新设备的监控配置过程，加快了部署速度。</p>
</li>
<li><p><strong>自动发现与全面监控</strong>：Zabbix支持自动发现网络中的设备和服务，这减少了手动配置的工作量，并确保了监控覆盖的全面性。</p>
</li>
<li><p><strong>报警处理</strong>：它可以针对报警默认进行固定操作，减少人为操作失误的风险，同时降低人员成本。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**缺点：**</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>性能瓶颈</strong>：当机器数量增加时，数据量的增大会导致数据库写入成为瓶颈。Zabbix官方指出单机上限为5000台设备，超过这个数量就需要增加proxy来分担负载</p>
</li>
<li><p><strong>数据延迟问题</strong>：在采用主动模式即server pull方式采集数据时，如果目标机器数量庞大，则可能出现任务积压和数据延迟的问题。</p>
</li>
<li><p><strong>数据库压力</strong>：所有数据都存在数据库里, 产生的数据据很大,瓶颈主要在数据库。</p>
</li>
</ul>
<h3 id="4-4-Zabbix功能"><a href="#4-4-Zabbix功能" class="headerlink" title="4.4 Zabbix功能"></a>4.4 Zabbix功能</h3><p><a href="https://www.zabbix.com/documentation/5.0/manual/config/items" target="_blank" rel="noopener"><strong>数据采集</strong></a></p>
<ul>
<li><p>可用性和性能采集；</p>
</li>
<li><p>支持 SNMP（包括主动轮询和被动捕获）、IPMI、JMX、VMware 监控；</p>
</li>
<li><p>自定义检查；</p>
</li>
<li><p>按照自定义的时间间隔采集需要的数据；</p>
</li>
<li><p>通过 Server/Proxy 和 Agents 来执行数据采集。</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/triggers" target="_blank" rel="noopener"><strong>灵活的阈值定义</strong></a></p>
<ul>
<li>您可以定义非常灵活的告警阈值，称之为触发器，触发器从后端数据库获得参考值。</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/notifications" target="_blank" rel="noopener"><strong>高度可配置化的告警</strong></a></p>
<ul>
<li><p>可以根据递增计划、接收者、媒介类型自定义发送告警通知；</p>
</li>
<li><p>使用宏变量可以使告警通知变得更加高效有益；</p>
</li>
<li><p>自动动作包含远程命令。</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/visualization/graphs/simple" target="_blank" rel="noopener"><strong>实时图形</strong></a></p>
<ul>
<li>使用内置图形功能可实以将监控项绘制成图形。</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/web_monitoring" target="_blank" rel="noopener"><strong>Web 监控功能</strong></a></p>
<ul>
<li>Zabbix 可以追踪模拟鼠标在 Web 网站上的点击操作，来检查 Web 网站的功能和响应时间。</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/visualization" target="_blank" rel="noopener"><strong>丰富的可视化选项</strong></a></p>
<ul>
<li>能够创建可以将多个监控项组合到单个视图中的自定义图形；</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/installation/requirements#database_size" target="_blank" rel="noopener"><strong>历史数据存储</strong></a></p>
<ul>
<li><p>存储在数据库中的数据；</p>
</li>
<li><p>可配置的历史数据；</p>
</li>
<li><p>内置数据管理机制（housekeeping）。</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/hosts" target="_blank" rel="noopener"><strong>配置简单</strong></a></p>
<ul>
<li><p>将被监控设备添加为主机；</p>
</li>
<li><p>主机一旦添加到数据库中，就会采集主机数据用于监控；</p>
</li>
<li><p>将模板用于监控设备。</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/templates" target="_blank" rel="noopener"><strong>套用模板</strong></a></p>
<ul>
<li><p>在模板中分组检查；</p>
</li>
<li><p>模板可以关联其他模板，获得继承。</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/discovery" target="_blank" rel="noopener"><strong>网络发现</strong></a></p>
<ul>
<li><p>自动发现网络设备；</p>
</li>
<li><p>Zabbix Agent 发现设备后自动注册；</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/web_interface" target="_blank" rel="noopener"><strong>快捷的 Web 界面</strong></a></p>
<ul>
<li><p>基于 PHP 的 Web 前端；</p>
</li>
<li><p>可以从任何地方访问；</p>
</li>
<li><p>您可以定制自己的操作方式；</p>
</li>
<li><p>审计日志。</p>
</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/api" target="_blank" rel="noopener"><strong>Zabbix API</strong></a></p>
<ul>
<li>Zabbix API 为 Zabbix 提供可编程接口，用于批量操作、第三方软件集成和其他用途。</li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/distributed_monitoring" target="_blank" rel="noopener"><strong>适应更复杂的环境</strong></a></p>
<ul>
<li>使用 Zabbix Proxy 代理，可以轻松实现分布式远程监控。</li>
</ul>
<h3 id="4-5-zabbix-监控数据流程"><a href="#4-5-zabbix-监控数据流程" class="headerlink" title="4.5 zabbix 监控数据流程"></a>4.5 zabbix 监控数据流程</h3><p>​    首先，为了创建一个采集数据的<code>监控项</code>，您就必须先<code>创建主机</code>。其次，必须有一个监控项，然后创建触发器。最后，您必须有一个触发器来触发一个动作，这几个点构成了一个完整的数据流。因此，如果您想要收到 CPU load it too high on <em>Server X</em> 的告警，您必须首先为 <em>Server X</em> 创建一个主机条目，其次创建一个用于监视其 CPU 的监控项，最后创建一个触发器，用来触发 CPU is too high 这个动作，并将其发送到您的邮箱里。虽然这些步骤看起来很繁琐，但是使用模板的话，其实并不复杂。也正是由于这种设计，使得 Zabbix 的配置变得更加灵活易用。</p>
<h4 id="4-5-1-Zabbix-核心概念"><a href="#4-5-1-Zabbix-核心概念" class="headerlink" title="4.5.1 Zabbix 核心概念"></a>4.5.1 Zabbix 核心概念</h4><p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/1593259517290.png%23id=cpWNQ&originHeight=530&originWidth=786&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt="img"></p>
<p><strong>主机（host）</strong></p>
<p>你想要监控的联网设备，有IP/DNS。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/hosts" target="_blank" rel="noopener"><strong><em>主机组（host group)</em></strong></a></p>
<p>主机的逻辑组；可能包含主机和模板。一个主机组里的主机和模板之间并没有任何直接的关联。通常在给不同用户组的主机分配权限时候使用主机组。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/items" target="_blank" rel="noopener"><strong><em>监控项（item）</em></strong></a></p>
<p>你想要接收的主机的特定数据，一个度量/指标数据。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/items/item#item_value_preprocessing" target="_blank" rel="noopener"><strong><em>值预处理（value preprocessing）</em></strong></a></p>
<p>转化/预处理接收到的指标数据* 存入数据库之前</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/triggers" target="_blank" rel="noopener">触发器（trigger）</a></p>
<p>一个被用于定义问题阈值和“评估”监控项接收到的数据的逻辑表达式</p>
<p>当接收到的数据高于阈值时，触发器从“OK”变成“Problem”状态。当接收到的数据低于阈值时，触发器保留/返回“OK”的状态。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/events" target="_blank" rel="noopener"><strong><em>事件（event）</em></strong></a></p>
<p>一次发生的需要注意的事情，例如触发器状态改变、发现/监控代理自动注册</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/triggers/event_tags" target="_blank" rel="noopener"><strong><em>事件标签（event tag）</em></strong></a></p>
<p>提前设置的事件标记*可以被用于事件关联，权限细化设置等。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/event_correlation" target="_blank" rel="noopener"><strong><em>事件关联（event correlation）</em></strong></a></p>
<p>自动灵活的、精确的关联问题和解决方案</p>
<p>比如说，你可以定义触发器A告警的异常可以由触发器B解决，触发器B可能采用完全不同的数据采集方式。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/web_interface/frontend_sections/monitoring/problems" target="_blank" rel="noopener"><strong><em>异常（problems）</em></strong></a></p>
<p>一个处在“异常”状态的触发器</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/acknowledges#updating_problems" target="_blank" rel="noopener"><strong><em>异常更新（problem update）</em></strong></a></p>
<p>Zabbix提供的问题管理选项，例如添加评论、确认异常、改变问题级别或者手动关闭等。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/notifications/action" target="_blank" rel="noopener"><strong><em>动作（action）</em></strong></a></p>
<p>预先定义的应对事件的操作</p>
<p>一个动作由操作(例如发出通知)和条件(什么时间进行操作)组成</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/notifications/action/escalations" target="_blank" rel="noopener"><strong><em>升级（escalation）</em></strong></a></p>
<p>一个在动作内执行操作的自定义方式; 发送通知/执行远程命令的顺序安排。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/notifications/media" target="_blank" rel="noopener"><strong><em>报警媒介（media）</em></strong></a></p>
<p>发送告警通知的方式；传送途径</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/notifications/action/operation/message" target="_blank" rel="noopener"><strong><em>通知（notification）</em></strong></a></p>
<p>关于事件的信心，将通过选设定的媒介途径发送给用户。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/notifications/action/operation/remote_command" target="_blank" rel="noopener"><strong><em>远程命令（remote command）</em></strong></a></p>
<p>一个预定义好的，满足特定条件的情况下，可以在被监控主机上自动执行的命令。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/templates" target="_blank" rel="noopener"><strong><em>模版（template）</em></strong></a></p>
<p>一组可以被应用到一个或多个主机上的实体（监控项，触发器，图形，聚合图形，应用，LLD，Web场景）的集合</p>
<p>模版的应用使得主机上的监控任务部署快捷方便；也可以使监控任务的批量修改更加简单。模版是直接关联到每台单独的主机上。</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/config/items/applications" target="_blank" rel="noopener"><strong><em>应用（application）</em></strong></a></p>
<p>一组监控项组成的逻辑分组</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/web_monitoring" target="_blank" rel="noopener"><strong><em>Web场景（web scenario）</em></strong></a></p>
<p>检查网站可浏览性的一个或多个HTTP请求</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/introduction/overview#architecture" target="_blank" rel="noopener"><strong><em>前端（frontend)</em></strong></a></p>
<p>Zabbix提供的web界面</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/api" target="_blank" rel="noopener"><strong><em>Zabbix API</em></strong></a></p>
<ul>
<li><em>Zabbix API允许用户使用JSON RPC协议来创建、更新和获取Zabbix对象（如主机、监控项、图形和其他）信息或者执行任何其他的自定义的任务</em></li>
</ul>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/concepts/server" target="_blank" rel="noopener"><strong><em>Zabbix server</em></strong></a></p>
<p>Zabbix监控的核心程序，主要功能是与Zabbix proxies和Agents进行交互、触发器计算、发送告警通知；并将数据集中保存等</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/concepts/agent" target="_blank" rel="noopener"><strong><em>Zabbix agent</em></strong></a></p>
<p>部署在监控对象上的，能够主动监控本地资源和应用的程序</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/concepts/proxy" target="_blank" rel="noopener"><strong><em>Zabbix proxy</em></strong></a></p>
<p>一个帮助Zabbix Server收集数据，分担Zabbix Server的负载的程序</p>
<p><a href="https://www.zabbix.com/documentation/5.0/manual/encryption" target="_blank" rel="noopener"><strong><em>加密（encryption）</em></strong></a></p>
<p>支持Zabbix组建之间的加密通讯(server, proxy, agent, zabbix_sender 和 zabbix_get 程序)使用TLS（Transport Layer Security ）协议。</p>
<h3 id="5、Zabbix-常用监控架构"><a href="#5、Zabbix-常用监控架构" class="headerlink" title="5、Zabbix 常用监控架构"></a>5、Zabbix 常用监控架构</h3><ol>
<li>分布式监控 (企业常用) server-proxy-agent</li>
</ol>
<p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/image-20210609232741617.png%23id=VOMdd&originHeight=763&originWidth=837&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt="img"></p>
<ol>
<li>server-anget(点对点监控)</li>
</ol>
<p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/image-20210609232940841.png%23id=xN38z&originHeight=599&originWidth=1033&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt="img"></p>
<p><strong>监控报警流程图：</strong></p>
<p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/1593259525914.png%23id=BFcJX&originHeight=397&originWidth=719&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=" alt="img"></p>
<h3 id="6、Zabbix-监控系统监控对象"><a href="#6、Zabbix-监控系统监控对象" class="headerlink" title="6、Zabbix 监控系统监控对象"></a>6、Zabbix 监控系统监控对象</h3><ul>
<li><p>数据库：  MySQL,MariaDB,Oracle,SQL Server    agent</p>
</li>
<li><p>应用软件：Nginx,Apache,PHP,Tomcat           agent</p>
</li>
</ul>
<hr>
<ul>
<li><p>集群：    LVS,Keepalived,HAproxy,RHCS,F5     agent</p>
</li>
<li><p>虚拟化：  VMware,KVM,XEN ,docker,k8s        agent</p>
</li>
<li><p>操作系统：Linux,Unix,Windows性能参数       agent</p>
</li>
</ul>
<hr>
<ul>
<li><p>硬件： 服务器，存储，网络设备                IPMI</p>
</li>
<li><p>网络： 网络环境（内网环境，外网环境）        SNMP</p>
</li>
</ul>
<hr>
<h4 id="6-1-Zabbix监控方式"><a href="#6-1-Zabbix监控方式" class="headerlink" title="6.1 Zabbix监控方式"></a>6.1 Zabbix监控方式</h4><p><strong>被动模式</strong></p>
<ul>
<li>被动检测： <strong>server向agent请求获取配置的各监控项相关的数据</strong>，agent接收请求、获取数据并响应给server； 适合对时效性要求较高的监控项，因为服务器可以随时请求数据。  </li>
</ul>
<p><strong>主动模式</strong></p>
<ul>
<li>主动检测：<strong>agent向server请求与自己相关监控项配置</strong>，主动地将server配置的监控项相关的数据发送给server； 减少Zabbix服务器的负载，特别是在大量监控项时，避免了服务器对每个监控项进行轮询。主动监控能极大节约监控server的资源。</li>
</ul>
<h3 id="7、安装和配置-Zabbix-服务"><a href="#7、安装和配置-Zabbix-服务" class="headerlink" title="7、安装和配置 Zabbix 服务"></a>7、安装和配置 Zabbix 服务</h3><p>服务器配置要求：<a href="https://www.zabbix.com/documentation/6.0/zh/manual/installation/requirements" target="_blank" rel="noopener">2 安装要求 (zabbix.com)</a></p>
<h4 id="7-1-实验准备"><a href="#7-1-实验准备" class="headerlink" title="7.1 实验准备"></a>7.1 实验准备</h4><p>Centos7.9 系统服务器3台、 一台作为监控服务器， 两台台作为被监控节点， 配置好yum源、 防火墙关闭、 各节点时钟服务同步、 各节点之间可以通过主机名互相通信。</p>
<p><strong>1. 所有机器关闭防火墙和selinux</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ setenforing 0 </span><br><span class="line">$ sed -i <span class="string">'s/SELINUX=enforcing/SELINUX=disabled/'</span> /etc/selinux/config </span><br><span class="line">$ systemctl <span class="built_in">disable</span> --now firewalld.service</span><br></pre></td></tr></table></figure>



<p><strong>2. 根据架构图，实验基本设置如下：</strong></p>
<table>
<thead>
<tr>
<th>机器名称</th>
<th>IP配置</th>
<th>服务角色</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>zabbix-server</td>
<td>192.168.153.147</td>
<td>zabbix-server</td>
<td>开启</td>
</tr>
<tr>
<td>zabbix-node1</td>
<td>192.168.153.178</td>
<td>zabbix-agent-node1</td>
<td>开启</td>
</tr>
<tr>
<td>zabbix-node2</td>
<td>192.168.153.179</td>
<td>zabbix-agent-node2</td>
<td>开启</td>
</tr>
</tbody></table>
<h4 id="7-2-安装-Zabbix-server端"><a href="#7-2-安装-Zabbix-server端" class="headerlink" title="7.2 安装 Zabbix-server端"></a>7.2 安装 Zabbix-server端</h4><p><strong>安装NGINX</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装nginx</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># vim /etc/yum.repos.d/nginx.repo</span></span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/<span class="variable">$releasever</span>/<span class="variable">$basearch</span>/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y nginx</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl enable --now nginx</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl status nginx</span></span><br></pre></td></tr></table></figure>



<p><strong>安装PHP</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装epel源</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># wget -O /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装webtatic 扩展源，安装PHP服务时需要</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y https://mirror.webtatic.com/yum/el7/epel-release.rpm</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装PHP服务</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install php72w-cli php72w-fpm php72w-gd php72w-mbstring php72w-bcmath php72w-xml php72w-ldap php72w-mysqlnd -y</span></span><br></pre></td></tr></table></figure>



<p><strong>修改nginx配置文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]<span class="comment"># vim /etc/nginx/conf.d/zabbix.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  root /app/zabbix;</span><br><span class="line">  location / &#123;</span><br><span class="line">    index index.php;</span><br><span class="line">  &#125;</span><br><span class="line"> location ~ \.php$ &#123;</span><br><span class="line">   fastcgi_pass  127.0.0.1:9000;</span><br><span class="line">   fastcgi_index index.php; </span><br><span class="line">   fastcgi_param SCRIPT_FILENAME   <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">   include fastcgi_params;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 参数解释：</span></span><br><span class="line">  <span class="variable">$document_root</span>是Nginx的根目录（这里为 /app/zabbix），</span><br><span class="line">  <span class="variable">$fastcgi_script_name</span> 是请求的脚本路径和文件名。该指令将这两个变量组合，构成完整的 PHP 文件路径供 PHP-FPM 使用。例如，如果请求 /index.php，那么 SCRIPT_FILENAME 将是 /app/zabbix/index.php。</span><br><span class="line"><span class="comment"># 创建站点目录</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mkdir /app/zabbix  -p</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查配置文件是否正确</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># nginx -t</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载nginx配置文件</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemc	reload nginx</span></span><br></pre></td></tr></table></figure>



<p><strong>修改PHP的服务的启动用户和用户组</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进行替换</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># sed -ri  '/^(user|group)/s#apache#nginx#g' /etc/php-fpm.d/www.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行检查</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># egrep '^(user|group)' /etc/php-fpm.d/www.conf</span></span><br><span class="line">user = nginx</span><br><span class="line">group = nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建测试文件</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># vim /app/zabbix/info.php</span></span><br><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl enable --now php-fpm</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl status php-fpm</span></span><br></pre></td></tr></table></figure>



<p><strong>数据库部署</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加数据库源</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># vim  /etc/yum.repos.d/mariadb.repo</span></span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = http://mirrors.aliyun.com/mariadb/yum/10.5/centos7-amd64/</span><br><span class="line">gpgkey = http://mirrors.aliyun.com/mariadb/yum/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck = 1</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装数据库</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y mariadb-server</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否安装成功</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># rpm -qa | grep -i mariadb</span></span><br><span class="line">MariaDB-compat-10.5.24-1.el7.centos.x86_64</span><br><span class="line">MariaDB-client-10.5.24-1.el7.centos.x86_64</span><br><span class="line">MariaDB-server-10.5.24-1.el7.centos.x86_64</span><br><span class="line">MariaDB-common-10.5.24-1.el7.centos.x86_64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动数据库</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl enable --now mariadb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库基本设置</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mysql_secure_installation</span></span><br><span class="line">mysql_secure_installation是一个用于设置MySQL服务器安全选项的脚本。它可以帮助你设置root密码、删除匿名用户、禁止远程root登录等，以提高MySQL服务器的安全性。</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建zabbix用户及数据库</span></span><br><span class="line">mysql&gt; create database zabbix charset utf8 collate utf8_bin;</span><br><span class="line"><span class="comment">#创建zabbix用户</span></span><br><span class="line">mysql&gt; grant all on zabbix.* to <span class="string">'zabbix'</span>@<span class="string">'localhost'</span> identified by <span class="string">'zabbix'</span>; </span><br><span class="line">	<span class="comment"># 如果数据库与zbx,php不在一起</span></span><br><span class="line">	<span class="comment"># grant all on zabbix.* to 'zabbix'@'172.16.1.%' identified by 'zabbix' ;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 刷新权限</span></span><br><span class="line">mysql&gt; flush privileges;</span><br></pre></td></tr></table></figure>



<p><strong>zabbix server 配置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压安装包</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># tar xf zabbix-6.0.26.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换目录</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># cd zabbix-6.0.26/database/mysql</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入zabbix 相关数据和表结构</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mysql -uroot -pabc123  zabbix &lt; schema.sql </span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mysql -uroot -pabc123  zabbix &lt; images.sql </span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mysql -uroot -pabc123  zabbix &lt; data.sql </span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mysql -uroot -pabc123  zabbix &lt; double.sql </span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># mysql -uroot -pabc123  zabbix &lt; history_pk_prepare.sql</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sql文件解释</span></span><br><span class="line">  schema.sql 文件通常包含数据库的表结构定义。它会创建 Zabbix 所需的所有数据库表、视图、索引等。</span><br><span class="line">  images.sql 文件用于导入 Zabbix 系统内置的图片和图标，这些图片通常用于仪表板、监控界面和报告生成中。</span><br><span class="line">  data.sql 文件用于导入 Zabbix 的初始数据，包含一些默认的配置、模板、预定义的监控项等。</span><br><span class="line">  double.sql 调整数据表的存储类型或修改数据结构。以支持更精确的数据存储（如历史数据或监控值）。</span><br><span class="line">  history_pk_prepare.sql 用于准备历史数据的主键设置。Zabbix系统会记录大量的历史数据，此文件可能用于优化历史数据表的主键和索引，以提高查询性能。</span><br></pre></td></tr></table></figure>





<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装编译需要的基础环境</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y mysql-devel pcre-devel openssl-devel zlib-devel libxml2-devel net-snmp-devel  net-snmp libssh2-devel OpenIPMI-devel libevent-devel openldap-devel   libcurl-devel gcc gcc-c++</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译安装zabbix 6.0</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># cd zabbix-6.0.26</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># ./configure --sysconfdir=/etc/zabbix/ --enable-server --with-mysql --with-net-snmp --with-libxml2 --with-ssh2 --with-openipmi --with-zlib --with-libpthread --with-libevent --with-openssl --with-ldap --with-libcurl --with-libpcre</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译安装zabbix server</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># make install</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否安装成功</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># echo $?</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># zabbix_server --version</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编写 zabbix server systemd启动配置文件</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># cat /usr/lib/systemd/system/zabbix_server.service</span></span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=Zabbix Server with MySQL DB</span><br><span class="line">After=syslog.target network.target mysqld.service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line"></span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/sbin/zabbix_server -f</span><br><span class="line">User=zabbix</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载systemd启动文件</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加zabbix用户</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># useradd -s /sbin/nologin  zabbix</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改zabbix_server配置文件连接数据库地址</span></span><br><span class="line">[root@zabbix-server zabbix-6.0.26]<span class="comment"># egrep  -n -i "^DB" /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">87:DBHost=localhost</span><br><span class="line">99:DBName=zabbix</span><br><span class="line">115:DBUser=zabbix</span><br><span class="line">124:DBPassword=zabbix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动并且检查 zabbix server </span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl enable --now  zabbix_server</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl status zabbix_server</span></span><br></pre></td></tr></table></figure>



<p><strong>部署前端代码</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换前端代码目录</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># cd zabbix-6.0.26</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拷贝前端代码</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># cp -r ui/* /app/zabbix/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改属主和数组</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># chown -R nginx.nginx /app/zabbix/</span></span><br></pre></td></tr></table></figure>



<h4 id="7-3-测试访问"><a href="#7-3-测试访问" class="headerlink" title="7.3 测试访问"></a>7.3 测试访问</h4><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425165826345.png" alt="img"></p>
<p>游览器输入： <a href="http://zabbix.tanke.love" target="_blank" rel="noopener">http://zabbix.tanke.love</a></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425165908837.png" alt="img"></p>
<p><strong>修改php配置文件，解决报错：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改配置文件参数</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># egrep -n '^(max_.*_time|post_max)'   /etc/php.ini</span></span><br><span class="line">/etc/php.ini:368:max_execution_time = 300  <span class="comment"># 设置 PHP 脚本的最大执行时间，防止 PHP 脚本运行时间过长而导致服务器资源耗尽或阻塞。</span></span><br><span class="line">/etc/php.ini:378:max_input_time = 300  <span class="comment"># 设置 PHP 脚本解析输入数据（例如 POST 和 GET 数据、文件上传等）的最大时间，单位为 秒。这个时间限制只影响解析输入数据的时间，而不影响脚本的整体执行时间。</span></span><br><span class="line">/etc/php.ini:656:post_max_size = 80M  <span class="comment"># 设置 PHP 表单提交（POST 请求）允许的最大数据大小，包括文件上传、表单数据等。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新启动 PHP</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl restart php-fpm</span></span><br></pre></td></tr></table></figure>



<p><strong>修改时区</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425170026975.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425170039723.png" alt="img"></p>
<p>文件位置：<code>/app/code/zbx/conf/zabbix.conf.php</code></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425170059876.png" alt="img"></p>
<p><strong>用户名：Admin<br>**</strong>密码：zabbix**</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425170123419.png" alt="img"></p>
<p><strong>此故障表示没有安装zabbix-agnet或者客户端宕机</strong></p>
<p><strong>zabbix server 自我测试</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装zabbix-agent安装源</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># rpm -Uvh https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/6.0/rhel/7/x86_64/zabbix-release-6.0-1.el7.noarch.rpm</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装zabbix-agent2 </span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y zabbix-agent2.x86_64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改zabbix-agent2 配置文件参数</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># grep '^[a-Z]' /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">PidFile=/run/zabbix/zabbix_agent2.pid</span><br><span class="line">LogFile=/var/<span class="built_in">log</span>/zabbix/zabbix_agent2.log</span><br><span class="line">LogFileSize=0 <span class="comment"># 指定日志文件的最大大小。默认不限制</span></span><br><span class="line">Server=127.0.0.1  <span class="comment"># zabbix-server所在的主机IP，被动模式</span></span><br><span class="line">ServerActive=127.0.0.1 	<span class="comment"># zabbix-server所在的主机IP,主动模式</span></span><br><span class="line">Hostname=Zabbix server  <span class="comment"># 指定 Zabbix Agent 运行所在的主机名称</span></span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf  <span class="comment"># 自定义监控项配置路径 </span></span><br><span class="line">Include=./zabbix_agent2.d/plugins.d/*.conf  <span class="comment"># 自带插件路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动zabbix-agent2</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># systemctl enable --now zabbix-agent2</span></span><br></pre></td></tr></table></figure>



<p><strong>再次访问web界面</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425170504277.png" alt="img"></p>
<h4 id="7-4-zabbix-主机图形乱码解决"><a href="#7-4-zabbix-主机图形乱码解决" class="headerlink" title="7.4 zabbix 主机图形乱码解决"></a>7.4 zabbix 主机图形乱码解决</h4><p>原因：zabbix显示中文的字体有问题，导致显示中文异常。<br>解决：把zabbix中文字体替换即可。</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425174855188.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425174925105.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换值zabbix 字体目录</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># cd /app/zabbix/assets/fonts/</span></span><br><span class="line">[root@zabbix-server fonts]<span class="comment"># ls</span></span><br><span class="line">DejaVuSans.ttf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 备份原有字体</span></span><br><span class="line">[root@zabbix-server fonts]<span class="comment"># cp DejaVuSans.ttf&#123;,.bak&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加新的字体</span></span><br><span class="line">[root@zabbix-server fonts]<span class="comment"># ls msyh.ttc   </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名新字体，不需要重新启动nginx</span></span><br><span class="line">[root@zabbix-server fonts]<span class="comment"># mv msyh.ttc DejaVuSans.ttf</span></span><br></pre></td></tr></table></figure>



<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240425175627776.png" alt="img"></p>
<p><strong>注意：修改成新的字体后，但是仍然有些许字段没有改变，生产环境建议使用英文版的。</strong></p>
<h3 id="8、配置文件详解"><a href="#8、配置文件详解" class="headerlink" title="8、配置文件详解"></a>8、配置文件详解</h3><p><strong>zabbix_server主配置文件详解</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]<span class="comment"># grep "^[a-Z]" /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">ListenPort=10051  <span class="comment"># Zabbix服务器监听的端口号，默认为10051</span></span><br><span class="line">LogFile=/tmp/zabbix_server.log  <span class="comment"># Zabbix服务器日志文件的路径</span></span><br><span class="line">DBHost=localhost  <span class="comment"># Zabbix服务器连接的数据库主机地址</span></span><br><span class="line">DBName=zabbix  <span class="comment"># Zabbix服务器连接的数据库名称</span></span><br><span class="line">DBUser=zabbix  <span class="comment"># Zabbix服务器连接的数据库用户名</span></span><br><span class="line">DBPassword=zabbix  <span class="comment"># Zabbix服务器连接的数据库密码</span></span><br><span class="line">Timeout=4  <span class="comment"># Zabbix服务器的超时时间</span></span><br><span class="line">AlertScriptsPath=<span class="variable">$&#123;datadir&#125;</span>/zabbix/alertscripts  <span class="comment"># Zabbix服务器报警脚本的存放路径</span></span><br><span class="line">LogSlowQueries=3000   <span class="comment"># 记录慢查询日志的阈值时间</span></span><br></pre></td></tr></table></figure>



<h3 id="9、zabbix-agent版本差异解释-了解"><a href="#9、zabbix-agent版本差异解释-了解" class="headerlink" title="9、zabbix agent版本差异解释(了解)"></a>9、zabbix agent版本差异解释(了解)</h3><p><strong>zabbix-agent</strong>：</p>
<ul>
<li>C语言开发，基于传统的单线程设计，使用单个进程来处理所有的数据收集。</li>
</ul>
<p><strong>zabbix-agent2：</strong></p>
<ul>
<li>GO语言和C语言混合开发，基于多线程设计，采用了更先进的异步架构，能够更高效地处理并发请求和大量数据。</li>
</ul>
<h3 id="10、监控任意主机"><a href="#10、监控任意主机" class="headerlink" title="10、监控任意主机"></a>10、监控任意主机</h3><p>监控步骤：</p>
<ul>
<li><p>被监控端安装客户端工具，并修改配置文件中，server端的主机IP地址。</p>
</li>
<li><p>启动客户端工具，并且查看服务是否正常启动。<code>(ps netstat)</code></p>
</li>
<li><p>服务端 web界面进行配置。</p>
</li>
</ul>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426113359441.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426114257355.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426114606918.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426141751419.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426142031899.png" alt="img"></p>
<h4 id="10-1-快速添加新的主机"><a href="#10-1-快速添加新的主机" class="headerlink" title="10.1 快速添加新的主机"></a>10.1 快速添加新的主机</h4><ul>
<li><p>被监控端安装客户端工具zabbix-agent</p>
</li>
<li><p>通过web界面配置过的被监控主机进行克隆。</p>
</li>
</ul>
<p><strong>流程图如下：</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426154530806.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426154553230.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426154755301.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240426154922536.png" alt="img"></p>
<h3 id="11、主机群组使用"><a href="#11、主机群组使用" class="headerlink" title="11、主机群组使用"></a>11、主机群组使用</h3><p>​    将多个<strong>相同服务</strong>的主机，归纳一个主机群组，该主机群组可针对服务设定相同的监控项或者自定义监控项，比如多个nginx，他们所监控的指标一致，可以为它们专门创建一个主机群组，例如web-servers。实现统一，方便后期管理。</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504215946168.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504220029956.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504220102197.png" alt="img"></p>
<h3 id="12、自定义监控模版"><a href="#12、自定义监控模版" class="headerlink" title="12、自定义监控模版"></a>12、自定义监控模版</h3><h4 id="12-1-boot分区剩余容量监控"><a href="#12-1-boot分区剩余容量监控" class="headerlink" title="12.1 boot分区剩余容量监控"></a>12.1 boot分区剩余容量监控</h4><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504220350681.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504220410594.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504220517123.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504220609638.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222123795.png" alt="img"></p>
<p>vfs.fs.size[fs,<mode>] 用于查询或设置虚拟文件系统 (VFS) 中的文件系统（<code>fs</code>）的大小。<code>&lt;mode&gt;</code> 参数指定了如何计算和显示文件系统的大小。  </mode></p>
<ul>
<li><p><code>fs</code> 是文件系统的具体实例。一个具体的挂载点，如 <code>/home</code> 或者 <code>/boot等等；</code></p>
</li>
<li><p><code>&lt;mode&gt;</code> 参数决定了如何计算文件系统的大小。通常，以下是一些常见的模式：</p>
</li>
<li><ul>
<li>total: 返回文件系统的总大小，包括所有已使用的和未使用的空间。</li>
<li>used: 返回文件系统中已经使用的空间大小。</li>
<li>free: 返回文件系统中剩余的可用空间大小。</li>
<li>available: 返回文件系统中可以分配给普通用户的空间。  </li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>历史数据</strong>和<strong>趋势数据</strong>是Zabbix中存储收集到的数据两种方式：</p>
</li>
<li><p><strong>历史数据是指Zabbix系统针对每个监控项目在每次采集时所收集到的数据，这个数据保存在Zabbix系统数据库的历史表中。</strong>因为每次采集到的数据都保存在历史表中，所以如果监控项目的更新间隔越小，则在固定时间内保存到历史表中的数据就越多。例如，如果每个监控项目的更新间隔是30秒，那么两个小时该监控项目在Zabbix数据库的历史表中就会产生240条记录，一天就会产生2880条记录。虽然对于只监控一个项目或少量项目的系统来说，这些记录可能并不显著，但对于监控大量项目或需要长时间保存数据的系统来说，历史数据可能会占用大量的存储空间，并对数据库造成较大的负载压力。常见的历史数据表如下：</p>
</li>
<li><ul>
<li><code>**history**</code> <strong>表</strong>：用于存放整数类型的数据，例如 CPU 使用率（以百分比表示）。</li>
<li><code>**history_uint**</code> <strong>表</strong>：用于存放无符号整数类型的数据，适合存储不会出现负值的监控数据。</li>
<li><code>**history_str**</code> <strong>表</strong>：用于存放字符串类型的数据，例如日志信息或其他文本类型的监控项。</li>
<li><code>**history_text**</code> <strong>表</strong>：用于存放长文本数据，适合存储大量文本数据（例如完整的日志行）。</li>
<li><code>**history_log**</code> <strong>表</strong>：专门用于存储日志文件的监控数据。</li>
<li>每个表的字段通常包括 <code>itemid</code>、<code>clock</code>、<code>value</code>、<code>ns</code> 等：</li>
</ul>
</li>
<li><ul>
<li><ul>
<li><code>itemid</code>：监控项的唯一标识符。</li>
<li><code>clock</code>：时间戳，记录数据采集的具体时间（以秒为单位）。</li>
<li><code>value</code>：具体的监控项值。</li>
<li><code>ns</code>：纳秒级的时间戳，确保数据在同一秒内的精确排序。</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>趋势数据则是<strong>按小时统计计算后的平均数据</strong>，它是一种Zabbix内建的历史数据压缩机制。趋势数据可以用来存储数字类型监控项的每小时的最小值、最大值、平均值和记录数量。由于趋势数据是计算后的汇总数据，因此其数量相对于历史数据要少得多，同时其保存的时间通常也比历史数据要长。趋势数据通常用于生成图表或报告，以便用户能够更直观地了解监控项目的长期趋势和变化。常见的表如下：</p>
</li>
<li><ul>
<li><code>**trends**</code> 表：用于存储整数类型的数据的趋势。</li>
<li><code>**trends_uint**</code> 表：用于存储无符号整数类型的数据的趋势。</li>
<li>趋势数据表存储格式：每个趋势表的字段通常包括 <code>itemid</code>、<code>clock</code>、<code>num</code>、<code>value_min</code>、<code>value_avg</code>、<code>value_max</code>：</li>
</ul>
</li>
<li><ul>
<li><ul>
<li><code>itemid</code>：监控项的唯一标识符。</li>
<li><code>clock</code>：时间戳，表示数据对应的时间段（通常是小时级别）。</li>
<li><code>num</code>：在该时间段内的数据样本数量。</li>
<li><code>value_min</code>：该时间段内的最小值。</li>
<li><code>value_avg</code>：该时间段内的平均值。</li>
<li><code>value_max</code>：该时间段内的最大值。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>强烈建议将历史数据保留时长设置得尽可能的小。这么做可以让数据库不会因存储了大量的历史数据，导致超负荷运行。可以选择长时间的保留趋势数据，来替代长期需要的历史数据。例如：设置成保留14天历史数据和5年的趋势数据。</strong></p>
<p><strong>创建图形</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222331047.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222347806.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222541298.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222603463.png" alt="img"></p>
<p><strong>添加主机</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222701746.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222723507.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504222947897.png" alt="img"></p>
<p><strong>查看监控指标</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504223147777.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504223239069.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504223314247.png" alt="img"></p>
<p><strong>或者：</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240504224047878.png" alt="img"></p>
<p><strong>测试监控数据变化</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 被监控端boot分区压测</span></span><br><span class="line">[root@test01 boot]<span class="comment"># dd if=/dev/zero of=/boot/1.txt bs=1M count=100</span></span><br><span class="line">[root@test01 boot]<span class="comment"># dd if=/dev/zero of=/boot/1.txt bs=1M count=50</span></span><br><span class="line">[root@test01 boot]<span class="comment"># dd if=/dev/zero of=/boot/1.txt bs=1M count=20</span></span><br><span class="line">[root@test01 boot]<span class="comment"># rm -rf /boot/1.txt</span></span><br></pre></td></tr></table></figure>

<p>被监控端压测完成以后，回到监控面板查看图形</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042258623.png" alt="img"></p>
<h4 id="12-2-网卡出入流量监控"><a href="#12-2-网卡出入流量监控" class="headerlink" title="12.2 网卡出入流量监控"></a>12.2 网卡出入流量监控</h4><h5 id="12-2-1-ens33网卡进入流量监控"><a href="#12-2-1-ens33网卡进入流量监控" class="headerlink" title="12.2.1 ens33网卡进入流量监控"></a>12.2.1 ens33网卡进入流量监控</h5><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042305206.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042306218.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042325915.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042318001.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042326553.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042326789.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042327196.png" alt="img"></p>
<p> <strong>net.if.in[if,<mode>]</mode></strong>是一个用于监控网络接口输入流量的键值（key）。这里的 <code>ens33</code> 是网络接口的名称。<code>net.if.in[ens33]</code> 键值会返回网络接口 <code>ens33</code> 上接收到的字节总数。</p>
<ul>
<li><p><code>if</code> 是网络接口的具体实例，表示我们希望监控的网络接口。  </p>
</li>
<li><p><code>&lt;mode&gt;</code> 参数决定了如何计算或显示输入的数据流量。常见的模式如下：</p>
</li>
<li><ul>
<li>bytes: 返回通过该网络接口接收到的数据量（以字节为单位）。</li>
<li>packets: 返回通过该网络接口接收到的数据包数量。</li>
<li>errors: 返回接收到的数据包中发生的错误数量。</li>
<li>dropped: 返回接收到的数据包中被丢弃的数量。</li>
</ul>
</li>
</ul>
<h5 id="12-2-2-ens33网卡出去流量监控"><a href="#12-2-2-ens33网卡出去流量监控" class="headerlink" title="12.2.2 ens33网卡出去流量监控"></a>12.2.2 ens33网卡出去流量监控</h5><p>选择配置–&gt;模版–&gt;监控项</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042329048.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042330046.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042331004.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042332757.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042333704.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042333338.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405042334904.png" alt="img"></p>
<h4 id="12-3-监控服务端口"><a href="#12-3-监控服务端口" class="headerlink" title="12.3 监控服务端口"></a>12.3 监控服务端口</h4><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062231966.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062232368.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062235452.png" alt="img"></p>
<p><strong>创建图形</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062236813.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062236319.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062237513.png" alt="img"></p>
<p><code>net.tcp.service[service,&lt;ip&gt;,&lt;port&gt;]</code> 是一个用于检查TCP服务是否在某个端口上运行的键值（key）。这个键值会尝试与指定的端口建立TCP连接，并检查连接是否成功。如果连接成功，则意味着该服务在该端口上正在运行。</p>
<ul>
<li><p><code>service</code> 指的是具体的 TCP 服务（如 Web 服务、FTP 服务、数据库服务等），此参数用于标识所监控的服务类型。  </p>
</li>
<li><p><code>&lt;ip&gt;</code> 参数代表 TCP 服务所绑定的 IP 地址。它标识了该服务所在的主机或服务器的 IP 地址。  </p>
</li>
<li><p><code>&lt;port&gt;</code> 参数代表该 TCP 服务所监听的端口号。每个服务都通过特定的端口号来区分其他服务。例如，HTTP 服务通常运行在端口80 。</p>
</li>
<li><ul>
<li><code>net.tcp.service[http,192.168.174.11,80]</code>: 监控或查询运行在 IP 地址 <code>192.168.174.11</code> 上端口 <code>80</code> 的 HTTP 服务的状态。</li>
<li><code>net.tcp.service[ftp,10.96.74.22,21]</code>: 监控或查询运行在 IP 地址 <code>10.96.74.22</code> 上端口 <code>21</code> 的 FTP 服务的状态。</li>
</ul>
</li>
</ul>
<h5 id="12-2-3监控网卡的上下流量总和"><a href="#12-2-3监控网卡的上下流量总和" class="headerlink" title="12.2.3监控网卡的上下流量总和"></a>12.2.3<code>监控网卡的上下流量总和</code></h5><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062304579.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062304730.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062306030.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062308725.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062308182.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062309394.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062309327.png" alt="img"></p>
<h4 id="12-4-监控系统进程数量"><a href="#12-4-监控系统进程数量" class="headerlink" title="12.4 监控系统进程数量"></a>12.4 监控系统进程数量</h4><ol>
<li>系统总进程数量</li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062242954.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062243502.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062244134.png" alt="img"></p>
<p><strong>创建监控项图形</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062246411.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062247689.png" alt="img"></p>
<p><code>proc.num</code> 是一个用于监控进程数量的键值（key）。它允许你根据进程名称、用户、状态、命令行参数和区域（在容器化环境中）来过滤和计数进程。</p>
<p>键值 <code>proc.num[&lt;name&gt;,&lt;user&gt;,&lt;state&gt;,&lt;cmdline&gt;,&lt;zone&gt;]</code> 的参数是可选的，你可以根据需要包含或省略它们。以下是这些参数的说明：</p>
<ul>
<li><p><code>&lt;name&gt;</code>：进程的名称或名称模式。可以使用通配符（如 <code>*</code>）来匹配多个进程。</p>
</li>
<li><p><code>&lt;user&gt;</code>：运行进程的用户名。</p>
</li>
<li><p><code>&lt;state&gt;</code>：进程的状态。可以是 <code>Z</code>（僵尸）、<code>R</code>（运行）、<code>S</code>（睡眠）、<code>T</code>（停止）或 <code>D</code>（不可中断的睡眠）。</p>
</li>
<li><p><code>&lt;cmdline&gt;</code>：进程的命令行参数。这是一个正则表达式，用于匹配进程的完整命令行。</p>
</li>
<li><p><code>&lt;zone&gt;</code>：在容器化环境中，这个参数可以用来指定容器或区域。</p>
</li>
</ul>
<p>如果不提供某个参数，那么Zabbix将不会根据该参数进行过滤。例如，如果你只提供进程名称，那么Zabbix将计算具有该名称的所有进程的数量，不考虑其他参数。</p>
<p><code>proc.num[mysql]</code>计算名为 <code>mysql</code> 的进程数量。</p>
<p><code>proc.num[,nginx]</code>计算用户 <code>nginx</code> 运行的进程数量。</p>
<ol>
<li>运行中的进程数量</li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062250570.png" alt="img"></p>
<ol>
<li>监控系统中沉睡的进程数量</li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405062255488.png" alt="img"></p>
<h4 id="12-5-监控cpu的状态"><a href="#12-5-监控cpu的状态" class="headerlink" title="12.5 监控cpu的状态"></a>12.5 监控cpu的状态</h4><ol>
<li>cpu 五分钟负载情况</li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072212759.png" alt="img"></p>
<p><code>system.cpu.load[&lt;cpu&gt;,&lt;mode&gt;]</code> 是一个用于监控CPU负载的键值（key）。这个键值提供了关于CPU使用情况的信息，通常用于评估系统的性能和瓶颈。</p>
<p>下面是关于这个键值的参数的详细说明：</p>
<ul>
<li><p><cpu>：这个参数指定了要监控的CPU或CPU核心。它可以是以下几种值之一： </cpu></p>
</li>
<li><ul>
<li><code>all</code>：表示监控所有CPU核心的平均负载。</li>
</ul>
</li>
<li><ul>
<li><code>0</code> 到 <code>N</code>（其中N是CPU核心的数量减去1）：表示监控特定的CPU核心。例如，<code>0</code> 表示第一个CPU核心，<code>1</code> 表示第二个CPU核心，依此类推。</li>
</ul>
</li>
<li><ul>
<li><code>avg1</code>, <code>avg5</code>, <code>avg15</code>：这些不是CPU核心编号，而是表示过去1分钟、5分钟和15分钟的平均负载。这些值通常用于评估系统负载随时间的变化情况。</li>
</ul>
</li>
</ul>
<ol>
<li><strong>cpu 1分钟负载情况</strong></li>
</ol>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072215173.png" alt="img"></p>
<ol>
<li><strong>cpu 15分钟负载情况</strong><br><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072216717.png" alt="img"> </li>
</ol>
<hr>
<hr>
<h3 id="13、自定义监控设置-Items"><a href="#13、自定义监控设置-Items" class="headerlink" title="13、自定义监控设置(Items)"></a>13、自定义监控设置(Items)</h3><p><strong>客户端(安装有zabbix-agent端)：</strong>    </p>
<ol>
<li><p>通过命令、脚本取出需要监控的值； </p>
</li>
<li><p>安装zabbix-agent2，编写配置文件、创建键值；格式为：key=values，key为监控项名称。values为监控项的值。通过shell命令取出。 </p>
</li>
<li><p>重启客户端服务，并测试是否取出数据。<code>zabbix-agent2 -t Key名</code> </p>
</li>
</ol>
<p><strong>服务端：</strong></p>
<ol>
<li><p>服务端命令行测试是否<code>get</code>到客户端自定义监控的值；</p>
</li>
<li><p>web界面：获取到的键值与监控项关联；</p>
</li>
<li><p>web界面：测试。</p>
</li>
</ol>
<h4 id="13-1-自定义监控项编写"><a href="#13-1-自定义监控项编写" class="headerlink" title="13.1 自定义监控项编写"></a>13.1 自定义监控项编写</h4><p><strong>小试牛刀：监控web服务80端口</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令行取值</span></span><br><span class="line">[root@test01 ~]<span class="comment"># ss -tunlp | grep -w  80  | wc -l</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428204223339.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看自定监控配置文件存放路径</span></span><br><span class="line">[root@test01 ~]<span class="comment"># grep -i "include" /etc/zabbix/zabbix_agent2.conf </span></span><br><span class="line">...</span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编写自定义监控项配置文件</span></span><br><span class="line">[root@test01 ~]<span class="comment"># vim /etc/zabbix/zabbix_agent2.d/web_status.conf</span></span><br><span class="line"><span class="comment">#UserParameter=key,cmd</span></span><br><span class="line"><span class="comment">#UserParameter=web_port_status,bash /check_service/xxx.sh</span></span><br><span class="line">UserParameter=web_port_status,ss -tunlp | grep 80 | wc -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启客户端服务</span></span><br><span class="line">[root@test01 ~]<span class="comment"># systemctl restart zabbix-agent2</span></span><br><span class="line">[root@test01 ~]<span class="comment"># systemctl status zabbix-agent2</span></span><br></pre></td></tr></table></figure>

<p><code>Include=/etc/zabbix/zabbix_agent2.d/*.conf</code> 自定义监控项配置文件默认位置。</p>
<p>UserParameter=key,cmd<br>UserParameter=固定格式，表示要自定义监控项。<br>key表示键值名称，也就是自定义监控项的名称，命名最好为 单词+”_”<br>cmd表示取值的命令或者脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 客户端本地测试</span></span><br><span class="line">[root@test01 ~]<span class="comment"># zabbix_agent2 -t web_port_status</span></span><br><span class="line">web_port_status                               [s|1]</span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428205503477.png" alt="img"></p>
<p>解释：<code>**web_port_status**</code> <strong>表示自定义监控的Key，非配置文件名称。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 服务端测试，安装测试工具</span></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># yum install -y zabbix-get</span></span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]<span class="comment"># zabbix_get  -s 192.168.174.60 -p 10050 -k web_port_status</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>解释：</p>
<ul>
<li><p><strong>-s 客户端IP地址；</strong></p>
</li>
<li><p><strong>-p 客户端zabbix-agent 端口，默认：10050；</strong></p>
</li>
<li><p><strong>-k 客户端自定义监控项Key名。</strong></p>
</li>
</ul>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428211118750.png" alt="img"></p>
<hr>
<p><strong>web界面添加自定义监控项</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428220752312.png" alt="img"></p>
<p><strong>配置–&gt;主机–&gt;选择主机监控项</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428220854319.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428221545133.png" alt="img"></p>
<p>参数解释：</p>
<ol>
<li><p>历史数据保留时长：根据服务器的配置决定，建议保留时长不宜过久；</p>
</li>
<li><p>趋势存储时间：通常趋势数据设置的的留存时间应当比历史数据留存时间设置的长。</p>
</li>
</ol>
<p>详细信息参考官方文档：<a href="https://www.zabbix.com/documentation/6.0/zh/manual/config/items/history_and_trends" target="_blank" rel="noopener">4 历史数据与趋势数据 (zabbix.com)</a></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428222405047.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429092334079.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429091503703.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429091543086.png" alt="img"></p>
<p><strong>web 查看自定义监控项数据</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429094725797.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429094800733.png" alt="img"></p>
<h4 id="13-2-获取不到内容报错解决"><a href="#13-2-获取不到内容报错解决" class="headerlink" title="13.2 获取不到内容报错解决"></a>13.2 获取不到内容报错解决</h4><p><strong>报错内容</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240428205848334.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**Unknown metric web_port_statuss**</span><br></pre></td></tr></table></figure>

<ol>
<li><p>客户端测试时，自定义监控名称写错；</p>
</li>
<li><p>自定义监控项配置文件内部语法错误，例如：固定格式、命令；</p>
</li>
<li><p>自定义监控项创建完成没有重启客户端。</p>
</li>
</ol>
<h4 id="13-3-使用脚本定义自定义监控项"><a href="#13-3-使用脚本定义自定义监控项" class="headerlink" title="13.3 使用脚本定义自定义监控项"></a>13.3 使用脚本定义自定义监控项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**详细请见附件基于脚本实现自定义监控项**</span><br></pre></td></tr></table></figure>



<h3 id="14、-自定义图形"><a href="#14、-自定义图形" class="headerlink" title="14、 自定义图形"></a>14、 自定义图形</h3><h4 id="14-1-自定义单个监控项图形"><a href="#14-1-自定义单个监控项图形" class="headerlink" title="14.1 自定义单个监控项图形"></a>14.1 自定义单个监控项图形</h4><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095135012.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095158678.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095505410.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095627370.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095731458.png" alt="img"></p>
<p><strong>查看自定义图形</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095846535.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429095902300.png" alt="img"></p>
<h4 id="14-2-仪表盘创建-聚合图形"><a href="#14-2-仪表盘创建-聚合图形" class="headerlink" title="14.2 仪表盘创建(聚合图形)"></a>14.2 仪表盘创建(聚合图形)</h4><p>​    仪表盘用于，将我们自定以图像进行集中值一个界面进行展示，使得我们更方便的找到服务器的瓶颈。</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072141985.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072142858.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072143247.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072144583.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072145165.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072145673.png" alt="img"></p>
<p><strong>查看自定义仪表盘</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072151208.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072151206.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072152655.png" alt="img"></p>
<h3 id="15、触发器器设置-Triggers-P0级服务"><a href="#15、触发器器设置-Triggers-P0级服务" class="headerlink" title="15、触发器器设置( Triggers)  P0级服务"></a>15、触发器器设置( Triggers)  P0级服务</h3><h4 id="15-1-触发器介绍"><a href="#15-1-触发器介绍" class="headerlink" title="15.1 触发器介绍"></a>15.1 触发器介绍</h4><p>触发器是<code>条件的定义</code>,一个触发器是根据一个监控项的<code>返回值</code>,将之<code>对比预先设置的阈值</code>，当监控项返回了不符合预定义的值范围后,就进行触发下一步操作的警戒线,一般要对创建的监控项设置触发器以及触发方式和值的大小</p>
<ul>
<li><p>可以在指定主机上创建触发器,只是针对指定主机有效； </p>
</li>
<li><p>也可以在指定<code>模板上创建触发器</code>,则使用此模板的所有主机都有效,一个模板中可以有多触发器；<br>触发器中使用的表达式是非常灵活的。你可以使用它们去创建关于监控统计的复杂逻辑测试。 </p>
</li>
</ul>
<h4 id="15-2-触发器严重性"><a href="#15-2-触发器严重性" class="headerlink" title="15.2 触发器严重性"></a>15.2 触发器严重性</h4><p>触发器严重性表示<code>触发器的重要程度</code>，Zabbix支持下列6种触发器的严重程度：</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429104740157.png" alt="img"></p>
<p>严重性功能：</p>
<ul>
<li><p>通过不同的颜色区分不同的严重程度；</p>
</li>
<li><p>用户媒介，不同的用户媒介（通知渠道）代表不同的严重程度。例如，短信 - 高严重性，email - 其他；</p>
</li>
<li><p>不同的严重性通过触发器执行对应的条件动作。</p>
</li>
</ul>
<h4 id="15-3-配置触发器"><a href="#15-3-配置触发器" class="headerlink" title="15.3 配置触发器"></a>15.3 配置触发器</h4><h5 id="15-3-1-触发器示例一：web服务端口"><a href="#15-3-1-触发器示例一：web服务端口" class="headerlink" title="15.3.1 触发器示例一：web服务端口"></a>15.3.1 触发器示例一：web服务端口</h5><p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429105152136.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429105218145.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429111807604.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429111947106.png" alt="img"></p>
<p>解释：</p>
<ul>
<li><p>监控项：自定义监控项默认没有触发器，需要自己去添加，选择自定义监控项的名称；</p>
</li>
<li><p>功能：<code>last</code>函数：表示最新的值和最近一次的值作比较。</p>
</li>
<li><p>结果：如果自定义监控项取出的值为0时，触发报警。</p>
</li>
</ul>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429112408935.png" alt="img"></p>
<p>解释：表达式 zabbix5和zabbix6之间的区别</p>
<ul>
<li><p>zabbix 6 </p>
</li>
<li><ul>
<li>last(/nginx01/web_port_status)=0   # 函数(/主机/自定义监控项)=0</li>
</ul>
</li>
<li><p>zabbix 5 </p>
</li>
<li><ul>
<li>{nginx01:web_port_status.last()}=0    # {主机:自定义监控项名称.功能函数}=0</li>
</ul>
</li>
</ul>
<p><strong>测试触发器是否生效</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 客户端关闭nginx</span></span><br><span class="line">[root@test01 ~]<span class="comment"># systemctl stop nginx</span></span><br></pre></td></tr></table></figure>



<p><strong>web界面查看</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429141751762.png" alt="img"></p>
<h5 id="15-3-2-触发器示例二：cpu-1分钟负载"><a href="#15-3-2-触发器示例二：cpu-1分钟负载" class="headerlink" title="15.3.2 触发器示例二：cpu 1分钟负载"></a>15.3.2 触发器示例二：cpu 1分钟负载</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dd <span class="keyword">if</span>=/dev/zero  of=/1.txt  bs=1M count=4000</span><br></pre></td></tr></table></figure>

<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072220786.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072220561.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072333602.png" alt="img"></p>
<p><strong>查看触发器</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072335452.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072335962.png" alt="img"></p>
<p>表达式：<strong>last(/nginx_status_monitor/system.cpu.load[all,avg1])&gt;=0.4</strong></p>
<p>解释：表达式函数(/监控模版/自定义监控项)&gt;=0.4</p>
<p><strong>图形查看触发器</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405072343646.png" alt="img"></p>
<hr>
<hr>
<h4 id="15-4-触发器常用表达式功能函数介绍"><a href="#15-4-触发器常用表达式功能函数介绍" class="headerlink" title="15.4 触发器常用表达式功能函数介绍"></a>15.4 触发器常用表达式功能函数介绍</h4><p>官方网站：<a href="https://www.zabbix.com/documentation/6.0/zh/manual/config/triggers/expression" target="_blank" rel="noopener">2 触发器表达式 (zabbix.com)</a></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/image-20240429142518357.png" alt="img"></p>
<p><strong>触发器示例场景</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 触发器示例场景1:www.zabbix.com的处理器负载过高</span></span><br><span class="line">last(www.zabbix.com/system.cpu.load[all,avg1])&gt;5</span><br><span class="line">服务器是www.zabbix.com，监控项键值是system.cpu.load[all,avg1]</span><br><span class="line">通过使用函数“last()”获取最新的值。最后&gt;5 意味着当www.zabbix.com最新获取的处理器负载值大于5时触发器就会处于异常状态。</span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器示例场景2:当前处理器负载大于5并且最近10分钟内最小值大于2，表达式为True</span></span><br><span class="line">last(www.zabbix.com/system.cpu.load[all,avg1]) &gt; 5 and last(www.zabbix.com/system.cpu.load[all.avg1].min(10m)) &gt; 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器示例场景3:监控/etc/passwd 文件是否被修改，当文件/etc/passwd的checksum值与最近的值不同时，表达式为true。</span></span><br><span class="line">diff(www.zabbix.com/vfs.file.cksum[/etc/passwd]) = 1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器示例场景4:如果在最后五分钟期间eth0网卡接收到的网络字节数最小值超过 100 KB 将触发。</span></span><br><span class="line">min(/Zabbix server/net.if.in[eth0,bytes],5m)&gt;100K</span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器实力场景5：Zabbix server上的处理器负载太高。</span></span><br><span class="line">last(/Zabbix server/system.cpu.load[all,avg1])&gt;5</span><br><span class="line">‘/Zabbix server/system.cpu.load[all,avg1]‘ 给出了被监控参数的简短名称。它指定了服务器是“Zabbix server”，监控项的键值是“system.cpu.load[all,avg1]”。通过使用函数“last()”获取最新的值。最后，“&gt;5”意味着当Zabbix server最新获取的处理器负载值大于5时触发器就会处于异常状态。</span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器示例场景7：服务器网卡从 Internet 下载一个大文件。 min 函数的使用：</span></span><br><span class="line">min(/www.example.com/net.if.in[eth0,bytes],5m)&gt;100K</span><br><span class="line">在过去5分钟内，eth0上接收字节数大于100kb时，表达式为<span class="literal">true</span>。</span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器示例场景8：服务器无法访问。</span></span><br><span class="line">count(/example.example.com/icmpping,30m,,<span class="string">"0"</span>)&gt;5、</span><br><span class="line">如果主机“example.example.com” 在过去 30 分钟内超过 5 次无法访问，则表达式为真。</span><br></pre></td></tr></table></figure>



<h3 id="16、zabbix监控模版"><a href="#16、zabbix监控模版" class="headerlink" title="16、zabbix监控模版"></a>16、zabbix监控模版</h3><h4 id="16-1-zabbix-server自带模版"><a href="#16-1-zabbix-server自带模版" class="headerlink" title="16.1 zabbix server自带模版"></a>16.1 zabbix server自带模版</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux by Zabbix agent</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>Linux: Host name of Zabbix agent running</td>
<td>Linux：Zabbix代理运行的主机名</td>
</tr>
<tr>
<td>Linux: Zabbix agent ping</td>
<td>Linux:Zabbix代理ping</td>
</tr>
<tr>
<td>Linux: Version of Zabbix agent running</td>
<td>Linux：运行Zabbix代理的版本</td>
</tr>
<tr>
<td>Linux: Maximum number of open file descriptors</td>
<td>打开文件描述符的最大数量</td>
</tr>
<tr>
<td>Linux: Maximum number of processes</td>
<td>Linux：进程的最大数量</td>
</tr>
<tr>
<td>Linux: Number of processes</td>
<td>Linux：进程数</td>
</tr>
<tr>
<td>Linux: Number of running processes</td>
<td>Linux：正在运行的进程数</td>
</tr>
<tr>
<td>Linux: System boot time</td>
<td>Linux：系统启动时间</td>
</tr>
<tr>
<td>Linux: Interrupts per second</td>
<td>Linux:每秒中断次数</td>
</tr>
<tr>
<td>Linux: Load average (1m avg)</td>
<td>Linux：平均负载（平均1分钟）</td>
</tr>
<tr>
<td>Linux: Load average (5m avg)</td>
<td>Linux：平均负载（平均5分钟）</td>
</tr>
<tr>
<td>Linux: Load average (15m avg)</td>
<td>Linux：平均负载（平均15分钟）</td>
</tr>
<tr>
<td>Linux: Number of CPUs</td>
<td>Linux：CPU数量</td>
</tr>
<tr>
<td>Linux: Context switches per second</td>
<td>Linux:每秒上下文切换次数</td>
</tr>
<tr>
<td>Linux: CPU idle time: Linux: CPU utilization</td>
<td>Linux:CPU空闲时间：Linux:CPU利用率</td>
</tr>
<tr>
<td>Linux: CPU guest time</td>
<td>Linux 中的 CPU guest time 是指<code>虚拟机在宿主机上运行期间，CPU 资源被占用的时间</code>。这个指标可以帮助管理员了解虚拟机对宿主机 CPU 资源的使用情况，以便进行性能优化和资源分配。</td>
</tr>
<tr>
<td>Linux: CPU guest nice time</td>
<td>Linux 中的 CPU guest nice time 是指<code>虚拟机在宿主机上运行期间</code>，<code>CPU 资源被占用的 nice 时间</code>。nice 值是 Linux 系统中用于控制进程优先级的一个参数，范围从 -20（最高优先级）到 19（最低优先级）。</td>
</tr>
<tr>
<td>Linux: CPU idle time</td>
<td>在 Linux 系统中，<code>CPU idle time 指的是 CPU 处于空闲状态的时间</code>。这是系统性能监控中的一个重要指标，因为它可以帮助你理解系统资源是否得到了充分利用或者是否存在过剩的计算能力。</td>
</tr>
<tr>
<td>Linux: CPU interrupt time</td>
<td>Linux 中的 CPU interrupt time 是指 <code>CPU 在处理中断请求时所花费的时间</code>。中断是计算机系统中的一种机制，用于响应硬件设备或软件程序的请求，以便进行相应的操作。</td>
</tr>
<tr>
<td>Linux: CPU iowait time</td>
<td>在 Linux 中，CPU iowait time（I/O等待时间）是<code>指 CPU 等待 I/O 操作完成的时间</code>。当 CPU 需要从磁盘、网络或其他慢速设备读取数据时，如果该数据尚未准备好，CPU 就会进入等待状态。iowait 是衡量系统 I/O 性能的关键指标之一，它可以帮助识别是否存在 I/O 瓶颈问题。</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apache by HTTP</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28776&context=template" target="_blank" rel="noopener"> Apache: Service ping</a></td>
<td>httpd服务是否存活</td>
</tr>
<tr>
<td>Apache: Service response time</td>
<td>Apache 服务器的响应时间。是指从客户端发送请求到接收到服务器响应所需的时间。这个指标对于评估服务器性能和用户体验非常重要。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28788&context=template" target="_blank" rel="noopener">Apache: Total workers idle</a></td>
<td>Apache: Total workers idle 是指当前空闲的工作进程数量。这个指标可以帮助你了解服务器的负载情况，以及是否需要增加或减少工作进程的数量来优化性能。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28789&context=template" target="_blank" rel="noopener">Apache: Total workers busy</a></td>
<td>Apache: Total workers busy 是指当前正在处理请求的工作进程数量。这个指标可以帮助你了解服务器的负载情况，以及是否需要增加或减少工作进程的数量来优化性能。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28796&context=template" target="_blank" rel="noopener">Apache: Workers waiting for connection</a></td>
<td>Apache: Workers waiting for connection 是指当前正在等待连接的工作进程数量。这个指标可以帮助你了解服务器的负载情况，以及是否需要增加或减少工作进程的数量来优化性能。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener"> Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28778&context=template" target="_blank" rel="noopener">Apache: Workers starting up</a></td>
<td>Apache: Workers starting up 是指当前正在启动的工作进程数量。这个指标可以帮助你了解服务器的负载情况，以及是否需要增加或减少工作进程的数量来优化性能。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28779&context=template" target="_blank" rel="noopener">Apache: Workers slot with no current process</a></td>
<td><code>指当前没有正在处理请求的工作进程的插槽数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener"> Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28780&context=template" target="_blank" rel="noopener">Apache: Workers sending reply</a></td>
<td><code>指当前正在发送响应的工作进程数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28781&context=template" target="_blank" rel="noopener">Apache: Workers reading request</a></td>
<td><code>指当前正在读取请求的工作进程数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28782&context=template" target="_blank" rel="noopener">Apache: Workers logging</a></td>
<td>指当前正在记录日志的工作进程数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28783&context=template" target="_blank" rel="noopener">Apache: Workers keepalive (read)</a></td>
<td><code>指当前正在处理 Keep-Alive 连接的工作进程数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28785&context=template" target="_blank" rel="noopener">Apache: Workers finishing</a></td>
<td><code>指当前正在结束请求的工作进程数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28787&context=template" target="_blank" rel="noopener">Apache: Workers DNS lookup</a></td>
<td>指当前正在执行 DNS 查询的工作进程数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28786&context=template" target="_blank" rel="noopener">Apache: Workers closing connection</a></td>
<td><code>指当前正在关闭连接的工作进程数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28784&context=template" target="_blank" rel="noopener">Apache: Workers idle cleanup</a></td>
<td>指当前正在执行空闲清理的工作进程数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28790&context=template" target="_blank" rel="noopener">Apache: Version</a></td>
<td>指 Apache HTTP Server 的版本号。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener"> Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28791&context=template" target="_blank" rel="noopener">Apache: Uptime</a></td>
<td>指 Apache HTTP Server 自上次启动以来的运行时间。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28793&context=template" target="_blank" rel="noopener">Apache: Requests per second</a></td>
<td><code>指 Apache HTTP Server 每秒处理的请求数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener"> Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28792&context=template" target="_blank" rel="noopener">Apache: Total requests</a></td>
<td><code>指 Apache HTTP Server 自上次启动以来处理的总请求数量。</code></td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a></td>
<td>指获取 Apache HTTP Server 的状态信息。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener">Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28794&context=template" target="_blank" rel="noopener">Apache: Bytes per second</a></td>
<td>指 Apache HTTP Server 每秒传输的字节数。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28775&context=template" target="_blank" rel="noopener"> Apache: Get status</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10265&itemid=28795&context=template" target="_blank" rel="noopener">Apache: Total bytes</a></td>
<td>指 Apache HTTP Server 自上次启动以来传输的总字节数。</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nginx by Zabbix agent</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener"> Nginx: Get stub status page</a></td>
<td>Nginx: Get stub status page 是指获取 Nginx Web Server 的状态页面。这个状态页面提供了关于服务器的实时信息，包括连接数、请求处理时间等指标。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28809&context=template" target="_blank" rel="noopener">Nginx: Number of running processes</a></td>
<td>指 Nginx Web Server 当前正在运行的进程数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28808&context=template" target="_blank" rel="noopener"> Nginx: Memory usage (vsize)</a></td>
<td>指 Nginx Web Server 进程的虚拟内存使用量。虚拟内存使用量（vsize）包括了进程直接使用的内存以及其映射的文件和设备所使用的内存。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28807&context=template" target="_blank" rel="noopener">Nginx: Memory usage (rss)</a></td>
<td><strong>Nginx Web Server 进程使用的驻留集大小内存（以字节为单位）</strong>。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28806&context=template" target="_blank" rel="noopener">Nginx: CPU utilization</a></td>
<td><strong>指的是Nginx进程在服务器CPU上占用的资源情况，包括用户态和内核态的占用</strong>。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener"> Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28820&context=template" target="_blank" rel="noopener">Nginx: Version</a></td>
<td>指 Nginx Web Server 的版本号。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28818&context=template" target="_blank" rel="noopener">Nginx: Requests per second</a></td>
<td>指 Nginx Web Server 每秒处理的请求数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener"> Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28819&context=template" target="_blank" rel="noopener">Nginx: Requests total</a></td>
<td>指 Nginx Web Server 自上次启动以来处理的总请求数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28812&context=template" target="_blank" rel="noopener">Nginx: Connections writing</a></td>
<td>指 Nginx Web Server 当前正在写入响应的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28811&context=template" target="_blank" rel="noopener">Nginx: Connections waiting</a></td>
<td>指 Nginx Web Server 当前正在等待连接的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28814&context=template" target="_blank" rel="noopener">Nginx: Connections reading</a></td>
<td>指 Nginx Web Server 当前正在读取请求的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28815&context=template" target="_blank" rel="noopener">Nginx: Connections handled per second</a></td>
<td>指 Nginx Web Server 每秒处理的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28816&context=template" target="_blank" rel="noopener">Nginx: Connections dropped per second</a></td>
<td>指 Nginx Web Server 每秒丢弃的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28813&context=template" target="_blank" rel="noopener">Nginx: Connections active</a></td>
<td>指 Nginx Web Server 当前活跃的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28804&context=template" target="_blank" rel="noopener">Nginx: Get stub status page</a>: <a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28817&context=template" target="_blank" rel="noopener">Nginx: Connections accepted per second</a></td>
<td>指 Nginx Web Server 每秒接受的连接数量。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28810&context=template" target="_blank" rel="noopener">Nginx: Service status</a></td>
<td>指 Nginx Web Server 的运行状态。</td>
</tr>
<tr>
<td><a href="http://192.168.174.58/items.php?form=update&hostid=10266&itemid=28805&context=template" target="_blank" rel="noopener"> Nginx: Service response time</a></td>
<td>指 Nginx Web Server 处理请求的响应时间。</td>
</tr>
</tbody></table>
<h3 id="17、触发器-Action"><a href="#17、触发器-Action" class="headerlink" title="17、触发器 Action"></a>17、触发器 Action</h3><h4 id="17-1-Action-动作介绍"><a href="#17-1-Action-动作介绍" class="headerlink" title="17.1 Action 动作介绍"></a>17.1 Action 动作介绍</h4><p>Zabbix中的Action是<strong>根据不同的事件状态执行相应操作的功能</strong>。</p>
<p>在Zabbix监控系统中，Action是一个核心功能，它允许你基于事件的<code>不同状态来执行预定义的操作</code>。这些操作可以极大地自动化日常的运维工作，减少手动干预的需要。以下是Zabbix Action的一些主要特点和用途：</p>
<ol>
<li><p><strong>自动响应</strong>：当监控系统检测到问题（如触发器状态变化）时，可以自动执行一系列操作，而不是需要人工介入。</p>
</li>
<li><p><strong>可配置性</strong>：：自定义Action，例如发送报警通知、执行远程命令等。</p>
</li>
<li><p><strong>权限管理</strong>：为了执行某些操作，如重启服务，可能需要相应的权限。因此，配置sudo权限或修改zabbix配置文件以允许接收远程命令是常见的设置步骤。</p>
</li>
<li><p><strong>报警通知</strong>：最常见的用法是在检测到问题时，通过邮件、短信或其他方式将报警信息发送给指定的用户。</p>
</li>
<li><p><strong>远程命令执行</strong>：可以配置Action来在特定条件下执行远程命令，如系统重启、服务重启等，这通常需要确保Zabbix用户具有执行这些命令的权限。</p>
</li>
<li><p><strong>日志记录</strong>：所有执行的Action都会被记录在Zabbix的日志中，便于后续的问题排查和分析。</p>
</li>
</ol>
<h4 id="17-2-告警分类"><a href="#17-2-告警分类" class="headerlink" title="17.2 告警分类"></a>17.2 告警分类</h4><table>
<thead>
<tr>
<th>报警方式</th>
<th>企业使用场景</th>
</tr>
</thead>
<tbody><tr>
<td>邮件告警</td>
<td>企业邮箱，免费试用</td>
</tr>
<tr>
<td>企业微信/飞书-告警机器人</td>
<td>企业微信，免费使用</td>
</tr>
<tr>
<td>OA系统(钉钉)</td>
<td>钉钉，免费使用</td>
</tr>
<tr>
<td>短信</td>
<td>0.04元/条左右，云厂商，收费</td>
</tr>
<tr>
<td>电话</td>
<td>收费</td>
</tr>
</tbody></table>
<h4 id="17-2-邮箱告警"><a href="#17-2-邮箱告警" class="headerlink" title="17.2 邮箱告警"></a>17.2 邮箱告警</h4><p><strong>详细请见附件：zabbix 6.0 结合邮箱触发告警</strong></p>
<h4 id="17-3-飞书告警"><a href="#17-3-飞书告警" class="headerlink" title="17.3 飞书告警"></a>17.3 飞书告警</h4><p><strong>详细请见附件：zabbix 6.0结合飞书触发告警</strong></p>
<h3 id="17-4-zabbix-基于ssh远程执行故障恢复操作"><a href="#17-4-zabbix-基于ssh远程执行故障恢复操作" class="headerlink" title="17.4 zabbix 基于ssh远程执行故障恢复操作"></a>17.4 zabbix 基于ssh远程执行故障恢复操作</h3><p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/1716386143737-e11c2eb7-3c75-47dc-a8f5-913339b9cb76.png" alt="img"></p>
<p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/1716386182378-2beadc93-1f37-45fb-86c4-f43ced978a2c.png" alt="img"></p>
<p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/1716386225761-4918c8c3-7e9e-4dab-a15b-a469eea5de62.png" alt="img"></p>
<p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/1716386267017-e1be7003-82c1-45d5-806d-a6701a48ba12.png" alt="img"></p>
<p><strong>zabbix中远程命令 ssh报错Cannot obtain authentication methods: Error waiting on socket</strong></p>
<p>去agent2节点中的/etc/ssh/sshd_config中，将UseDNS打开注释并将yes改为no然后重启sshd服务。</p>
<p>UseDNS 选项打开状态下，当客户端试图登录SSH服务器时，服务器端先根据客户端的IP地址进行DNS，PTR反向查询出客户端的主机名，然后根据查询出的客户端主机名进行DNS正向A记录查询，验证与其原始IP地址是否一致，这是防止客户端欺骗的一种措施，但一般我们的是动态IP不会有PTR记录，打开这个选项不过是在白白浪费时间而已，不如将其关闭。Linux优化时常这样做。</p>
<h3 id="18、宏"><a href="#18、宏" class="headerlink" title="18、宏"></a>18、宏</h3><h4 id="18-1-介绍"><a href="#18-1-介绍" class="headerlink" title="18.1 介绍"></a>18.1 介绍</h4><p>​    <strong>Zabbix中的宏是一种用于简化配置和提高可重用性的功能强大的工具</strong>。在Zabbix中，宏可以被视为一种变量，用于保存预设的文本模式，并在调用时将其替换为相应的值。例如，内置宏{HOST.NAME}会在使用中自动替换为对应主机的名称。</p>
<h4 id="18-2-设置优先级"><a href="#18-2-设置优先级" class="headerlink" title="18.2 设置优先级"></a>18.2 设置优先级</h4><ol>
<li><p><strong>全局宏</strong>：作用于所有模板和主机，但优先级最低。</p>
</li>
<li><p><strong>模板宏</strong>：仅适用于关联的模板。</p>
</li>
<li><p><strong>主机宏</strong>：特定于单个主机。</p>
</li>
</ol>
<h4 id="18-3-作用及场景"><a href="#18-3-作用及场景" class="headerlink" title="18.3 作用及场景"></a>18.3 作用及场景</h4><ul>
<li><p><strong>简化配置</strong>：通过使用宏，可以在多个地方重复使用相同的值，而不必手动更改每个实例。</p>
</li>
<li><p><strong>统一管理</strong>：方便后期统一修改和维护，例如，如果需要更改服务器名称，只需更改全局宏一次即可。</p>
</li>
</ul>
<p>实际应用场景</p>
<ul>
<li><strong>监控项和触发器</strong>：在创建监控项或触发器时，可以使用宏来定义动态的名称或参数值。</li>
</ul>
<h4 id="18-4-宏设置"><a href="#18-4-宏设置" class="headerlink" title="18.4 宏设置"></a>18.4 宏设置</h4><p>触发动作的名字:{ACTION.NAME}</p>
<p>日期格式为yyyy.mm.dd:{DATE}</p>
<p>触发动作的事件的时长:{EVENT.AGE}</p>
<p>触发动作的事件的日期:{EVENT.DATE}</p>
<p>事件持续时间:{EVENT.DURATION}</p>
<p>触发动作的事件的数字ID:{EVENT.ID}</p>
<p>触发动作的问题事件名称:{EVENT.NAME}</p>
<p>描述事件严重性的数值:{EVENT.NSEVERITY}</p>
<p>描述事件对象的数值:{EVENT.OBJECT}</p>
<p>问题对应触发器的当前值:{EVENT.OPDATA}</p>
<p>事件恢复日期:{EVENT.RECOVERY.DATE}</p>
<p>恢复时间名称:{EVENT.RECOVERY.NAME}</p>
<p>恢复事件的文字描述:{EVENT.RECOVERY.STATUS}</p>
<p>出发动作的事件的文字描述:{EVENT.STATUS}</p>
<p>触发动作的事件时间*:{EVENT.TIME}</p>
<p>依赖于主机设置的主机IP地址或DNS名称:{HOST.CONN}</p>
<p>主机描述.:{HOST.DESCRIPTION}</p>
<p>主机名称:{HOST.HOST}</p>
<p>主机 ID.:{HOST.ID}</p>
<p>主机IP地址:{HOST.IP}</p>
<p>可见的主机名:{HOST.NAME}</p>
<p>主机（代理）端口:{HOST.PORT}</p>
<p>目标主机IP地址或DNS名称，取决于主机设置:{HOST.TARGET.CONN}</p>
<p>目标主机的DNS名称:{HOST.TARGET.DNS}</p>
<p>目标主机的技术名称:{HOST.TARGET.HOST}</p>
<p>目标主机的IP地址。:{HOST.TARGET.IP}</p>
<p>目标主机的技术名称:{HOST.TARGET.NAME}</p>
<p>引发通知的触发器表达式中的第N个监控项的描述。:{ITEM.DESCRIPTION}</p>
<p>引发通知的触发器表达式中的第 N 个监控项的序列ID。:{ITEM.ID}</p>
<p>触发器表达式中导致通知的第 N 监控项的键：{ITEM.KEY}</p>
<p>触发器表达式中导致通知的第N个监控项的名称：{ITEM.NAME}</p>
<p>触发器表达式中导致通知的第 N 监控项的最新状态：{ITEM.STATE}</p>
<p>如果在触发器状态更改的上下文中使用：{ITEM.VALUE}</p>
<p>触发器表达式中导致通知的第N个监控项的值类型：{ITEM.VALUETYPE}</p>
<p>触发器描述。：{TRIGGER.DESCRIPTION}</p>
<p>触发器表达式。：{TRIGGER.EXPRESSION}</p>
<p>触发器的名称 (已解析宏).：{TRIGGER.NAME}</p>
<p>触发器的原始名称 (即未解析宏).：{TRIGGER.NAME.ORIG}</p>
<p>触发器的最新状态 可能的值: 未知 和 正常：{TRIGGER.STATE}</p>
<p>当前触发器的值 可以是 PROBLEM 或者 OK：{TRIGGER.STATUS}</p>
<p>当前触发数值: 0 - 触发器处于正常状态, 1 - 触发器处于问题状态。：{TRIGGER.VALUE}</p>
<h3 id="19、zabbix-自动发现"><a href="#19、zabbix-自动发现" class="headerlink" title="19、zabbix 自动发现"></a>19、zabbix 自动发现</h3><p>为了满足监控企业成千上万台服务器，因此我们需要使用Zabbix批量监控来实现。自动发现功能是<strong>一个强大的网络监控工具，它允许系统管理员无需手动添加即可自动检测网络中的设备和服务</strong>。自动发现功能发现被监控对象。同时自动发现功能能够提高监控系统的效率，因为它能够自动发现并添加新的主机或服务，使得管理员无需手动添加监控对象。</p>
<p>自动发现（<strong>被动模式</strong>）：由服务端主动发起，Zabbix Server开启发现进程，定时扫描局域网中IP服务器、设备。实现自动将发现主机、自动将主机添加到主机组、自动加载模板、自动创建项目（item）、自动创建图像等功能。缺点：当 Agent服务器过多的时候采用自动发现，zabbix-server压力会比较大，自动添加主机进度就会非常慢。</p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405091430543.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092225029.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405091432175.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405091454115.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405091454293.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405091455385.png" alt="img"></p>
<p><strong>查看自动发现主机</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092243625.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092251627.png" alt="img"></p>
<p><a href="https://www.cnblogs.com/zdoubly/p/9222902.html" target="_blank" rel="noopener">https://www.cnblogs.com/zdoubly/p/9222902.html</a></p>
<h3 id="20、zabbix自动注册"><a href="#20、zabbix自动注册" class="headerlink" title="20、zabbix自动注册"></a>20、zabbix自动注册</h3><p>自动注册（<strong>主动模式</strong>）：Zabbix Server 等待 Zabbix Agent2主动上报。由客户端主动发起，客户端必须安装并启动Agent，否则无法被自动注册添加至主机列表。</p>
<h4 id="20-1-zabbix自动注册介绍"><a href="#20-1-zabbix自动注册介绍" class="headerlink" title="20.1 zabbix自动注册介绍"></a>20.1 zabbix自动注册介绍</h4><p>Zabbix 自动注册是一种方便的功能，它允许 Zabbix Agent2 主动向 Zabbix Server 注册自己，而无需手动在 Zabbix 中为每个主机创建条目。以下是实现 Zabbix 自动注册的关键步骤：</p>
<ol>
<li><p><strong>配置元数据</strong>：在 Zabbix Agent2 的配置文件中，需要设置一些参数，如 <code>Hostname</code>、<code>HostMetadata</code> 等客户端的元数据信息，以便 Zabbix Server 根据这些信息来匹配服务器的主机或模板。</p>
</li>
<li><p><strong>启用 Agent2 的主动模式</strong>：确保 Zabbix Agent2 是以主动模式运行的，即 Agentd必须安装并启动。在被动模式下，Zabbix Server 会主动扫描局域网中的设备，这在 Agent 数量较多时可能会给 Zabbix Server 带来较大压力。</p>
</li>
<li><p><strong>修改 zabbix_agent2.conf 文件</strong>：在客户端的 zabbix_agent2.conf 文件中，需要定义要执行的监控命令和自定义的 key。这些 key 将与服务器端的监控项相对应。</p>
</li>
</ol>
<h4 id="20-2-zabbix自动注册操作"><a href="#20-2-zabbix自动注册操作" class="headerlink" title="20.2 zabbix自动注册操作"></a>20.2 zabbix自动注册操作</h4><p><strong>客户端配置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt;  被监控端修改zabbix-agent2配置文件，开启主动模式</span></span><br><span class="line">[root@web02 ~]<span class="comment"># vim  /etc/zabbix/zabbix_agent2.conf </span></span><br><span class="line">ServerActive=192.168.174.58</span><br><span class="line"><span class="comment"># 注释掉配置文件的主机名。</span></span><br><span class="line"><span class="comment"># Hostname=Zabbix server</span></span><br><span class="line"><span class="comment"># 获取当前主机名</span></span><br><span class="line">HostnameItem=system.hostname</span><br><span class="line"><span class="comment"># 获取当前主机元数据信息</span></span><br><span class="line">HostMetadataItem=system.uname</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 重启zabbix-agent2</span></span><br><span class="line">[root@web02 ~]<span class="comment"># systemctl restart zabbix-agent2</span></span><br><span class="line"></span><br><span class="line">[root@web02 ~]<span class="comment"># egrep -n  "^Server|^Host"  /etc/zabbix/zabbix_agent2.conf </span></span><br><span class="line">80:Server=192.168.174.58</span><br><span class="line">133:ServerActive=192.168.174.58</span><br><span class="line">153:HostnameItem=system.hostname</span><br><span class="line">176:HostMetadataItem=system.uname</span><br></pre></td></tr></table></figure>



<p><strong>服务端配置</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092310344.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092316654.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092314364.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405092318861.png" alt="img"></p>
<h3 id="21、Zabbix-系列之分布式监控-Proxy-代理"><a href="#21、Zabbix-系列之分布式监控-Proxy-代理" class="headerlink" title="21、Zabbix 系列之分布式监控 Proxy 代理"></a>21、Zabbix 系列之分布式监控 Proxy 代理</h3><p><img src="/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/proxy.png" alt="img"></p>
<h4 id="21-1-介绍"><a href="#21-1-介绍" class="headerlink" title="21.1 介绍"></a>21.1 介绍</h4><p>Zabbix Proxy 可以代表 Zabbix Server 收集性能和可用性数据。<br>通过这种方式，Proxy 可以自己承担一些收集数据的负载，并减轻 Zabbix Server 的负担。<br>此外，当所有 Agents 和 Proxy 都向一个 Zabbix Server 报告并且所有数据都集中收集时，使用 Proxy 代理是实现集中式和分布式监控的最简单方法。<strong>Zabbix Proxy 代理是一个数据收集器，它不运行触发器、处理事件或发送警报。</strong></p>
<h4 id="21-2-应用场景"><a href="#21-2-应用场景" class="headerlink" title="21.2 应用场景"></a>21.2 应用场景</h4><ol>
<li><strong>监控远程位置</strong>：Zabbix Proxy 可以部署在远程位置，比如分支机构或数据中心，以收集该位置下所有被监控设备的数据。<br>这样可以减少网络带宽的使用，因为 Proxy 可以先将数据进行聚合，然后再传输到中央的 Zabbix Server。</li>
<li><strong>监控通信不可靠的场景</strong>：当网络环境不稳定或通信可靠性不高时，Zabbix Proxy 可以作为一个缓存或中转站。即使网络暂时中断，Proxy 也可以继续收集数据，并在网络恢复后将数据发送给 Zabbix Server。这有助于确保数据的完整性和可靠性。</li>
<li><strong>监视数千个设备</strong>：当需要监控的设备数量非常大时，单一的 Zabbix Server 可能无法处理所有的数据。在这种情况下，可以使用多个 Zabbix Proxy 来分散负载。每个 Proxy 负责一部分设备的监控，然后将数据发送给 Zabbix Server 进行集中处理。</li>
<li><strong>多机房采集：</strong>通过使用 Zabbix Proxy，可以简化分布式监控的维护。管理员只需要配置和维护 Zabbix Server 和各个 Proxy，而不需要直接管理所有的被监控设备。此外，由于 Proxy 可以处理一些基本的监控任务（如数据聚合、存储和转发），因此可以减少对 Zabbix Server 的依赖，降低单点故障的风险。</li>
</ol>
<h4 id="21-3-Zabbix-Proxy-必须使用单独的数据库的原因"><a href="#21-3-Zabbix-Proxy-必须使用单独的数据库的原因" class="headerlink" title="21.3 Zabbix Proxy 必须使用单独的数据库的原因"></a>21.3 Zabbix Proxy 必须使用单独的数据库的原因</h4><ol>
<li><strong>数据一致性和完整性：</strong> Zabbix Proxy 代理负责收集来自被监控设备的数据，并将这些数据暂时存储在本地数据库中。如果 Proxy 代理和 Server 共享同一个数据库，可能会导致数据写入的冲突和混乱，尤其是在高并发或网络不稳定的情况下。使用单独的数据库可以确保 Proxy 代理收集的数据在传输到 Server 之前得到妥善保存，并且不会因为 Server 的临时通信问题而丢失。</li>
<li><strong>减轻server压力：</strong> Zabbix Proxy 代理可以在一定程度上分担 Zabbix Server 的压力，特别是在监控大量设备或远程区域设备时。通过使用单独的数据库，Proxy 代理可以在本地处理大部分的数据收集和存储工作，然后再将汇总后的数据发送给 Server，从而减轻 Server 的负担。</li>
</ol>
<h4 id="21-4-安装"><a href="#21-4-安装" class="headerlink" title="21.4 安装"></a>21.4 安装</h4><p>安装数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&gt;&gt;&gt; 安装mariadb</span></span><br><span class="line">略</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 创建用户</span></span><br><span class="line">MariaDB [(none)]&gt; create database zabbix_proxy character <span class="built_in">set</span> utf8 collate utf8_bin;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; grant all privileges on zabbix_proxy.* to zabbix@<span class="string">'%'</span> identified by <span class="string">'zabbix'</span>;</span><br><span class="line">MariaDB [(none)]&gt; grant all privileges on zabbix_proxy.* to zabbix@<span class="string">'localhost'</span> identified by <span class="string">'zabbix'</span>;</span><br><span class="line">MariaDB [(none)]&gt; grant all privileges on zabbix_proxy.* to zabbix@<span class="string">'127.0.0.1'</span> identified by <span class="string">'zabbix'</span>;</span><br><span class="line">MariaDB [(none)]&gt; flush privileges;</span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 安装zabbix_proxy</span></span><br><span class="line">[root@web01 zabbix]<span class="comment"># yum -y install zabbix-proxy-mysql zabbix-sql-scripts zabbix-selinux-policy</span></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 导入初始架构和初始数据</span></span><br><span class="line">[root@web01 zabbix]<span class="comment"># mysql -uroot  zabbix_proxy &lt; /usr/share/zabbix-sql-scripts/mysql/proxy.sql</span></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 备份文件</span></span><br><span class="line">[root@web01 zabbix]<span class="comment"># cp /etc/zabbix/zabbix_proxy.conf&#123;,.bak&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 修改文件  </span></span><br><span class="line">[root@web01 zabbix]<span class="comment"># vim /etc/zabbix/zabbix_proxy.conf</span></span><br><span class="line">Server=192.168.174.58      									 <span class="comment"># 指定zabbix-server的IP地址</span></span><br><span class="line">LogFile=/var/<span class="built_in">log</span>/zabbix/zabbix_proxy.log     <span class="comment"># 日志文件路径必须指定</span></span><br><span class="line">PidFile=/run/zabbix/zabbix_proxy.pid       <span class="comment"># pid文件路径必须指定</span></span><br><span class="line">Hostname=zabbix-proxy  											 <span class="comment"># 当前主机的主机名，注意这里一定要和hostname的结果一致</span></span><br><span class="line">DBName=zabbix_proxy													 <span class="comment"># 指定数据库名称</span></span><br><span class="line">DBUser=zabbix																 <span class="comment"># 指定连接数据库用户名</span></span><br><span class="line">DBPassword=zabbix         									 <span class="comment"># 指定用户名密码</span></span><br><span class="line">DBSocket=/var/lib/mysql/mysql.sock					 <span class="comment"># 指定mariadb的的socket文件</span></span><br><span class="line">AllowUnsupportedDBVersions=1								 <span class="comment"># 关闭数据库版本检查</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动zabbix-proxy</span></span><br><span class="line">[root@web01 zabbix]<span class="comment"># systemctl enable  --now zabbix-proxy</span></span><br><span class="line">[root@web01 zabbix]<span class="comment"># systemctl status zabbix-proxy</span></span><br></pre></td></tr></table></figure>

<p><strong>注意：zabbix-proxy主机名需要和配置文件中的Hostname保持一致</strong></p>
<h4 id="zabbix-agent2配置"><a href="#zabbix-agent2配置" class="headerlink" title="zabbix-agent2配置"></a>zabbix-agent2配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@web03 ~]<span class="comment"># hostname -I</span></span><br><span class="line">192.168.174.62 </span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 修改配置zabbix-agent2配置文件</span></span><br><span class="line">[root@web03 ~]<span class="comment"># vim /etc/zabbix/zabbix_agentd.conf</span></span><br><span class="line"><span class="comment"># 这里不在写zabbix server的地址，写zabbix proxy主机的地址</span></span><br><span class="line">Server=192.168.174.60             <span class="comment"># 被动模式</span></span><br><span class="line">ServerActive=192.168.174.60  			<span class="comment"># 主动模式</span></span><br><span class="line"><span class="comment">#此值也必须和hostname的值一致</span></span><br><span class="line">Hostname=web03</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt;&gt;&gt; 重启服务</span></span><br><span class="line">[root@web03 ~]<span class="comment"># systemctl restart zabbix-agent2</span></span><br><span class="line">[root@web03 ~]<span class="comment"># systemctl status zabbix-agent2</span></span><br></pre></td></tr></table></figure>



<p><strong>zabbix 服务端 web界面配置</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405100954005.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405100955450.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405100956199.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405101048266.png" alt="img"></p>
<p><strong>配置主机</strong></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405101049948.png" alt="img"></p>
<p><img src="https://hjmimage.oss-cn-zhangjiakou.aliyuncs.com/202405101050284.png" alt="img"></p>
<p><strong>注意：如果主机可用性长时间没有变绿，则先重启被监控端zabbix-agnet2，和proxy端的zabbix-proxy。</strong></p>
<h3 id="22、zabbix优化方案"><a href="#22、zabbix优化方案" class="headerlink" title="22、zabbix优化方案"></a>22、zabbix优化方案</h3><ol>
<li><p>zabbix-proxy：当监控集群规模庞大时，使用zabbix-proxy，减少Zabbix Server的负载。</p>
</li>
<li><p>数据库优化：HA，读写分离，创建和维护适当的索引，减少查询时间。</p>
</li>
<li><p>主机和模版优化：简化配置管理，确保一致性；合理分组监控项，<strong>避免单个主机过多监控项</strong>；减少每个主机的监控负担，提高性能，使用低频率的监控项收集非关键数据，高频率的监控项收集关键数据。</p>
</li>
<li><p>触发器优化：减少触发器数量，避免不必要的复杂逻辑。</p>
</li>
<li><p>历史数据和趋势数据优化：设置合理的数据保留周期，减少数据库负担。定期清理旧数据，防止数据库膨胀。</p>
</li>
<li><p>调整 Zabbix 服务器参数：</p>
</li>
<li><ol>
<li><strong>StartPollers</strong>：控制 Zabbix 服务器同时运行的轮询器进程数量，<strong>建议设置为系统 CPU 核数的 2-4 倍</strong>。 轮询器负责主动从客户端（Zabbix Agent）或其他监控对象（如 HTTP、SNMP 等）获取数据。  </li>
<li><strong>StartTrappers</strong>：控制 Zabbix 服务器同时运行的 trapper 进程数量，<strong>建议设置为 10-20</strong>。 该进程用于接收 Zabbix 客户端和其他设备主动发送的数据（例如主动模式下的监控数据）。  </li>
<li><strong>CacheSize</strong>：用于存储历史数据和趋势数据的缓存大小，<strong>建议设置为系统内存的 10%-20%</strong>。<strong>以减少数据库负载</strong>。 缓存越大，Zabbix 可以更高效地处理和存储数据，从而减少对数据库的频繁读写操作。  </li>
<li><strong>HistoryCacheSize</strong>：历史缓存大小，用于缓存历史数据，减少数据库的 I/O 负载。建议：64M 到 256M，根据监控数据趋势计算的需求设置。  </li>
<li><strong>Timeout</strong>：设置 Zabbix 服务器与代理或受监控对象的通信超时时间，可以根据网络状况适当增加，但不宜过大，以免延迟过多。  </li>
<li><strong>StartDiscoverers：</strong>控制 Zabbix 服务器同时运行的发现进程数量，决定自动发现的并发能力。默认为1。</li>
<li><strong>StartDBSyncers</strong>：数据库同步进程数量，用于将数据从 Zabbix 缓存写入数据库。默认为4。</li>
</ol>
</li>
</ol>
<h3 id="23、zabbix结合Grafana实现图形展示"><a href="#23、zabbix结合Grafana实现图形展示" class="headerlink" title="23、zabbix结合Grafana实现图形展示"></a>23、zabbix结合Grafana实现图形展示</h3><p>详细请见后续文章。</p>
<h5 id><a href="#" class="headerlink" title></a></h5></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">L66</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://l66stbz.github.io/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/">https://l66stbz.github.io/2024/08/23/%E4%BC%81%E4%B8%9A%E7%BA%A7Zabbix%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://l66stbz.github.io" target="_blank">L66</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/Zabbix/">Zabbix</a></div><div class="post_share"><div class="social-share" data-image="https://l66stbz.github.io/2024/09/15/kubernetes 二进制高可用安装部署（v1.23+）/kubernetes 二进制高可用安装部署（v1.23+）/1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2024/08/26/Zabbix%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC/"><img class="prev_cover" src="https://l66stbz.github.io/2024/08/26/Zabbix自定义监控脚本/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Zabbix自定义监控脚本</div></div></a></div><div class="next-post pull_right"><a href="/2024/08/21/%E4%BC%81%E4%B8%9A%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E7%A5%9E%E5%99%A8Ansible(2)/"><img class="next_cover" src="https://l66stbz.github.io/2024/08/21/企业自动化运维神器Ansible(2)/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">企业自动化运维神器Ansible(2)</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2024/08/27/Zabbix告警媒介/" title="Zabbix告警媒介"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/27/Zabbix告警媒介/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-27</div><div class="relatedPosts_title">Zabbix告警媒介</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/18/Zabbix监控Nginx指标/" title="Zabbix监控Nginx指标"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/18/Zabbix监控Nginx指标/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-18</div><div class="relatedPosts_title">Zabbix监控Nginx指标</div></div></a></div><div class="relatedPosts_item"><a href="/2024/08/26/Zabbix自定义监控脚本/" title="Zabbix自定义监控脚本"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/08/26/Zabbix自定义监控脚本/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-08-26</div><div class="relatedPosts_title">Zabbix自定义监控脚本</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/17/zabbix部署/" title="zabbix部署"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/17/zabbix部署/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-17</div><div class="relatedPosts_title">zabbix部署</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/19/作业_zabbix监控内存/" title="作业_zabbix监控内存"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/19/作业_zabbix监控内存/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-19</div><div class="relatedPosts_title">作业_zabbix监控内存</div></div></a></div><div class="relatedPosts_item"><a href="/2024/05/17/安装zabbix前端包问题/" title="安装zabbix前端包问题"><img class="relatedPosts_cover" src="https://l66stbz.github.io/2024/05/17/安装zabbix前端包问题/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2024-05-17</div><div class="relatedPosts_title">安装zabbix前端包问题</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By L66</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/third-party/click_heart.js"></script></body></html>